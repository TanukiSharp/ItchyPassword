!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function r(t){const e=document.getElementById(t);if(null===t)throw new Error(`DOM element '${t}' not found.`);return e}function a(t,e){const n=function(t,e){let n;return()=>{n&&clearTimeout(n),n=setTimeout(t,e)}}(()=>{e.classList.remove("good-flash"),e.classList.remove("bad-flash")},1e3);e.addEventListener("click",async()=>{await async function(t){try{return await navigator.clipboard.writeText(t),!0}catch(t){return console.error(t.stack||t),!1}}(t.value)?e.classList.add("good-flash"):e.classList.add("bad-flash"),n()})}n.r(e);const i="#D0FFD0",o="#FFD0D0";const s="Stores the string in memory and removes it from the UI component. Prevents a physical intruder from copy/pasting the value.",c="Removes the string form memory and re-enables the UI component.",u=r("txtPrivatePart"),l=r("txtPrivatePartConfirmation"),d=r("btnProtect"),y=r("spnProtectedConfirmation"),p=r("spnPrivatePartSize"),v=r("spnPrivatePartSizeConfirmation");let f;const b=[];function g(){return void 0!==f?f:u.value}function h(){0!==u.value.length&&(f=u.value,y.innerHTML="Protected",u.value="",l.value="",p.innerHTML="0",v.innerHTML="0",u.disabled=!0,l.disabled=!0,d.innerHTML="Clear and unlock",d.title=c,E())}function w(){void 0===f?h():(f=void 0,y.innerHTML="",u.disabled=!1,l.disabled=!1,d.innerHTML="Protect and lock",d.title=s,d.disabled=!0)}function m(){w()}const P=new class{constructor(t,e){this.action=t,this.delay=e}reset(t){void 0!==this.timeout&&clearTimeout(this.timeout);const e=void 0!==t?t:this.delay;this.timeout=setTimeout(()=>{this.action(),this.timeout=void 0},e)}}(h,6e4);function T(){let t;for(t of(d.disabled=0===u.value.length,p.innerHTML=u.value.length.toString(),E(),b))t();P.reset()}function E(){l.value===u.value?l.style.setProperty("background",i):l.style.setProperty("background",o)}function L(){v.innerHTML=l.value.length.toString(),P.reset(),E()}function S(t){const e=(t=function(t){if(t.byteLength>65535)throw new Error(`Buffer too large: ${t.byteLength} bytes`);let e=t.byteLength;const n=new Uint8Array(2+t.byteLength);for(let t=0;t<2;t+=1)n[t]=e%256,e/=256;return n.set(new Uint8Array(t),2),n.buffer}(t)).byteLength,n=new DataView(t,0);let r=0n,a=1n;for(let t=0;t<e;t+=1)r+=BigInt(n.getUint8(t))*a,a*=256n;return r}function A(t,e){const n=BigInt(e.length);let r="",a=function(t){const e=t.byteLength,n=new DataView(t,0);let r=0n,a=1n;for(let t=0;t<e;t+=1)r+=BigInt(n.getUint8(t))*a,a*=256n;return r}(t);for(;a>0n;){const t=a%n;a/=n,r+=e[BigInt.asUintN(8,t)]}return r}function C(t,e){const n=BigInt(e.length);let r=0n,a=1n;for(let i=0;i<t.length;i+=1){r+=BigInt(e.indexOf(t[i]))*a,a*=n}return function(t){const e=[];for(;t>0n;){const n=t%256n;t/=256n;const r=Number(BigInt.asUintN(8,n));e.push(r)}let n=e[0];e.length>1&&(n+=256*e[1]);const r=n-(e.length-2);for(let t=0;t<r;t+=1)e.push(0);return new Uint8Array(e.slice(2)).buffer}(r)}const k="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";async function x(t,e){const n=await crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveKey"]),r={name:"PBKDF2",hash:"SHA-512",iterations:1e5,salt:e},a=await crypto.subtle.deriveKey(r,n,{name:"AES-CBC",length:256},!0,["encrypt"]);return await crypto.subtle.exportKey("raw",a)}function M(t=64,e=k){return A(function(t=64){const e=new Uint8Array(t);return crypto.getRandomValues(e).buffer}(t),e)}function I(t){return(new TextEncoder).encode(t).buffer}const B=r("divStorageOutput"),U=r("txtPath"),O=r("txtParameters"),H=r("txtCustomKeys");function R(){K()}function D(){K()}function K(){if(void 0===N||void 0===F||void 0===_)return;const t=function t(e,n){const r=e.indexOf("/"),a={},i=r>=0?e.substr(0,r):e,o=r>=0?e.substr(r+1):void 0;if(void 0===n){const t={};t[i]=a,n={head:t,tailParent:t,tail:a}}else n.tail[i]=a,n.tailParent=n.tail,n.tail=a;return o?t(o,n):n}(`${U.value}/${F}`),e=t.tail;for(const[t,n]of Object.entries(N))e[t]=n;const n=function(){if(""===H.value)return{};try{const t=JSON.parse(H.value);return null===t||"Object"!==t.constructor.name?null:t}catch{return null}}();null!==n?H.style.removeProperty("background"):H.style.setProperty("background",o);const r=function(t,e,n){const r={};if(null!==t)for(const[e,a]of Object.entries(t))!1===n.includes(e)&&(r[e]=a);if(null!==e)for(const[t,n]of Object.entries(e))r[t]=n;return r}(n,e,_);0===Object.keys(r).length?t.tailParent[Object.keys(t.tailParent)[0]]=null:t.tailParent[Object.keys(t.tailParent)[0]]=r,O.value=JSON.stringify(t.head,void 0,4)}function j(){N=void 0,F=void 0,_=void 0,O.value=""}let N,F,_;function G(t,e,n){N=t,F=e,_=n,K()}function V(){B.style.setProperty("display","initial")}function $(){B.style.setProperty("display","none")}const z=r("btnTabPasswords"),J=r("divTabPasswords"),q=new class{constructor(t){this.hkdfPurpose=I(t),this._description=`HKDF(PBKDF2, HMAC512) [purpose: ${t}]`}get version(){return 1}get description(){return this._description}async generatePassword(t,e){const n=await x(t,e),r=await crypto.subtle.importKey("raw",n,{name:"HMAC",hash:{name:"SHA-512"}},!1,["sign"]);return await crypto.subtle.sign("HMAC",r,this.hkdfPurpose)}}("Password"),Q=r("txtPublicPart"),W=r("spnPublicPartSize"),X=r("btnGeneratePublicPart"),Y=r("btnClearPublicPart"),Z=r("btnCopyPublicPart"),tt=r("numOutputSizeRange"),et=r("numOutputSizeNum"),nt=r("txtAlphabet"),rt=r("spnAlphabetSize"),at=r("btnResetAlphabet"),it=r("txtResultPassword"),ot=r("spnResultPasswordLength"),st=r("btnCopyResultPassword"),ct=64,ut="!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~",lt=["alphabet","length","public","datetime"];let dt;function yt(){Q.value.length>0&&"y"!==prompt("Are you sure you want to clear the public part ?\nType 'y' to accept","")||(Q.value="",Pt(),vt(),gt())}function pt(){if(Q.value.length>0&&"y"!==prompt("Are you sure you want to generate a new public part ?\nType 'y' to accept",""))return;const t=M();Q.value=t,Pt(),vt(),kt()}function vt(){dt=Q.value.length>0?(new Date).toISOString():void 0}function ft(){ot.innerHTML=it.value.length.toString()}function bt(t){const e=t.split("");e.sort();for(let t=1;t<e.length;t+=1)if(e[t-1]===e[t])return!1;return!0}function gt(){if(!1===Ct())return void At();const t={public:Q.value,datetime:dt},e=it.value.length;e!==ct&&(t.length=e);const n=nt.value;n!==ut&&(t.alphabet=n),G(t,"password",lt)}function ht(){et.value=tt.value}async function wt(){ht(),await kt()}async function mt(){(function(){const t=parseInt(tt.min,10),e=parseInt(et.value,10),n=parseInt(tt.max,10);return!1===isNaN(e)&&(tt.value=Math.max(t,Math.min(e,n)).toString(),!0)})()&&ht(),await kt()}function Pt(){W.innerHTML=Q.value.length.toString()}function Tt(){rt.innerHTML=nt.value.length.toString()}function Et(t){t?nt.style.removeProperty("background"):nt.style.setProperty("background",o)}async function Lt(){const t=bt(nt.value);Et(t),!1!==t&&(Tt(),await kt())}async function St(){xt(),Tt(),await kt()}function At(){it.value="",j(),ft()}function Ct(){const t=nt.value;return!1!==bt(t)&&!(g().length<=0||Q.value.length<8||t.length<2)}async function kt(){if(!1===Ct())return void At();const t=g(),e=Q.value,n=I(t),r=I(e),a=A(await q.generatePassword(n,r),nt.value);var i,o;it.value=(i=a,o=Math.max(4,parseInt(tt.value,10)),i.length<=o?i:i.substr(0,o)),ft(),gt()}async function xt(){nt.value=ut,Tt();const t=bt(nt.value);Et(t),t&&await kt()}async function Mt(){Pt(),vt(),await kt()}class It{get version(){return 2}get description(){return"PBKDF2 + AES-GCM"}async encrypt(t,e){const n=new ArrayBuffer(44+t.byteLength),r=crypto.getRandomValues(new Uint8Array(n,0,12)),a=crypto.getRandomValues(new Uint8Array(n,12,16)),i={name:"AES-GCM",iv:r},o=await crypto.subtle.importKey("raw",await x(e,a),{name:"AES-GCM",length:256},!1,["encrypt"]),s=await crypto.subtle.encrypt(i,o,t);return new Uint8Array(n).set(new Uint8Array(s),28),n}async decrypt(t,e){const n=new Uint8Array(t,0,12),r=new Uint8Array(t,12,16),a=new Uint8Array(t,28),i={name:"AES-GCM",iv:n},o=await x(e,r),s=await crypto.subtle.importKey("raw",o,{name:"AES-GCM",length:256},!1,["decrypt"]);return await crypto.subtle.decrypt(i,s,a)}}const Bt=["version","value"],Ut=r("btnTabCiphers"),Ot=r("divTabCiphers"),Ht=new It,Rt=r("txtCipherName"),Dt=r("txtCipherSource"),Kt=r("txtCipherTarget"),jt=r("btnEncrypt"),Nt=r("btnDecrypt"),Ft=r("btnClearCipherSource"),_t=r("btnCopyCipherTarget"),Gt=r("btnClearCipherTarget");function Vt(){Dt.style.removeProperty("background-color")}function $t(){Dt.style.setProperty("background-color",o)}function zt(){Vt(),Kt.style.removeProperty("background-color")}function Jt(t){Kt.value=t,qt()}function qt(){if(""===Kt.value||""===Rt.value)return void j();G({version:Ht.version,value:Kt.value},`ciphers/${Rt.value}`,Bt)}async function Qt(){if(Dt.focus(),Jt(""),zt(),0===Dt.value.length)return void $t();const t=g();if(0===t.length)return void console.warn("Private part is empty");const e=I(Dt.value),n=I(t);Jt(function(t,e){const n=BigInt(e.length);let r="",a=S(t);for(;a>0n;){const t=a%n;a/=n,r+=e[BigInt.asUintN(8,t)]}return r}(await Ht.encrypt(e,n),k))}async function Wt(){if(Dt.focus(),Jt(""),zt(),0===Dt.value.length)return void $t();const t=g();var e;if(0!==t.length)try{const n=C(Dt.value,k),r=I(t),a=await Ht.decrypt(n,r);Jt((e=a,(new TextDecoder).decode(e)))}catch(t){console.warn(`Failed to decrypt${t.message?`, error: ${t.message}`:", no error message"}`),Kt.style.setProperty("background-color",o)}else console.warn("Private part is empty")}const Xt=new Uint8Array([242,207,239,142,19,64,70,73,146,42,222,92,188,136,56,168]).buffer;const Yt=[new class{get version(){return 1}get description(){return"PBKDF2 + AES-GCM"}async encrypt(t,e){const n=new ArrayBuffer(28+t.byteLength),r=new DataView(n,0,12);crypto.getRandomValues(new Uint8Array(n,0,12));const a={name:"AES-GCM",iv:r},i=await crypto.subtle.importKey("raw",await x(e,Xt),{name:"AES-GCM",length:256},!1,["encrypt"]),o=await crypto.subtle.encrypt(a,i,t);return new Uint8Array(n).set(new Uint8Array(o),12),n}async decrypt(t,e){const n=new DataView(t,0,12),r=new DataView(t,12),a={name:"AES-GCM",iv:n},i=await x(e,Xt),o=await crypto.subtle.importKey("raw",i,{name:"AES-GCM",length:256},!1,["decrypt"]);return await crypto.subtle.decrypt(a,o,r)}},new It],Zt=r("btnTabReEncrypt"),te=r("divTabReEncrypt"),ee=r("txtReEncryptSource"),ne=r("txtReEncryptTarget"),re=r("cboReEncryptFrom"),ae=r("cboReEncryptTo"),ie=r("btnReEncrypt"),oe=r("btnClearReEncryptSource"),se=r("btnCopyReEncryptTarget"),ce=r("btnClearReEncryptTarget");function ue(t,e){let n;for(n of Yt){const e=document.createElement("option");e.value=t.childNodes.length.toString(),e.text=`${n.description} (v${n.version})`,t.add(e)}t.value=e.toString()}function le(){ee.style.removeProperty("background-color")}function de(){le(),ne.style.removeProperty("background-color")}async function ye(){if(ne.value="",de(),0===ee.value.length)return void ee.style.setProperty("background-color",o);if(re.value===ae.value)return void ne.style.setProperty("background-color",o);const t=g();if(0===t.length)return void console.warn("Private part is empty");const e=parseInt(re.value,10),n=parseInt(ae.value,10),r=I(t),a=function(t){t.length%2!=0&&(t="0"+t);const e=new Uint8Array(t.length/2);for(let n=0;n<e.byteLength;n+=1)e[n]=parseInt(t.substr(2*n,2),16);return e.buffer}(ee.value),i=await Yt[e].decrypt(a,r),s=await Yt[n].encrypt(i,r);var c;ne.value=(c=s,Array.prototype.map.call(new Uint8Array(c),t=>("00"+t.toString(16)).slice(-2)).join(""))}const pe=[{getTabButton:()=>r("btnTabNothing"),getTabContent:()=>r("divTabNothing"),onTabSelected(){$()}},new class{init(){d.addEventListener("click",m),u.addEventListener("input",T),l.addEventListener("input",L),E(),d.title=s}},new class{getTabButton(){return z}getTabContent(){return J}onTabSelected(){V(),gt()}init(){var t;t=kt,b.push(t),tt.max=ct.toString(),tt.value=ct.toString(),Y.addEventListener("click",yt),X.addEventListener("click",pt),function(t,e){const n=r(e);n.addEventListener("click",()=>{"password"===t.type?(t.type="input",n.innerHTML="Hide"):(t.type="password",n.innerHTML="View")})}(it,"btnViewResultPassword"),a(Q,Z),a(it,st),tt.addEventListener("input",wt),et.addEventListener("input",mt),nt.addEventListener("input",Lt),at.addEventListener("click",St),Q.addEventListener("input",Mt),Pt(),ht(),xt()}},new class{getTabButton(){return Ut}getTabContent(){return Ot}onTabSelected(){V(),qt()}init(){a(Kt,_t),jt.addEventListener("click",Qt),Nt.addEventListener("click",Wt),Rt.addEventListener("input",()=>{qt()}),Dt.addEventListener("input",()=>{Dt.value.length>0&&Vt()}),Ft.addEventListener("click",()=>{Dt.value=""}),Gt.addEventListener("click",()=>{Jt("")})}},new class{getTabButton(){return Zt}getTabContent(){return te}onTabSelected(){$()}init(){a(ne,se),ue(re,Yt.length-2),ue(ae,Yt.length-1),ee.addEventListener("input",()=>{ee.value.length>0&&le()}),oe.addEventListener("click",()=>{ee.value=""}),ce.addEventListener("click",()=>{ne.value=""}),ie.addEventListener("click",ye)}},new class{init(){H.addEventListener("input",D),U.addEventListener("input",R)}}],ve=pe.filter(t=>void 0!==t.getTabButton),fe=pe.filter(t=>void 0!==t.init);new class{constructor(t){this.tabs=t,this._activeTabIndex=-1;for(let e=0;e<this.tabs.length;e+=1)t[e].getTabButton().addEventListener("click",()=>{this.setActiveTab(e)});this.setActiveTab(0)}get activeTabIndex(){return this._activeTabIndex}set activeTabIndex(t){if(t<0||t>=this.tabs.length)throw new Error(`Argument 'index' out of range. Must be in range [0;${this.tabs.length-1}].`);this.setActiveTab(t)}setActiveTab(t){if(t===this._activeTabIndex)return;let e;for(e of this.tabs){const t=e.getTabButton();t.style.removeProperty("font-weight"),t.style.setProperty("color","#C0C0C0"),e.getTabContent().style.setProperty("display","none")}const n=this.tabs[t].getTabButton();n.style.setProperty("font-weight","bold"),n.style.removeProperty("color"),this.tabs[t].getTabContent().style.removeProperty("display"),this._activeTabIndex=t,this.tabs[t].onTabSelected()}}(ve);const be="9c491ec3548bf58c4f65ce6e791ca9c6ddd6e4e2".substr(0,11);let ge;for(ge of(r("divInfo").innerHTML=`${be}<br/><a href="https://github.com/TanukiSharp/ItchyPassword" target="_blank">github</a>`,fe))ge.init()}]);
//# sourceMappingURL=bundle.js.map
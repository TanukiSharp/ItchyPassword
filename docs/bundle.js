!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function r(t){return(new TextEncoder).encode(t)}function i(t,e){const n=BigInt(e.length);let r="",i=function(t){const e=t.byteLength,n=new DataView(t,0);let r=0n;for(let t=0;t<e;t+=1)r+=BigInt(n.getUint8(t))*256n**BigInt(t);return r}(t);for(;i>0n;){const t=i%n;i/=n,r+=e[BigInt.asUintN(64,t)]}return r}n.r(e);const a="PBKDF2",o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";function u(t){const e=document.getElementById(t);if(null===t)throw new Error(`DOM element '${t}' not found.`);return e}const l=u("txtPrivatePart"),s=u("txtPrivatePartConfirmation"),c=u("btnProtect"),d=u("btnClearProtected"),v=u("spnProtectedConfirmation"),f=u("txtPath"),p=u("txtPublicPart"),y=u("btnGeneratePublicPart"),b=u("spnPrivatePartSize"),h=u("spnPrivatePartSizeConfirmation"),g=u("numOutputSizeRange"),m=u("numOutputSizeNum"),P=u("txtAlphabet"),w=u("spnAlphabetSize"),L=u("btnResetAlphabet"),T=u("txtResultPassword"),S=u("spnResultPasswordLength"),x=u("spnCopyResultPasswordFeedback"),M=u("txtParameters"),E=u("txtCustomKeys"),O=64,k="!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~",H="#D0FFD0",j="#FFD0D0",C=["alphabet","length","public"];let I;function R(){return void 0!==I?I:l.value}function B(){0!==l.value.length&&(I=l.value,v.innerHTML=`Protected, ${I.length} characters`,l.value="",s.value="",b.innerHTML="0",h.innerHTML="0",Q())}function D(){I=void 0,v.innerHTML=""}g.max=O.toString(),g.value=O.toString(),y.addEventListener("click",()=>{const t=function(t=64,e=o){const n=new Uint8Array(t);return crypto.getRandomValues(n),i(n.buffer,o)}();p.value=t,G()}),c.addEventListener("click",()=>{B()}),d.addEventListener("click",()=>{D(),G()});const F=new class{constructor(t){this.element=t}setText(t,e){this.element.innerHTML=t,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.element.innerHTML="",e)}}(x);function A(){S.innerHTML=T.value.length.toString().padStart(2," ")}var K;function z(t){const e=t.split("");e.sort();for(let t=1;t<e.length;t+=1)if(e[t-1]===e[t])return!1;return!0}function _(){if(!1===J())return void(M.value="");const t=function t(e,n){const r=e.indexOf("/"),i={},a=r>=0?e.substr(0,r):e,o=r>=0?e.substr(r+1):void 0;if(void 0===n){const t={};t[a]=i,n={head:t,tailParent:t,tail:i}}else n.tail[a]=i,n.tailParent=n.tail,n.tail=i;return o?t(o,n):n}(f.value),e=t.tail;e.public=p.value;const n=parseInt(m.value,10);n!==O&&(e.length=n);const r=P.value;r!==k&&(e.alphabet=r);const i=function(){if(""===E.value)return{};try{const t=JSON.parse(E.value);return null===t||"Object"!==t.constructor.name?null:t}catch{return null}}();null!==i?E.style.removeProperty("background"):E.style.setProperty("background",j);const a=function(t,e){const n={};if(null!=t)for(const[e,r]of Object.entries(t))!1===C.includes(e)&&(n[e]=r);if(null!=e)for(const[t,r]of Object.entries(e))n[t]=r;return n}(i,e);0===Object.keys(a).length?t.tailParent[Object.keys(t.tailParent)[0]]=null:t.tailParent[Object.keys(t.tailParent)[0]]=a,M.value=JSON.stringify(t.head,void 0,4)}function N(){m.value=g.value}function V(){w.innerHTML=P.value.length.toString(),P.value.length.toString().length<2&&(w.innerHTML=w.innerHTML.padStart(2," "))}function U(t){t?P.style.removeProperty("background"):P.style.setProperty("background",j)}function J(){const t=P.value;return!1!==z(t)&&!(R().length<=0||p.value.length<8||t.length<2)}async function G(){if(_(),!1===J())return T.value="",void A();const t=i(await async function(t,e){const n=r(e);if(n.length<8)throw new Error("Public key must be at least 8 bytes long.");const i=await crypto.subtle.importKey("raw",r(t),a,!1,["deriveKey"]),o={name:a,hash:"SHA-512",iterations:1e5,salt:n},u=await crypto.subtle.deriveKey(o,i,{name:"AES-CBC",length:256},!0,["encrypt"]);return await crypto.subtle.exportKey("raw",u)}(R(),p.value),P.value);var e,n;T.value=(e=t,n=parseInt(g.value,10),e.length<=n?e:e.substr(0,n)),A()}async function $(){P.value=k,V();const t=z(P.value);U(t),t&&await G()}!function(t,e){const n=u(e);n.addEventListener("click",()=>{"password"===t.type?(t.type="input",n.innerHTML="Hide"):(t.type="password",n.innerHTML="View")})}(T,"btnViewResultPassword"),K=T,u("btnCopyResultPassword").addEventListener("click",async()=>{await async function(t){try{return await navigator.clipboard.writeText(t),!0}catch(t){return console.error(t.stack||t),!1}}(K.value)?F.setText("Copied",3e3):F.setText('<span style="color: red">Failed to copy</span>',3e3)}),g.addEventListener("input",()=>{N(),G()}),m.addEventListener("input",()=>{!function(){const t=parseInt(g.min,10),e=parseInt(m.value,10),n=parseInt(g.max,10);g.value=Math.max(t,Math.min(e,n)).toString()}(),N(),G()}),P.addEventListener("input",()=>{const t=z(P.value);U(t),!1!==t&&(V(),G())}),L.addEventListener("click",()=>{$(),V(),G()});const q=new class{constructor(t,e){this.action=t,this.delay=e}reset(t){null==this.timeout&&clearTimeout(this.timeout);const e=null!=t?t:this.delay;this.timeout=setTimeout(()=>{this.action(),this.timeout=void 0},e)}}(B,6e4);function Q(){s.value===l.value?s.style.setProperty("background",H):s.style.setProperty("background",j)}l.addEventListener("input",()=>{D(),b.innerHTML=l.value.length.toString(),Q(),G(),q.reset()}),s.addEventListener("input",()=>{h.innerHTML=s.value.length.toString(),Q()}),f.addEventListener("input",()=>{_()}),p.addEventListener("input",()=>{_(),G()}),E.addEventListener("input",()=>{_()}),N(),$(),Q()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0cmluZ1V0aWxzLnRzIiwid2VicGFjazovLy8uL3NyYy9hcnJheVV0aWxzLnRzIiwid2VicGFjazovLy8uL3NyYy9jcnlwdG8udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3VpLnRzIiwid2VicGFjazovLy8uL3NyYy9WaXN1YWxGZWVkYmFjay50cyIsIndlYnBhY2s6Ly8vLi9zcmMvVGltZWRBY3Rpb24udHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJzdHJpbmdUb0FycmF5Iiwic3RyIiwiVGV4dEVuY29kZXIiLCJlbmNvZGUiLCJ0b0N1c3RvbUJhc2UiLCJieXRlcyIsImFscGhhYmV0IiwiYWxwaGFiZXRMZW5ndGgiLCJCaWdJbnQiLCJsZW5ndGgiLCJyZXN1bHQiLCJudW1iZXIiLCJhcnJheUJ1ZmZlciIsImJ5dGVMZW5ndGgiLCJhcnJheVZpZXciLCJEYXRhVmlldyIsImdldFVpbnQ4IiwiYXJyYXlCdWZmZXJUb1Vuc2lnbmVkQmlnSW50IiwicmVtYWluZGVyIiwiYXNVaW50TiIsIkFMR09SSVRITV9OQU1FIiwiQkFTRTYyX0FMUEhBQkVUIiwiZ2V0RWxlbWVudEJ5SWQiLCJlbGVtZW50TmFtZSIsImVsZW1lbnQiLCJkb2N1bWVudCIsIkVycm9yIiwidHh0UHJpdmF0ZVBhcnQiLCJ0eHRQcml2YXRlUGFydENvbmZpcm1hdGlvbiIsImJ0blByb3RlY3QiLCJidG5DbGVhclByb3RlY3RlZCIsInNwblByb3RlY3RlZENvbmZpcm1hdGlvbiIsInR4dFBhdGgiLCJ0eHRQdWJsaWNQYXJ0IiwiYnRuR2VuZXJhdGVQdWJsaWNQYXJ0Iiwic3BuUHJpdmF0ZVBhcnRTaXplIiwic3BuUHJpdmF0ZVBhcnRTaXplQ29uZmlybWF0aW9uIiwibnVtT3V0cHV0U2l6ZVJhbmdlIiwibnVtT3V0cHV0U2l6ZU51bSIsInR4dEFscGhhYmV0Iiwic3BuQWxwaGFiZXRTaXplIiwiYnRuUmVzZXRBbHBoYWJldCIsInR4dFJlc3VsdFBhc3N3b3JkIiwic3BuUmVzdWx0UGFzc3dvcmRMZW5ndGgiLCJzcG5Db3B5UmVzdWx0UGFzc3dvcmRGZWVkYmFjayIsInR4dFBhcmFtZXRlcnMiLCJ0eHRDdXN0b21LZXlzIiwiREVGQVVMVF9MRU5HVEgiLCJERUZBVUxUX0FMUEhBQkVUIiwiU1VDQ0VTU19DT0xPUiIsIkVSUk9SX0NPTE9SIiwiUkVTRVJWRURfS0VZUyIsInByaXZhdGVQYXJ0IiwiZ2V0UHJpdmF0ZVBhcnQiLCJ1bmRlZmluZWQiLCJwcm90ZWN0UHJpdmF0ZVBhcnQiLCJpbm5lckhUTUwiLCJ1cGRhdGVQcml2YXRlUGFydHNNYXRjaGluZyIsImNsZWFyUHJpdmF0ZVBhcnRQcm90ZWN0aW9uIiwibWF4IiwidG9TdHJpbmciLCJhZGRFdmVudExpc3RlbmVyIiwicmFuZG9tU3RyaW5nIiwiYnl0ZUNvdW50IiwiYXJyYXkiLCJVaW50OEFycmF5IiwiY3J5cHRvIiwiZ2V0UmFuZG9tVmFsdWVzIiwiYnVmZmVyIiwicnVuIiwiY29weVRvQ2xpcGJvYXJkRmVlZGJhY2tPYmplY3QiLCJ0aGlzIiwidGV4dCIsImR1cmF0aW9uIiwidGltZW91dCIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJ1cGRhdGVSZXN1bHRQYXNzd29yZExlbmd0aCIsInBhZFN0YXJ0IiwidHh0IiwiaXNBbHBoYWJldFZhbGlkIiwic29ydGVkQWxwaGFiZXQiLCJzcGxpdCIsInNvcnQiLCJ1cGRhdGVQYXNzd29yZEdlbmVyYXRpb25QYXJhbWV0ZXJzIiwiY2FuUnVuIiwiY2hhaW5JbmZvIiwicGF0aFRvT2JqZWN0Q2hhaW4iLCJwYXRoIiwic2VwYXJhdG9ySW5kZXgiLCJpbmRleE9mIiwidGFpbCIsImZpcnN0UGF0aCIsInN1YnN0ciIsInJlbWFpbmluZ1BhdGgiLCJub2RlIiwiaGVhZCIsInRhaWxQYXJlbnQiLCJsZWFmIiwicHVibGljIiwibnVtZXJpY1ZhbHVlIiwicGFyc2VJbnQiLCJjdXN0b21LZXlzIiwib2JqIiwiSlNPTiIsInBhcnNlIiwiY29uc3RydWN0b3IiLCJwYXJzZUN1c3RvbUtleXMiLCJzdHlsZSIsInJlbW92ZVByb3BlcnR5Iiwic2V0UHJvcGVydHkiLCJyZXN1bHRQYXJhbWV0ZXJzIiwic291cmNlIiwidGFyZ2V0IiwiZW50cmllcyIsImluY2x1ZGVzIiwic2hhbGxvd01lcmdlIiwia2V5cyIsInN0cmluZ2lmeSIsInVwZGF0ZU91dHB1dFNpemVSYW5nZVRvTnVtIiwidXBkYXRlQWxwaGFiZXRTaXplIiwidXBkYXRlQWxwaGFiZXRWYWxpZGl0eURpc3BsYXkiLCJhc3luYyIsImtleVN0cmluZyIsInByaXZhdGVLZXkiLCJwdWJsaWNLZXkiLCJhbGdvcml0aG1TYWx0IiwiYmFzZUtleSIsInN1YnRsZSIsImltcG9ydEtleSIsImFsZ29yaXRobSIsImhhc2giLCJpdGVyYXRpb25zIiwic2FsdCIsImRlcml2ZUtleSIsImV4cG9ydEtleSIsImlucHV0IiwicmVzZXRBbHBoYWJldCIsImlzQWxwaGFiZXRWYWxpZFJlc3VsdCIsImJ1dHRvbk5hbWUiLCJidG4iLCJ0eXBlIiwic2V0dXBWaWV3QnV0dG9uIiwibmF2aWdhdG9yIiwiY2xpcGJvYXJkIiwid3JpdGVUZXh0IiwiZXJyb3IiLCJjb25zb2xlIiwic3RhY2siLCJ3cml0ZVRvQ2xpcGJvYXJkIiwic2V0VGV4dCIsIm1pbiIsInZhbCIsIk1hdGgiLCJ1cGRhdGVPdXRwdXRTaXplTnVtVG9SYW5nZSIsInByb3RlY3RQcml2YXRlUGFydEFjdGlvbiIsImFjdGlvbiIsImRlbGF5Iiwib3ZlcnJpZGVEZWxheSIsInJlc2V0Il0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9ILEVBQ2hGLElBQUlJLEVBQUtYLE9BQU9ZLE9BQU8sTUFHdkIsR0FGQTFCLEVBQW9Ca0IsRUFBRU8sR0FDdEJYLE9BQU9DLGVBQWVVLEVBQUksVUFBVyxDQUFFVCxZQUFZLEVBQU1LLE1BQU9BLElBQ3RELEVBQVBFLEdBQTRCLGlCQUFURixFQUFtQixJQUFJLElBQUlNLEtBQU9OLEVBQU9yQixFQUFvQlUsRUFBRWUsRUFBSUUsRUFBSyxTQUFTQSxHQUFPLE9BQU9OLEVBQU1NLElBQVFDLEtBQUssS0FBTUQsSUFDOUksT0FBT0YsR0FJUnpCLEVBQW9CNkIsRUFBSSxTQUFTMUIsR0FDaEMsSUFBSVMsRUFBU1QsR0FBVUEsRUFBT3FCLFdBQzdCLFdBQXdCLE9BQU9yQixFQUFnQixTQUMvQyxXQUE4QixPQUFPQSxHQUV0QyxPQURBSCxFQUFvQlUsRUFBRUUsRUFBUSxJQUFLQSxHQUM1QkEsR0FJUlosRUFBb0JhLEVBQUksU0FBU2lCLEVBQVFDLEdBQVksT0FBT2pCLE9BQU9rQixVQUFVQyxlQUFlMUIsS0FBS3VCLEVBQVFDLElBR3pHL0IsRUFBb0JrQyxFQUFJLEdBSWpCbEMsRUFBb0JBLEVBQW9CbUMsRUFBSSxHLCtCQzFFOUMsU0FBU0MsRUFBY0MsR0FFMUIsT0FEZ0IsSUFBSUMsYUFDTEMsT0FBT0YsR0NTbkIsU0FBU0csRUFBYUMsRUFBb0JDLEdBQzdDLE1BQU1DLEVBQXlCQyxPQUFPRixFQUFTRyxRQUUvQyxJQUFJQyxFQUFpQixHQUNqQkMsRUFqQkQsU0FBcUNDLEdBQ3hDLE1BQU1ILEVBQWlCRyxFQUFZQyxXQUM3QkMsRUFBc0IsSUFBSUMsU0FBU0gsRUFBYSxHQUV0RCxJQUFJRixFQUFpQixHQUVyQixJQUFLLElBQUkxQyxFQUFZLEVBQUdBLEVBQUl5QyxFQUFRekMsR0FBSyxFQUNyQzBDLEdBQVVGLE9BQU9NLEVBQVVFLFNBQVNoRCxJQUFPLE1BQVF3QyxPQUFPeEMsR0FHOUQsT0FBTzBDLEVBT2NPLENBQTRCWixHQUVqRCxLQUFPTSxFQUFTLElBQ2hCLENBQ0ksTUFBTU8sRUFBb0JQLEVBQVNKLEVBQ25DSSxHQUFVSixFQUlWRyxHQUFVSixFQUZ5QkUsT0FBT1csUUFBUSxHQUFJRCxJQUsxRCxPQUFPUixFLE9DaENYLE1BQU1VLEVBQXlCLFNBQ2xCQyxFQUEwQixpRUNHdkMsU0FBU0MsRUFBZUMsR0FDcEIsTUFBTUMsRUFBNEJDLFNBQVNILGVBQWVDLEdBRTFELEdBQW9CLE9BQWhCQSxFQUNBLE1BQU0sSUFBSUcsTUFBTSxnQkFBZ0JILGlCQUdwQyxPQUFPQyxFQUtYLE1BQU1HLEVBQW1DTCxFQUFlLGtCQUNsRE0sRUFBK0NOLEVBQWUsOEJBQzlETyxFQUErQlAsRUFBZSxjQUM5Q1EsRUFBc0NSLEVBQWUscUJBQ3JEUyxFQUE2Q1QsRUFBZSw0QkFDNURVLEVBQTRCVixFQUFlLFdBQzNDVyxFQUFrQ1gsRUFBZSxpQkFDakRZLEVBQTBDWixFQUFlLHlCQUV6RGEsRUFBdUNiLEVBQWUsc0JBQ3REYyxFQUFtRGQsRUFBZSxrQ0FFbEVlLEVBQXVDZixFQUFlLHNCQUN0RGdCLEVBQXFDaEIsRUFBZSxvQkFFcERpQixFQUFnQ2pCLEVBQWUsZUFDL0NrQixFQUFvQ2xCLEVBQWUsbUJBQ25EbUIsRUFBcUNuQixFQUFlLG9CQUVwRG9CLEVBQXNDcEIsRUFBZSxxQkFFckRxQixFQUE0Q3JCLEVBQWUsMkJBRTNEc0IsRUFBa0R0QixFQUFlLGlDQUVqRXVCLEVBQWtDdkIsRUFBZSxpQkFDakR3QixFQUFrQ3hCLEVBQWUsaUJBRWpEeUIsRUFBeUIsR0FPekJDLEVBRjhCLGlHQU05QkMsRUFBd0IsVUFDeEJDLEVBQXNCLFVBRXRCQyxFQUEwQixDQUFDLFdBQVksU0FBVSxVQU12RCxJQUFJQyxFQVFKLFNBQVNDLElBQ0wsWUFBb0JDLElBQWhCRixFQUNPQSxFQUVKekIsRUFBZTFDLE1BRzFCLFNBQVNzRSxJQUMrQixJQUFoQzVCLEVBQWUxQyxNQUFNd0IsU0FJekIyQyxFQUFjekIsRUFBZTFDLE1BQzdCOEMsRUFBeUJ5QixVQUFZLGNBQWNKLEVBQVkzQyxvQkFFL0RrQixFQUFlMUMsTUFBUSxHQUN2QjJDLEVBQTJCM0MsTUFBUSxHQUNuQ2tELEVBQW1CcUIsVUFBWSxJQUMvQnBCLEVBQStCb0IsVUFBWSxJQUUzQ0MsS0FPSixTQUFTQyxJQUNMTixPQUFjRSxFQUNkdkIsRUFBeUJ5QixVQUFZLEdBeEN6Q25CLEVBQW1Cc0IsSUFBTVosRUFBZWEsV0FDeEN2QixFQUFtQnBELE1BQVE4RCxFQUFlYSxXQUkxQzFCLEVBQXNCMkIsaUJBQWlCLFFBQVMsS0FDNUMsTUFBTUMsRUQxQkgsU0FBOEJDLEVBQW9CLEdBQUl6RCxFQUFtQmUsR0FDNUUsTUFBTTJDLEVBQW9CLElBQUlDLFdBQVdGLEdBRXpDLE9BREFHLE9BQU9DLGdCQUFnQkgsR0FDaEIsRUFBd0JBLEVBQU1JLE9BQVEvQyxHQ3VCaEIsR0FDN0JZLEVBQWNoRCxNQUFRNkUsRUFDdEJPLE1BMEJKeEMsRUFBV2dDLGlCQUFpQixRQUFTLEtBQ2pDTixNQVFKekIsRUFBa0IrQixpQkFBaUIsUUFBUyxLQUN4Q0gsSUFDQVcsTUE4RUosTUFBTUMsRUFBZ0QsSUMzTHZDLE1BSVgsWUFBbUI5QyxHQUNmK0MsS0FBSy9DLFFBQVVBLEVBR1osUUFBUWdELEVBQWNDLEdBQ3pCRixLQUFLL0MsUUFBUWdDLFVBQVlnQixFQUNyQkQsS0FBS0csU0FDTEMsYUFBYUosS0FBS0csU0FFdEJILEtBQUtHLFFBQVVFLFdBQVcsSUFBTUwsS0FBSy9DLFFBQVFnQyxVQUFZLEdBQUlpQixLRDhLSTdCLEdBdUJ6RSxTQUFTaUMsSUFDTGxDLEVBQXdCYSxVQUFZZCxFQUFrQnpELE1BQU13QixPQUFPbUQsV0FBV2tCLFNBQVMsRUFBRyxLQVo5RixJQUF5QkMsRUFtQnpCLFNBQVNDLEVBQWdCMUUsR0FDckIsTUFBTTJFLEVBQTJCM0UsRUFBUzRFLE1BQU0sSUFDaERELEVBQWVFLE9BRWYsSUFBSyxJQUFJbkgsRUFBWSxFQUFHQSxFQUFJaUgsRUFBZXhFLE9BQVF6QyxHQUFLLEVBQ3BELEdBQUlpSCxFQUFlakgsRUFBSSxLQUFPaUgsRUFBZWpILEdBQ3pDLE9BQU8sRUFJZixPQUFPLEVBd0NYLFNBQVNvSCxJQUNMLElBQWlCLElBQWJDLElBRUEsWUFEQXhDLEVBQWM1RCxNQUFRLElBSTFCLE1BQU1xRyxFQW5DVixTQUFTQyxFQUFrQkMsRUFBY0YsR0FDckMsTUFBTUcsRUFBeUJELEVBQUtFLFFBQVEsS0FFdENDLEVBQW9CLEdBRXBCQyxFQUFvQkgsR0FBa0IsRUFBSUQsRUFBS0ssT0FBTyxFQUFHSixHQUFrQkQsRUFDM0VNLEVBQW9DTCxHQUFrQixFQUFJRCxFQUFLSyxPQUFPSixFQUFpQixRQUFLbkMsRUFFbEcsUUFBa0JBLElBQWRnQyxFQUF5QixDQUN6QixNQUFNUyxFQUFvQixHQUMxQkEsRUFBS0gsR0FBYUQsRUFDbEJMLEVBQVksQ0FDUlUsS0FBTUQsRUFDTkUsV0FBWUYsRUFDWkosYUFHSkwsRUFBVUssS0FBS0MsR0FBYUQsRUFDNUJMLEVBQVVXLFdBQWFYLEVBQVVLLEtBQ2pDTCxFQUFVSyxLQUFPQSxFQUdyQixPQUFJRyxFQUNPUCxFQUFrQk8sRUFBZVIsR0FHckNBLEVBU3VCQyxDQUFrQnZELEVBQVEvQyxPQUNsRGlILEVBQW9CWixFQUFVSyxLQUVwQ08sRUFBS0MsT0FBU2xFLEVBQWNoRCxNQUU1QixNQUFNbUgsRUFBdUJDLFNBQVMvRCxFQUFpQnJELE1BQU8sSUFDMURtSCxJQUFpQnJELElBQ2pCbUQsRUFBS3pGLE9BQVMyRixHQUdsQixNQUFNOUYsRUFBbUJpQyxFQUFZdEQsTUFDakNxQixJQUFhMEMsSUFDYmtELEVBQUs1RixTQUFXQSxHQUdwQixNQUFNZ0csRUF4S1YsV0FDSSxHQUE0QixLQUF4QnhELEVBQWM3RCxNQUNkLE1BQU8sR0FHWCxJQUNJLE1BQU1zSCxFQUFXQyxLQUFLQyxNQUFNM0QsRUFBYzdELE9BQzFDLE9BQVksT0FBUnNILEdBQXlDLFdBQXpCQSxFQUFJRyxZQUFZbkksS0FDekIsS0FFSmdJLEVBQ1QsTUFDRSxPQUFPLE1BNEo0QkksR0FDQSxPQUFmTCxFQWhMcEJ4RCxFQUFjOEQsTUFBTUMsZUFBZSxjQUl2Qy9ELEVBQWM4RCxNQUFNRSxZQUFZLGFBQWM1RCxHQTZLOUMsTUFBTTZELEVBMUpWLFNBQXNCQyxFQUE0QkMsR0FDOUMsTUFBTXZHLEVBQXNCLEdBRTVCLEdBQWMsTUFBVnNHLEVBQ0EsSUFBSyxNQUFPekgsRUFBS04sS0FBVVAsT0FBT3dJLFFBQVFGLElBQ0YsSUFBaEM3RCxFQUFjZ0UsU0FBUzVILEtBQ3ZCbUIsRUFBT25CLEdBQU9OLEdBSzFCLEdBQWMsTUFBVmdJLEVBQ0EsSUFBSyxNQUFPMUgsRUFBS04sS0FBVVAsT0FBT3dJLFFBQVFELEdBQ3RDdkcsRUFBT25CLEdBQU9OLEVBSXRCLE9BQU95QixFQXlJK0IwRyxDQUFhZCxFQUFZSixHQUVsQixJQUF6Q3hILE9BQU8ySSxLQUFLTixHQUFrQnRHLE9BRTlCNkUsRUFBVVcsV0FBV3ZILE9BQU8ySSxLQUFLL0IsRUFBVVcsWUFBWSxJQUFNLEtBRTdEWCxFQUFVVyxXQUFXdkgsT0FBTzJJLEtBQUsvQixFQUFVVyxZQUFZLElBQU1jLEVBR2pFbEUsRUFBYzVELE1BQVF1SCxLQUFLYyxVQUFVaEMsRUFBVVUsVUFBTTFDLEVBQVcsR0FHcEUsU0FBU2lFLElBQ0xqRixFQUFpQnJELE1BQVFvRCxFQUFtQnBELE1BcUJoRCxTQUFTdUksSUFDTGhGLEVBQWdCZ0IsVUFBWWpCLEVBQVl0RCxNQUFNd0IsT0FBT21ELFdBRWRyQixFQUFZdEQsTUFBTXdCLE9BQU9tRCxXQUFXbkQsT0FDOUMsSUFFekIrQixFQUFnQmdCLFVBQVloQixFQUFnQmdCLFVBQVVzQixTQUFTLEVBQUcsTUFJMUUsU0FBUzJDLEVBQThCekMsR0FDL0JBLEVBQ0F6QyxFQUFZcUUsTUFBTUMsZUFBZSxjQUVqQ3RFLEVBQVlxRSxNQUFNRSxZQUFZLGFBQWM1RCxHQTZCcEQsU0FBU21DLElBQ0wsTUFBTS9FLEVBQW1CaUMsRUFBWXRELE1BRXJDLE9BQWtDLElBQTlCK0YsRUFBZ0IxRSxNQUloQitDLElBQWlCNUMsUUFBVSxHQUFLd0IsRUFBY2hELE1BQU13QixPQUFTLEdBQUtILEVBQVNHLE9BQVMsR0FPNUZpSCxlQUFlckQsSUFHWCxHQUZBZSxLQUVpQixJQUFiQyxJQUVBLE9BeEJKM0MsRUFBa0J6RCxNQUFRLFFBRTFCNEYsSUF5QkEsTUFFTThDLEVBQW9CLFFEbFl2QkQsZUFBZ0NFLEVBQW9CQyxHQUN2RCxNQUFNQyxFQUE0QixFQUEwQkQsR0FFNUQsR0FBSUMsRUFBY3JILE9BQVMsRUFDdkIsTUFBTSxJQUFJaUIsTUFBTSw2Q0FHcEIsTUFBTXFHLFFBQTJCN0QsT0FBTzhELE9BQU9DLFVBQzNDLE1BQ0EsRUFBMEJMLEdBQzFCeEcsR0FDQSxFQUNBLENBQUMsY0FHQzhHLEVBQTBCLENBQzVCM0osS0FBTTZDLEVBQ04rRyxLQUFNLFVBQ05DLFdBQVksSUFDWkMsS0FBTVAsR0FRSnBILFFBQTBCd0QsT0FBTzhELE9BQU9NLFVBQzFDSixFQUNBSCxFQVB3QyxDQUN4Q3hKLEtBQU0sVUFDTmtDLE9BQVEsTUFPUixFQUNBLENBQUMsWUFHTCxhQUFheUQsT0FBTzhELE9BQU9PLFVBQVUsTUFBTzdILEdDNlZSLENBQXdCMkMsSUFBa0JwQixFQUFjaEQsT0FFaENzRCxFQUFZdEQsT0h4WXJFLElBQWtCdUosRUFBZS9ILEVHeVlwQ2lDLEVBQWtCekQsT0h6WUd1SixFR3lZMEJiLEVIellYbEgsRUd5WXNCNEYsU0FBU2hFLEVBQW1CcEQsTUFBTyxJSHhZekZ1SixFQUFNL0gsUUFBVUEsRUFDVCtILEVBR0pBLEVBQU0zQyxPQUFPLEVBQUdwRixJR3NZdkJvRSxJQUdKNkMsZUFBZWUsSUFDWGxHLEVBQVl0RCxNQUFRK0QsRUFDcEJ3RSxJQUVBLE1BQU1rQixFQUFpQzFELEVBQWdCekMsRUFBWXRELE9BRW5Fd0ksRUFBOEJpQixHQUUxQkEsU0FDTXJFLEtBek9kLFNBQXlCVSxFQUF1QjRELEdBQzVDLE1BQU1DLEVBQXdCdEgsRUFBZXFILEdBQzdDQyxFQUFJL0UsaUJBQWlCLFFBQVMsS0FDVCxhQUFia0IsRUFBSThELE1BQ0o5RCxFQUFJOEQsS0FBTyxRQUNYRCxFQUFJcEYsVUFBWSxTQUVoQnVCLEVBQUk4RCxLQUFPLFdBQ1hELEVBQUlwRixVQUFZLFVBZ0M1QnNGLENBQWdCcEcsRUFBbUIseUJBZlZxQyxFQWlCVHJDLEVBaEJrQnBCLEVBZ0JDLHlCQWYzQnVDLGlCQUFpQixRQUFTNkQsZ0JBWmxDQSxlQUFnQ2xELEdBQzVCLElBRUksYUFETXVFLFVBQVVDLFVBQVVDLFVBQVV6RSxJQUM3QixFQUNULE1BQU8wRSxHQUVMLE9BREFDLFFBQVFELE1BQU1BLEVBQU1FLE9BQVNGLElBQ3RCLEdBT0dHLENBQWlCdEUsRUFBSTlGLE9BQzNCcUYsRUFBOEJnRixRQUFRLFNBQVUsS0FFaERoRixFQUE4QmdGLFFBQVEsaURBQWtELE9BNkdwR2pILEVBQW1Cd0IsaUJBQWlCLFFBQVMsS0FDekMwRCxJQUNBbEQsTUFHSi9CLEVBQWlCdUIsaUJBQWlCLFFBQVMsTUFaM0MsV0FDSSxNQUFNMEYsRUFBY2xELFNBQVNoRSxFQUFtQmtILElBQUssSUFDL0NDLEVBQWNuRCxTQUFTL0QsRUFBaUJyRCxNQUFPLElBQy9DMEUsRUFBYzBDLFNBQVNoRSxFQUFtQnNCLElBQUssSUFDckR0QixFQUFtQnBELE1BQVF3SyxLQUFLOUYsSUFBSTRGLEVBQUtFLEtBQUtGLElBQUlDLEVBQUs3RixJQUFNQyxXQVM3RDhGLEdBQ0FuQyxJQUNBbEQsTUFxQko5QixFQUFZc0IsaUJBQWlCLFFBQVMsS0FDbEMsTUFBTTZFLEVBQWlDMUQsRUFBZ0J6QyxFQUFZdEQsT0FFbkV3SSxFQUE4QmlCLElBRUEsSUFBMUJBLElBSUpsQixJQUNBbkQsT0FHSjVCLEVBQWlCb0IsaUJBQWlCLFFBQVMsS0FDdkM0RSxJQUNBakIsSUFDQW5ELE1Bb0RKLE1BQU1zRixFQUF3QyxJRTNaL0IsTUFFWCxZQUEyQkMsRUFBMEJDLEdBQTFCLEtBQUFELFNBQTBCLEtBQUFDLFFBRzlDLE1BQU1DLEdBQ1d4RyxNQUFoQmlCLEtBQUtHLFNBQ0xDLGFBQWFKLEtBQUtHLFNBR3RCLE1BQU1tRixFQUF5QnZHLE1BQWpCd0csRUFBNkJBLEVBQWdCdkYsS0FBS3NGLE1BRWhFdEYsS0FBS0csUUFBVUUsV0FBVyxLQUN0QkwsS0FBS3FGLFNBQ0xyRixLQUFLRyxhQUFVcEIsR0FDaEJ1RyxLRjRZbUR0RyxFQW5XZCxLQTZXaEQsU0FBU0UsSUFDRDdCLEVBQTJCM0MsUUFBVTBDLEVBQWUxQyxNQUNwRDJDLEVBQTJCZ0YsTUFBTUUsWUFBWSxhQUFjN0QsR0FFM0RyQixFQUEyQmdGLE1BQU1FLFlBQVksYUFBYzVELEdBWm5FdkIsRUFBZWtDLGlCQUFpQixRQUFTLEtBQ3JDSCxJQUNBdkIsRUFBbUJxQixVQUFZN0IsRUFBZTFDLE1BQU13QixPQUFPbUQsV0FDM0RILElBQ0FZLElBQ0FzRixFQUF5QkksVUFXN0JuSSxFQUEyQmlDLGlCQUFpQixRQUFTLEtBQ2pEekIsRUFBK0JvQixVQUFZNUIsRUFBMkIzQyxNQUFNd0IsT0FBT21ELFdBQ25GSCxNQUdKekIsRUFBUTZCLGlCQUFpQixRQUFTLEtBQzlCdUIsTUFHSm5ELEVBQWM0QixpQkFBaUIsUUFBUyxLQUNwQ3VCLElBQ0FmLE1BR0p2QixFQUFjZSxpQkFBaUIsUUFBUyxLQUNwQ3VCLE1BR0ptQyxJQUNBa0IsSUFDQWhGIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImV4cG9ydCBmdW5jdGlvbiB0cnVuY2F0ZShpbnB1dDogc3RyaW5nLCBsZW5ndGg6IG51bWJlcik6IHN0cmluZyB7XG4gICAgaWYgKGlucHV0Lmxlbmd0aCA8PSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH1cblxuICAgIHJldHVybiBpbnB1dC5zdWJzdHIoMCwgbGVuZ3RoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0cmluZ1RvQXJyYXkoc3RyOiBzdHJpbmcpOiBVaW50OEFycmF5IHtcbiAgICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKC8qJ3V0Zi04JyovKTtcbiAgICByZXR1cm4gZW5jb2Rlci5lbmNvZGUoc3RyKTtcbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBjb3B5KHNvdXJjZTogVWludDhBcnJheSwgc291cmNlSW5kZXg6IG51bWJlciwgdGFyZ2V0OiBVaW50OEFycmF5LCB0YXJnZXRJbmRleDogbnVtYmVyLCBsZW5ndGg6IG51bWJlcik6IHZvaWQge1xuICAgIGZvciAobGV0IGk6IG51bWJlciA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICB0YXJnZXRbaSArIHRhcmdldEluZGV4XSA9IHNvdXJjZVtpICsgc291cmNlSW5kZXhdO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5QnVmZmVyVG9VbnNpZ25lZEJpZ0ludChhcnJheUJ1ZmZlcjogQXJyYXlCdWZmZXIpOiBiaWdpbnQge1xuICAgIGNvbnN0IGxlbmd0aDogbnVtYmVyID0gYXJyYXlCdWZmZXIuYnl0ZUxlbmd0aDtcbiAgICBjb25zdCBhcnJheVZpZXc6IERhdGFWaWV3ID0gbmV3IERhdGFWaWV3KGFycmF5QnVmZmVyLCAwKTtcblxuICAgIGxldCByZXN1bHQ6IGJpZ2ludCA9IDBuO1xuXG4gICAgZm9yIChsZXQgaTogbnVtYmVyID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIHJlc3VsdCArPSBCaWdJbnQoYXJyYXlWaWV3LmdldFVpbnQ4KGkpKSAqICgyNTZuICoqIEJpZ0ludChpKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvQ3VzdG9tQmFzZShieXRlczogQXJyYXlCdWZmZXIsIGFscGhhYmV0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGFscGhhYmV0TGVuZ3RoOiBiaWdpbnQgPSBCaWdJbnQoYWxwaGFiZXQubGVuZ3RoKTtcblxuICAgIGxldCByZXN1bHQ6IHN0cmluZyA9ICcnO1xuICAgIGxldCBudW1iZXI6IGJpZ2ludCA9IGFycmF5QnVmZmVyVG9VbnNpZ25lZEJpZ0ludChieXRlcyk7XG5cbiAgICB3aGlsZSAobnVtYmVyID4gMG4pXG4gICAge1xuICAgICAgICBjb25zdCByZW1haW5kZXI6IGJpZ2ludCA9IG51bWJlciAlIGFscGhhYmV0TGVuZ3RoO1xuICAgICAgICBudW1iZXIgLz0gYWxwaGFiZXRMZW5ndGg7XG5cbiAgICAgICAgY29uc3QgaW5kZXg6IG51bWJlciA9IDxudW1iZXI+PGFueT5CaWdJbnQuYXNVaW50Tig2NCwgcmVtYWluZGVyKTtcblxuICAgICAgICByZXN1bHQgKz0gYWxwaGFiZXRbaW5kZXhdO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBidWZmZXJUb0hleGFkZXhpbWFsKGJ1ZmZlcjogQXJyYXlCdWZmZXIpOiBzdHJpbmcge1xuICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUubWFwLmNhbGwoXG4gICAgICAgIG5ldyBVaW50OEFycmF5KGJ1ZmZlciksXG4gICAgICAgIHggPT4gKCcwMCcgKyB4LnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpXG4gICAgKS5qb2luKCcnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJ1ZmZlclRvQmFzZTY0KGJ1ZmZlcjogQXJyYXlCdWZmZXIpOiBzdHJpbmcge1xuICAgIHJldHVybiBidG9hKFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKSBhcyBhbnkpKTtcbn1cbiIsImltcG9ydCAqIGFzIHN0cmluZ1V0aWxzIGZyb20gJy4vc3RyaW5nVXRpbHMnO1xuaW1wb3J0ICogYXMgYXJyYXlVdGlscyBmcm9tICcuL2FycmF5VXRpbHMnO1xuXG5jb25zdCBBTEdPUklUSE1fTkFNRTogc3RyaW5nID0gJ1BCS0RGMic7XG5leHBvcnQgY29uc3QgQkFTRTYyX0FMUEhBQkVUOiBzdHJpbmcgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWjAxMjM0NTY3ODknO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVQYXNzd29yZChwcml2YXRlS2V5OiBzdHJpbmcsIHB1YmxpY0tleTogc3RyaW5nKTogUHJvbWlzZTxBcnJheUJ1ZmZlcj4ge1xuICAgIGNvbnN0IGFsZ29yaXRobVNhbHQ6IFVpbnQ4QXJyYXkgPSBzdHJpbmdVdGlscy5zdHJpbmdUb0FycmF5KHB1YmxpY0tleSk7XG5cbiAgICBpZiAoYWxnb3JpdGhtU2FsdC5sZW5ndGggPCA4KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUHVibGljIGtleSBtdXN0IGJlIGF0IGxlYXN0IDggYnl0ZXMgbG9uZy4nKTtcbiAgICB9XG5cbiAgICBjb25zdCBiYXNlS2V5OiBDcnlwdG9LZXkgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmltcG9ydEtleShcbiAgICAgICAgJ3JhdycsXG4gICAgICAgIHN0cmluZ1V0aWxzLnN0cmluZ1RvQXJyYXkocHJpdmF0ZUtleSksXG4gICAgICAgIEFMR09SSVRITV9OQU1FLFxuICAgICAgICBmYWxzZSxcbiAgICAgICAgWydkZXJpdmVLZXknXVxuICAgICk7XG5cbiAgICBjb25zdCBhbGdvcml0aG06IFBia2RmMlBhcmFtcyA9IHtcbiAgICAgICAgbmFtZTogQUxHT1JJVEhNX05BTUUsXG4gICAgICAgIGhhc2g6ICdTSEEtNTEyJyxcbiAgICAgICAgaXRlcmF0aW9uczogMTAwMDAwLFxuICAgICAgICBzYWx0OiBhbGdvcml0aG1TYWx0XG4gICAgfTtcblxuICAgIGNvbnN0IGRlcml2ZWRLZXlUeXBlOiBBZXNEZXJpdmVkS2V5UGFyYW1zID0ge1xuICAgICAgICBuYW1lOiAnQUVTLUNCQycsXG4gICAgICAgIGxlbmd0aDogMjU2XG4gICAgfTtcblxuICAgIGNvbnN0IHJlc3VsdDogQ3J5cHRvS2V5ID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5kZXJpdmVLZXkoXG4gICAgICAgIGFsZ29yaXRobSxcbiAgICAgICAgYmFzZUtleSxcbiAgICAgICAgZGVyaXZlZEtleVR5cGUsXG4gICAgICAgIHRydWUsXG4gICAgICAgIFsnZW5jcnlwdCddXG4gICAgKTtcblxuICAgIHJldHVybiBhd2FpdCBjcnlwdG8uc3VidGxlLmV4cG9ydEtleSgncmF3JywgcmVzdWx0KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlUmFuZG9tU3RyaW5nKGJ5dGVDb3VudDogbnVtYmVyID0gNjQsIGFscGhhYmV0OiBzdHJpbmcgPSBCQVNFNjJfQUxQSEFCRVQpOiBzdHJpbmcge1xuICAgIGNvbnN0IGFycmF5OiBVaW50OEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYnl0ZUNvdW50KTtcbiAgICBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKGFycmF5KTtcbiAgICByZXR1cm4gYXJyYXlVdGlscy50b0N1c3RvbUJhc2UoYXJyYXkuYnVmZmVyLCBCQVNFNjJfQUxQSEFCRVQpO1xufVxuIiwiaW1wb3J0ICogYXMgY3J5cHRvIGZyb20gJy4vY3J5cHRvJztcbmltcG9ydCAqIGFzIHN0cmluZ1V0aWxzIGZyb20gJy4vc3RyaW5nVXRpbHMnO1xuaW1wb3J0ICogYXMgYXJyYXlVdGlscyBmcm9tICcuL2FycmF5VXRpbHMnO1xuXG5pbXBvcnQgVmlzdWFsRmVlZGJhY2sgZnJvbSAnLi9WaXN1YWxGZWVkYmFjayc7XG5pbXBvcnQgVGltZWRBY3Rpb24gZnJvbSAnLi9UaW1lZEFjdGlvbic7XG5cbmZ1bmN0aW9uIGdldEVsZW1lbnRCeUlkKGVsZW1lbnROYW1lOiBzdHJpbmcpOiBIVE1MSW5wdXRFbGVtZW50IHtcbiAgICBjb25zdCBlbGVtZW50OiBIVE1MRWxlbWVudHxudWxsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxlbWVudE5hbWUpO1xuXG4gICAgaWYgKGVsZW1lbnROYW1lID09PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRE9NIGVsZW1lbnQgJyR7ZWxlbWVudE5hbWV9JyBub3QgZm91bmQuYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVsZW1lbnQgYXMgSFRNTElucHV0RWxlbWVudDtcbn1cblxudHlwZSBQbGFpbk9iamVjdCA9IHsgW2tleTogc3RyaW5nXTogYW55IH07XG5cbmNvbnN0IHR4dFByaXZhdGVQYXJ0OiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3R4dFByaXZhdGVQYXJ0Jyk7XG5jb25zdCB0eHRQcml2YXRlUGFydENvbmZpcm1hdGlvbjogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCd0eHRQcml2YXRlUGFydENvbmZpcm1hdGlvbicpO1xuY29uc3QgYnRuUHJvdGVjdDogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCdidG5Qcm90ZWN0Jyk7XG5jb25zdCBidG5DbGVhclByb3RlY3RlZDogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCdidG5DbGVhclByb3RlY3RlZCcpO1xuY29uc3Qgc3BuUHJvdGVjdGVkQ29uZmlybWF0aW9uOiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3NwblByb3RlY3RlZENvbmZpcm1hdGlvbicpO1xuY29uc3QgdHh0UGF0aDogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCd0eHRQYXRoJyk7XG5jb25zdCB0eHRQdWJsaWNQYXJ0OiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3R4dFB1YmxpY1BhcnQnKTtcbmNvbnN0IGJ0bkdlbmVyYXRlUHVibGljUGFydDogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCdidG5HZW5lcmF0ZVB1YmxpY1BhcnQnKTtcblxuY29uc3Qgc3BuUHJpdmF0ZVBhcnRTaXplOiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3NwblByaXZhdGVQYXJ0U2l6ZScpO1xuY29uc3Qgc3BuUHJpdmF0ZVBhcnRTaXplQ29uZmlybWF0aW9uOiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3NwblByaXZhdGVQYXJ0U2l6ZUNvbmZpcm1hdGlvbicpO1xuXG5jb25zdCBudW1PdXRwdXRTaXplUmFuZ2U6IEhUTUxJbnB1dEVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZCgnbnVtT3V0cHV0U2l6ZVJhbmdlJyk7XG5jb25zdCBudW1PdXRwdXRTaXplTnVtOiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ251bU91dHB1dFNpemVOdW0nKTtcblxuY29uc3QgdHh0QWxwaGFiZXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZCgndHh0QWxwaGFiZXQnKTtcbmNvbnN0IHNwbkFscGhhYmV0U2l6ZTogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCdzcG5BbHBoYWJldFNpemUnKTtcbmNvbnN0IGJ0blJlc2V0QWxwaGFiZXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZCgnYnRuUmVzZXRBbHBoYWJldCcpO1xuXG5jb25zdCB0eHRSZXN1bHRQYXNzd29yZDogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCd0eHRSZXN1bHRQYXNzd29yZCcpO1xuXG5jb25zdCBzcG5SZXN1bHRQYXNzd29yZExlbmd0aDogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCdzcG5SZXN1bHRQYXNzd29yZExlbmd0aCcpO1xuXG5jb25zdCBzcG5Db3B5UmVzdWx0UGFzc3dvcmRGZWVkYmFjazogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCdzcG5Db3B5UmVzdWx0UGFzc3dvcmRGZWVkYmFjaycpO1xuXG5jb25zdCB0eHRQYXJhbWV0ZXJzOiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3R4dFBhcmFtZXRlcnMnKTtcbmNvbnN0IHR4dEN1c3RvbUtleXM6IEhUTUxJbnB1dEVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZCgndHh0Q3VzdG9tS2V5cycpO1xuXG5jb25zdCBERUZBVUxUX0xFTkdUSDogbnVtYmVyID0gNjQ7XG5cbi8vIEFscGhhYmV0IHYxIGlzIHNjcmV3ZWQsIHRoZSBjaGFyYWN0ZXIgeyBhcHBlYXJzIHR3aWNlIGFuZCB9IGlzIG1pc3NpbmcuXG5jb25zdCBERUZBVUxUX0FMUEhBQkVUX1YxOiBzdHJpbmcgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWjAxMjM0NTY3ODlgfiFAIyQlXiYqKClfLT0rW3tde3w7OlxcJ1wiLDwuPi8/Jztcbi8vIEFscGhhYmV0IHYyIGlzIGNvcnJlY3QgYW5kIGluIEFTQ0lJIG9yZGVyLlxuY29uc3QgREVGQVVMVF9BTFBIQUJFVF9WMjogc3RyaW5nID0gJyFcIiMkJSZcXCcoKSorLC0uLzAxMjM0NTY3ODk6Ozw9Pj9AQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVpbXV5fYGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6e3x9fic7XG5cbmNvbnN0IERFRkFVTFRfQUxQSEFCRVQ6IHN0cmluZyA9IERFRkFVTFRfQUxQSEFCRVRfVjI7XG5cbmNvbnN0IFBSSVZBVEVfUEFSVF9QUk9URUNUSU9OX1RJTUVPVVQ6IG51bWJlciA9IDYwICogMTAwMDtcblxuY29uc3QgU1VDQ0VTU19DT0xPUjogc3RyaW5nID0gJyNEMEZGRDAnO1xuY29uc3QgRVJST1JfQ09MT1I6IHN0cmluZyA9ICcjRkZEMEQwJztcblxuY29uc3QgUkVTRVJWRURfS0VZUzogc3RyaW5nW10gPSBbJ2FscGhhYmV0JywgJ2xlbmd0aCcsICdwdWJsaWMnXTtcblxuLy8gZGFmdXEhP1xubnVtT3V0cHV0U2l6ZVJhbmdlLm1heCA9IERFRkFVTFRfTEVOR1RILnRvU3RyaW5nKCk7XG5udW1PdXRwdXRTaXplUmFuZ2UudmFsdWUgPSBERUZBVUxUX0xFTkdUSC50b1N0cmluZygpO1xuXG5sZXQgcHJpdmF0ZVBhcnQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcblxuYnRuR2VuZXJhdGVQdWJsaWNQYXJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGNvbnN0IHJhbmRvbVN0cmluZzogc3RyaW5nID0gY3J5cHRvLmdlbmVyYXRlUmFuZG9tU3RyaW5nKCk7XG4gICAgdHh0UHVibGljUGFydC52YWx1ZSA9IHJhbmRvbVN0cmluZztcbiAgICBydW4oKTtcbn0pO1xuXG5mdW5jdGlvbiBnZXRQcml2YXRlUGFydCgpOiBzdHJpbmcge1xuICAgIGlmIChwcml2YXRlUGFydCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBwcml2YXRlUGFydDtcbiAgICB9XG4gICAgcmV0dXJuIHR4dFByaXZhdGVQYXJ0LnZhbHVlO1xufVxuXG5mdW5jdGlvbiBwcm90ZWN0UHJpdmF0ZVBhcnQoKTogdm9pZCB7XG4gICAgaWYgKHR4dFByaXZhdGVQYXJ0LnZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgcHJpdmF0ZVBhcnQgPSB0eHRQcml2YXRlUGFydC52YWx1ZTtcbiAgICBzcG5Qcm90ZWN0ZWRDb25maXJtYXRpb24uaW5uZXJIVE1MID0gYFByb3RlY3RlZCwgJHtwcml2YXRlUGFydC5sZW5ndGh9IGNoYXJhY3RlcnNgO1xuXG4gICAgdHh0UHJpdmF0ZVBhcnQudmFsdWUgPSAnJztcbiAgICB0eHRQcml2YXRlUGFydENvbmZpcm1hdGlvbi52YWx1ZSA9ICcnO1xuICAgIHNwblByaXZhdGVQYXJ0U2l6ZS5pbm5lckhUTUwgPSAnMCc7XG4gICAgc3BuUHJpdmF0ZVBhcnRTaXplQ29uZmlybWF0aW9uLmlubmVySFRNTCA9ICcwJztcblxuICAgIHVwZGF0ZVByaXZhdGVQYXJ0c01hdGNoaW5nKCk7XG59XG5cbmJ0blByb3RlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgcHJvdGVjdFByaXZhdGVQYXJ0KCk7XG59KTtcblxuZnVuY3Rpb24gY2xlYXJQcml2YXRlUGFydFByb3RlY3Rpb24oKSB7XG4gICAgcHJpdmF0ZVBhcnQgPSB1bmRlZmluZWQ7XG4gICAgc3BuUHJvdGVjdGVkQ29uZmlybWF0aW9uLmlubmVySFRNTCA9ICcnO1xufVxuXG5idG5DbGVhclByb3RlY3RlZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjbGVhclByaXZhdGVQYXJ0UHJvdGVjdGlvbigpO1xuICAgIHJ1bigpO1xufSk7XG5cbmZ1bmN0aW9uIHVwZGF0ZUN1c3RvbUtleXNEaXNwbGF5KGlzVmFsaWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBpZiAoaXNWYWxpZCkge1xuICAgICAgICB0eHRDdXN0b21LZXlzLnN0eWxlLnJlbW92ZVByb3BlcnR5KCdiYWNrZ3JvdW5kJyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0eHRDdXN0b21LZXlzLnN0eWxlLnNldFByb3BlcnR5KCdiYWNrZ3JvdW5kJywgRVJST1JfQ09MT1IpO1xufVxuXG5mdW5jdGlvbiBwYXJzZUN1c3RvbUtleXMoKTogUGxhaW5PYmplY3QgfCBudWxsIHtcbiAgICBpZiAodHh0Q3VzdG9tS2V5cy52YWx1ZSA9PT0gJycpIHtcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG9iajogYW55ID0gSlNPTi5wYXJzZSh0eHRDdXN0b21LZXlzLnZhbHVlKTtcbiAgICAgICAgaWYgKG9iaiA9PT0gbnVsbCB8fCBvYmouY29uc3RydWN0b3IubmFtZSAhPT0gJ09iamVjdCcpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmogYXMgUGxhaW5PYmplY3Q7XG4gICAgfSBjYXRjaCB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gc2hhbGxvd01lcmdlKHNvdXJjZTogUGxhaW5PYmplY3QgfCBudWxsLCB0YXJnZXQ6IFBsYWluT2JqZWN0IHwgbnVsbCk6IFBsYWluT2JqZWN0IHtcbiAgICBjb25zdCByZXN1bHQ6IFBsYWluT2JqZWN0ID0ge307XG5cbiAgICBpZiAoc291cmNlICE9IG51bGwpIHtcbiAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoc291cmNlKSkge1xuICAgICAgICAgICAgaWYgKFJFU0VSVkVEX0tFWVMuaW5jbHVkZXMoa2V5KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRhcmdldCAhPSBudWxsKSB7XG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRhcmdldCkpIHtcbiAgICAgICAgICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBkZWVwTWVyZ2Uoc291cmNlOiBQbGFpbk9iamVjdCwgdGFyZ2V0OiBQbGFpbk9iamVjdCk6IHZvaWQge1xuICAgIGZvciAoY29uc3Qgc291cmNlS2V5IG9mIE9iamVjdC5rZXlzKHNvdXJjZSkpIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0VmFsdWU6IGFueSA9IHRhcmdldFtzb3VyY2VLZXldO1xuICAgICAgICBjb25zdCBzb3VyY2VWYWx1ZTogYW55ID0gc291cmNlW3NvdXJjZUtleV07XG5cbiAgICAgICAgaWYgKHRhcmdldFZhbHVlID09PSB1bmRlZmluZWQgfHxcbiAgICAgICAgICAgIHRhcmdldFZhbHVlID09PSBudWxsIHx8XG4gICAgICAgICAgICB0YXJnZXRWYWx1ZS5jb25zdHJ1Y3Rvci5uYW1lICE9PSAnT2JqZWN0JyB8fFxuICAgICAgICAgICAgc291cmNlVmFsdWUuY29uc3RydWN0b3IubmFtZSAhPT0gJ09iamVjdCcpIHtcbiAgICAgICAgICAgIHRhcmdldFtzb3VyY2VLZXldID0gc291cmNlVmFsdWU7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRlZXBNZXJnZShzb3VyY2VWYWx1ZSwgdGFyZ2V0VmFsdWUpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gc2V0dXBWaWV3QnV0dG9uKHR4dDogSFRNTElucHV0RWxlbWVudCwgYnV0dG9uTmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgYnRuOiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoYnV0dG9uTmFtZSk7XG4gICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBpZiAodHh0LnR5cGUgPT09ICdwYXNzd29yZCcpIHtcbiAgICAgICAgICAgIHR4dC50eXBlID0gJ2lucHV0JztcbiAgICAgICAgICAgIGJ0bi5pbm5lckhUTUwgPSAnSGlkZSc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0eHQudHlwZSA9ICdwYXNzd29yZCc7XG4gICAgICAgICAgICBidG4uaW5uZXJIVE1MID0gJ1ZpZXcnO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmNvbnN0IGNvcHlUb0NsaXBib2FyZEZlZWRiYWNrT2JqZWN0OiBWaXN1YWxGZWVkYmFjayA9IG5ldyBWaXN1YWxGZWVkYmFjayhzcG5Db3B5UmVzdWx0UGFzc3dvcmRGZWVkYmFjayk7XG5cbmFzeW5jIGZ1bmN0aW9uIHdyaXRlVG9DbGlwYm9hcmQodGV4dDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQodGV4dCk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3Iuc3RhY2sgfHwgZXJyb3IpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBzZXR1cENvcHlCdXR0b24odHh0OiBIVE1MSW5wdXRFbGVtZW50LCBidXR0b25OYW1lOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBidG46IEhUTUxJbnB1dEVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZChidXR0b25OYW1lKTtcbiAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGlmIChhd2FpdCB3cml0ZVRvQ2xpcGJvYXJkKHR4dC52YWx1ZSkpIHtcbiAgICAgICAgICAgIGNvcHlUb0NsaXBib2FyZEZlZWRiYWNrT2JqZWN0LnNldFRleHQoJ0NvcGllZCcsIDMwMDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29weVRvQ2xpcGJvYXJkRmVlZGJhY2tPYmplY3Quc2V0VGV4dCgnPHNwYW4gc3R5bGU9XCJjb2xvcjogcmVkXCI+RmFpbGVkIHRvIGNvcHk8L3NwYW4+JywgMzAwMCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlUmVzdWx0UGFzc3dvcmRMZW5ndGgoKSB7XG4gICAgc3BuUmVzdWx0UGFzc3dvcmRMZW5ndGguaW5uZXJIVE1MID0gdHh0UmVzdWx0UGFzc3dvcmQudmFsdWUubGVuZ3RoLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJyAnKTtcbn1cblxuc2V0dXBWaWV3QnV0dG9uKHR4dFJlc3VsdFBhc3N3b3JkLCAnYnRuVmlld1Jlc3VsdFBhc3N3b3JkJyk7XG5cbnNldHVwQ29weUJ1dHRvbih0eHRSZXN1bHRQYXNzd29yZCwgJ2J0bkNvcHlSZXN1bHRQYXNzd29yZCcpO1xuXG5mdW5jdGlvbiBpc0FscGhhYmV0VmFsaWQoYWxwaGFiZXQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHNvcnRlZEFscGhhYmV0OiBzdHJpbmdbXSA9IGFscGhhYmV0LnNwbGl0KCcnKTtcbiAgICBzb3J0ZWRBbHBoYWJldC5zb3J0KCk7XG5cbiAgICBmb3IgKGxldCBpOiBudW1iZXIgPSAxOyBpIDwgc29ydGVkQWxwaGFiZXQubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgaWYgKHNvcnRlZEFscGhhYmV0W2kgLSAxXSA9PT0gc29ydGVkQWxwaGFiZXRbaV0pIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xufVxuXG50eXBlIElDaGFpbkluZm8gPSB7XG4gICAgaGVhZDogUGxhaW5PYmplY3QsXG4gICAgdGFpbFBhcmVudDogUGxhaW5PYmplY3QsXG4gICAgdGFpbDogUGxhaW5PYmplY3Rcbn07XG5cbi8vIFRyYW5zZm9ybXMgYSBwYXRoIGxpa2UgXCJhL2IvYy9kXCIgaW50byBhIGhpZXJhcmNoeSBvZiBvYmplY3RzIGxpa2UgeyBcImFcIjogeyBcImJcIjogeyBcImNcIjogeyBcImRcIjoge30gfSB9IH0gfVxuLy8gRnJvbSB0aGUgcmVzdWx0IG9iamVjdCwgaGVhZCBpcyB0aGUgcm9vdCBvYmplY3QgdGhhdCBjb250YWlucyBcImFcIiwgdGFpbCBpcyB0aGUgdmFsdWUgb2YgXCJkXCIsIGFuZCB0YWlsUGFyZW50IGlzIHRoZSB2YWx1ZSBvZiBcImNcIlxuZnVuY3Rpb24gcGF0aFRvT2JqZWN0Q2hhaW4ocGF0aDogc3RyaW5nLCBjaGFpbkluZm86IElDaGFpbkluZm8gfCB1bmRlZmluZWQgPSB1bmRlZmluZWQpOiBJQ2hhaW5JbmZvIHtcbiAgICBjb25zdCBzZXBhcmF0b3JJbmRleDogbnVtYmVyID0gcGF0aC5pbmRleE9mKCcvJyk7XG5cbiAgICBjb25zdCB0YWlsOiBQbGFpbk9iamVjdCA9IHt9O1xuXG4gICAgY29uc3QgZmlyc3RQYXRoOiBzdHJpbmcgPSBzZXBhcmF0b3JJbmRleCA+PSAwID8gcGF0aC5zdWJzdHIoMCwgc2VwYXJhdG9ySW5kZXgpIDogcGF0aDtcbiAgICBjb25zdCByZW1haW5pbmdQYXRoOiBzdHJpbmcgfCB1bmRlZmluZWQgPSBzZXBhcmF0b3JJbmRleCA+PSAwID8gcGF0aC5zdWJzdHIoc2VwYXJhdG9ySW5kZXggKyAxKSA6IHVuZGVmaW5lZDtcblxuICAgIGlmIChjaGFpbkluZm8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb25zdCBub2RlOiBQbGFpbk9iamVjdCA9IHt9O1xuICAgICAgICBub2RlW2ZpcnN0UGF0aF0gPSB0YWlsO1xuICAgICAgICBjaGFpbkluZm8gPSB7XG4gICAgICAgICAgICBoZWFkOiBub2RlLFxuICAgICAgICAgICAgdGFpbFBhcmVudDogbm9kZSxcbiAgICAgICAgICAgIHRhaWxcbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjaGFpbkluZm8udGFpbFtmaXJzdFBhdGhdID0gdGFpbDtcbiAgICAgICAgY2hhaW5JbmZvLnRhaWxQYXJlbnQgPSBjaGFpbkluZm8udGFpbDtcbiAgICAgICAgY2hhaW5JbmZvLnRhaWwgPSB0YWlsO1xuICAgIH1cblxuICAgIGlmIChyZW1haW5pbmdQYXRoKSB7XG4gICAgICAgIHJldHVybiBwYXRoVG9PYmplY3RDaGFpbihyZW1haW5pbmdQYXRoLCBjaGFpbkluZm8pO1xuICAgIH1cblxuICAgIHJldHVybiBjaGFpbkluZm87XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVBhc3N3b3JkR2VuZXJhdGlvblBhcmFtZXRlcnMoKTogdm9pZCB7XG4gICAgaWYgKGNhblJ1bigpID09PSBmYWxzZSkge1xuICAgICAgICB0eHRQYXJhbWV0ZXJzLnZhbHVlID0gJyc7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBjaGFpbkluZm86IElDaGFpbkluZm8gPSBwYXRoVG9PYmplY3RDaGFpbih0eHRQYXRoLnZhbHVlKTtcbiAgICBjb25zdCBsZWFmOiBQbGFpbk9iamVjdCA9IGNoYWluSW5mby50YWlsO1xuXG4gICAgbGVhZi5wdWJsaWMgPSB0eHRQdWJsaWNQYXJ0LnZhbHVlO1xuXG4gICAgY29uc3QgbnVtZXJpY1ZhbHVlOiBudW1iZXIgPSBwYXJzZUludChudW1PdXRwdXRTaXplTnVtLnZhbHVlLCAxMCk7XG4gICAgaWYgKG51bWVyaWNWYWx1ZSAhPT0gREVGQVVMVF9MRU5HVEgpIHtcbiAgICAgICAgbGVhZi5sZW5ndGggPSBudW1lcmljVmFsdWU7XG4gICAgfVxuXG4gICAgY29uc3QgYWxwaGFiZXQ6IHN0cmluZyA9IHR4dEFscGhhYmV0LnZhbHVlO1xuICAgIGlmIChhbHBoYWJldCAhPT0gREVGQVVMVF9BTFBIQUJFVCkge1xuICAgICAgICBsZWFmLmFscGhhYmV0ID0gYWxwaGFiZXQ7XG4gICAgfVxuXG4gICAgY29uc3QgY3VzdG9tS2V5czogUGxhaW5PYmplY3QgfCBudWxsID0gcGFyc2VDdXN0b21LZXlzKCk7XG4gICAgdXBkYXRlQ3VzdG9tS2V5c0Rpc3BsYXkoY3VzdG9tS2V5cyAhPT0gbnVsbCk7XG4gICAgY29uc3QgcmVzdWx0UGFyYW1ldGVyczogUGxhaW5PYmplY3QgPSBzaGFsbG93TWVyZ2UoY3VzdG9tS2V5cywgbGVhZik7XG5cbiAgICBpZiAoT2JqZWN0LmtleXMocmVzdWx0UGFyYW1ldGVycykubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIC8vIFNldCB0aGUgdmFsdWUgb2YgdGhlIGZpcnN0IChzaW5nbGUpIHByb3BlcnR5IG9mIHRoZSBvYmplY3QgdG8gbnVsbC5cbiAgICAgICAgY2hhaW5JbmZvLnRhaWxQYXJlbnRbT2JqZWN0LmtleXMoY2hhaW5JbmZvLnRhaWxQYXJlbnQpWzBdXSA9IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY2hhaW5JbmZvLnRhaWxQYXJlbnRbT2JqZWN0LmtleXMoY2hhaW5JbmZvLnRhaWxQYXJlbnQpWzBdXSA9IHJlc3VsdFBhcmFtZXRlcnM7XG4gICAgfVxuXG4gICAgdHh0UGFyYW1ldGVycy52YWx1ZSA9IEpTT04uc3RyaW5naWZ5KGNoYWluSW5mby5oZWFkLCB1bmRlZmluZWQsIDQpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVPdXRwdXRTaXplUmFuZ2VUb051bSgpOiB2b2lkIHtcbiAgICBudW1PdXRwdXRTaXplTnVtLnZhbHVlID0gbnVtT3V0cHV0U2l6ZVJhbmdlLnZhbHVlO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVPdXRwdXRTaXplTnVtVG9SYW5nZSgpOiB2b2lkIHtcbiAgICBjb25zdCBtaW46IG51bWJlciA9IHBhcnNlSW50KG51bU91dHB1dFNpemVSYW5nZS5taW4sIDEwKTtcbiAgICBjb25zdCB2YWw6IG51bWJlciA9IHBhcnNlSW50KG51bU91dHB1dFNpemVOdW0udmFsdWUsIDEwKTtcbiAgICBjb25zdCBtYXg6IG51bWJlciA9IHBhcnNlSW50KG51bU91dHB1dFNpemVSYW5nZS5tYXgsIDEwKTtcbiAgICBudW1PdXRwdXRTaXplUmFuZ2UudmFsdWUgPSBNYXRoLm1heChtaW4sIE1hdGgubWluKHZhbCwgbWF4KSkudG9TdHJpbmcoKTtcbn1cblxubnVtT3V0cHV0U2l6ZVJhbmdlLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgIHVwZGF0ZU91dHB1dFNpemVSYW5nZVRvTnVtKCk7XG4gICAgcnVuKCk7XG59KTtcblxubnVtT3V0cHV0U2l6ZU51bS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICB1cGRhdGVPdXRwdXRTaXplTnVtVG9SYW5nZSgpO1xuICAgIHVwZGF0ZU91dHB1dFNpemVSYW5nZVRvTnVtKCk7XG4gICAgcnVuKCk7XG59KTtcblxuZnVuY3Rpb24gdXBkYXRlQWxwaGFiZXRTaXplKCk6IHZvaWQge1xuICAgIHNwbkFscGhhYmV0U2l6ZS5pbm5lckhUTUwgPSB0eHRBbHBoYWJldC52YWx1ZS5sZW5ndGgudG9TdHJpbmcoKTtcblxuICAgIGNvbnN0IGFscGhhYmV0U2l6ZURpZ2l0Q291bnQ6IG51bWJlciA9IHR4dEFscGhhYmV0LnZhbHVlLmxlbmd0aC50b1N0cmluZygpLmxlbmd0aDtcbiAgICBpZiAoYWxwaGFiZXRTaXplRGlnaXRDb3VudCA8IDIpIHtcbiAgICAgICAgLy8gQWRkIGEgc3BhY2UgdG8ga2VlcCBhIG5pY2UgdmlzdWFsIGFsaWdubWVudC5cbiAgICAgICAgc3BuQWxwaGFiZXRTaXplLmlubmVySFRNTCA9IHNwbkFscGhhYmV0U2l6ZS5pbm5lckhUTUwucGFkU3RhcnQoMiwgJyAnKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUFscGhhYmV0VmFsaWRpdHlEaXNwbGF5KGlzQWxwaGFiZXRWYWxpZDogYm9vbGVhbik6IHZvaWQge1xuICAgIGlmIChpc0FscGhhYmV0VmFsaWQpIHtcbiAgICAgICAgdHh0QWxwaGFiZXQuc3R5bGUucmVtb3ZlUHJvcGVydHkoJ2JhY2tncm91bmQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0eHRBbHBoYWJldC5zdHlsZS5zZXRQcm9wZXJ0eSgnYmFja2dyb3VuZCcsIEVSUk9SX0NPTE9SKTtcbiAgICB9XG59XG5cbnR4dEFscGhhYmV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgIGNvbnN0IGlzQWxwaGFiZXRWYWxpZFJlc3VsdDogYm9vbGVhbiA9IGlzQWxwaGFiZXRWYWxpZCh0eHRBbHBoYWJldC52YWx1ZSk7XG5cbiAgICB1cGRhdGVBbHBoYWJldFZhbGlkaXR5RGlzcGxheShpc0FscGhhYmV0VmFsaWRSZXN1bHQpO1xuXG4gICAgaWYgKGlzQWxwaGFiZXRWYWxpZFJlc3VsdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHVwZGF0ZUFscGhhYmV0U2l6ZSgpO1xuICAgIHJ1bigpO1xufSk7XG5cbmJ0blJlc2V0QWxwaGFiZXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgcmVzZXRBbHBoYWJldCgpO1xuICAgIHVwZGF0ZUFscGhhYmV0U2l6ZSgpO1xuICAgIHJ1bigpO1xufSk7XG5cbmZ1bmN0aW9uIGNsZWFyT3V0cHV0cygpOiB2b2lkIHtcbiAgICB0eHRSZXN1bHRQYXNzd29yZC52YWx1ZSA9ICcnO1xuXG4gICAgdXBkYXRlUmVzdWx0UGFzc3dvcmRMZW5ndGgoKTtcbn1cblxuZnVuY3Rpb24gY2FuUnVuKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGFscGhhYmV0OiBzdHJpbmcgPSB0eHRBbHBoYWJldC52YWx1ZTtcblxuICAgIGlmIChpc0FscGhhYmV0VmFsaWQoYWxwaGFiZXQpID09PSBmYWxzZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKGdldFByaXZhdGVQYXJ0KCkubGVuZ3RoIDw9IDAgfHwgdHh0UHVibGljUGFydC52YWx1ZS5sZW5ndGggPCA4IHx8IGFscGhhYmV0Lmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xufVxuXG5hc3luYyBmdW5jdGlvbiBydW4oKSB7XG4gICAgdXBkYXRlUGFzc3dvcmRHZW5lcmF0aW9uUGFyYW1ldGVycygpO1xuXG4gICAgaWYgKGNhblJ1bigpID09PSBmYWxzZSkge1xuICAgICAgICBjbGVhck91dHB1dHMoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGtleUJ5dGVzOiBBcnJheUJ1ZmZlciA9IGF3YWl0IGNyeXB0by5nZW5lcmF0ZVBhc3N3b3JkKGdldFByaXZhdGVQYXJ0KCksIHR4dFB1YmxpY1BhcnQudmFsdWUpO1xuXG4gICAgY29uc3Qga2V5U3RyaW5nOiBzdHJpbmcgPSBhcnJheVV0aWxzLnRvQ3VzdG9tQmFzZShrZXlCeXRlcywgdHh0QWxwaGFiZXQudmFsdWUpO1xuICAgIHR4dFJlc3VsdFBhc3N3b3JkLnZhbHVlID0gc3RyaW5nVXRpbHMudHJ1bmNhdGUoa2V5U3RyaW5nLCBwYXJzZUludChudW1PdXRwdXRTaXplUmFuZ2UudmFsdWUsIDEwKSk7XG5cbiAgICB1cGRhdGVSZXN1bHRQYXNzd29yZExlbmd0aCgpO1xufVxuXG5hc3luYyBmdW5jdGlvbiByZXNldEFscGhhYmV0KCkge1xuICAgIHR4dEFscGhhYmV0LnZhbHVlID0gREVGQVVMVF9BTFBIQUJFVDtcbiAgICB1cGRhdGVBbHBoYWJldFNpemUoKTtcblxuICAgIGNvbnN0IGlzQWxwaGFiZXRWYWxpZFJlc3VsdDogYm9vbGVhbiA9IGlzQWxwaGFiZXRWYWxpZCh0eHRBbHBoYWJldC52YWx1ZSk7XG5cbiAgICB1cGRhdGVBbHBoYWJldFZhbGlkaXR5RGlzcGxheShpc0FscGhhYmV0VmFsaWRSZXN1bHQpO1xuXG4gICAgaWYgKGlzQWxwaGFiZXRWYWxpZFJlc3VsdCkge1xuICAgICAgICBhd2FpdCBydW4oKTtcbiAgICB9XG59XG5cbmNvbnN0IHByb3RlY3RQcml2YXRlUGFydEFjdGlvbjogVGltZWRBY3Rpb24gPSBuZXcgVGltZWRBY3Rpb24ocHJvdGVjdFByaXZhdGVQYXJ0LCBQUklWQVRFX1BBUlRfUFJPVEVDVElPTl9USU1FT1VUKTtcblxudHh0UHJpdmF0ZVBhcnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgY2xlYXJQcml2YXRlUGFydFByb3RlY3Rpb24oKTtcbiAgICBzcG5Qcml2YXRlUGFydFNpemUuaW5uZXJIVE1MID0gdHh0UHJpdmF0ZVBhcnQudmFsdWUubGVuZ3RoLnRvU3RyaW5nKCk7XG4gICAgdXBkYXRlUHJpdmF0ZVBhcnRzTWF0Y2hpbmcoKTtcbiAgICBydW4oKTtcbiAgICBwcm90ZWN0UHJpdmF0ZVBhcnRBY3Rpb24ucmVzZXQoKTtcbn0pO1xuXG5mdW5jdGlvbiB1cGRhdGVQcml2YXRlUGFydHNNYXRjaGluZygpOiB2b2lkIHtcbiAgICBpZiAodHh0UHJpdmF0ZVBhcnRDb25maXJtYXRpb24udmFsdWUgPT09IHR4dFByaXZhdGVQYXJ0LnZhbHVlKSB7XG4gICAgICAgIHR4dFByaXZhdGVQYXJ0Q29uZmlybWF0aW9uLnN0eWxlLnNldFByb3BlcnR5KCdiYWNrZ3JvdW5kJywgU1VDQ0VTU19DT0xPUik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdHh0UHJpdmF0ZVBhcnRDb25maXJtYXRpb24uc3R5bGUuc2V0UHJvcGVydHkoJ2JhY2tncm91bmQnLCBFUlJPUl9DT0xPUik7XG4gICAgfVxufTtcblxudHh0UHJpdmF0ZVBhcnRDb25maXJtYXRpb24uYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgc3BuUHJpdmF0ZVBhcnRTaXplQ29uZmlybWF0aW9uLmlubmVySFRNTCA9IHR4dFByaXZhdGVQYXJ0Q29uZmlybWF0aW9uLnZhbHVlLmxlbmd0aC50b1N0cmluZygpO1xuICAgIHVwZGF0ZVByaXZhdGVQYXJ0c01hdGNoaW5nKCk7XG59KTtcblxudHh0UGF0aC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICB1cGRhdGVQYXNzd29yZEdlbmVyYXRpb25QYXJhbWV0ZXJzKCk7XG59KTtcblxudHh0UHVibGljUGFydC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICB1cGRhdGVQYXNzd29yZEdlbmVyYXRpb25QYXJhbWV0ZXJzKCk7XG4gICAgcnVuKCk7XG59KTtcblxudHh0Q3VzdG9tS2V5cy5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICB1cGRhdGVQYXNzd29yZEdlbmVyYXRpb25QYXJhbWV0ZXJzKCk7XG59KTtcblxudXBkYXRlT3V0cHV0U2l6ZVJhbmdlVG9OdW0oKTtcbnJlc2V0QWxwaGFiZXQoKTtcbnVwZGF0ZVByaXZhdGVQYXJ0c01hdGNoaW5nKCk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBWaXN1YWxGZWVkYmFjayB7XG4gICAgcHJpdmF0ZSBlbGVtZW50OiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHRpbWVvdXQ6IG51bWJlciB8IHVuZGVmaW5lZDtcblxuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcihlbGVtZW50OiBIVE1MRWxlbWVudCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXRUZXh0KHRleHQ6IHN0cmluZywgZHVyYXRpb246IG51bWJlcikge1xuICAgICAgICB0aGlzLmVsZW1lbnQuaW5uZXJIVE1MID0gdGV4dDtcbiAgICAgICAgaWYgKHRoaXMudGltZW91dCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB0aGlzLmVsZW1lbnQuaW5uZXJIVE1MID0gJycsIGR1cmF0aW9uKTtcbiAgICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBUaW1lZEFjdGlvbiB7XG4gICAgcHJpdmF0ZSB0aW1lb3V0OiBudW1iZXIgfCB1bmRlZmluZWQ7XG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHByaXZhdGUgYWN0aW9uOiBGdW5jdGlvbiwgcHJpdmF0ZSBkZWxheTogbnVtYmVyKSB7XG4gICAgfVxuXG4gICAgcHVibGljIHJlc2V0KG92ZXJyaWRlRGVsYXk6IG51bWJlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy50aW1lb3V0ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkZWxheSA9IG92ZXJyaWRlRGVsYXkgIT0gdW5kZWZpbmVkID8gb3ZlcnJpZGVEZWxheSA6IHRoaXMuZGVsYXk7XG5cbiAgICAgICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFjdGlvbigpO1xuICAgICAgICAgICAgdGhpcy50aW1lb3V0ID0gdW5kZWZpbmVkO1xuICAgICAgICB9LCBkZWxheSk7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==
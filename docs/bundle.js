!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);class r{constructor(t){this.element=t}setText(t,e){this.element.innerHTML=t,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.element.innerHTML="",e)}}function a(t){const e=document.getElementById(t);if(null===t)throw new Error(`DOM element '${t}' not found.`);return e}function o(t,e,n){const a=new r(n);e.addEventListener("click",async()=>{await async function(t){try{return await navigator.clipboard.writeText(t),!0}catch(t){return console.error(t.stack||t),!1}}(t.value)?a.setText("Copied",3e3):a.setText('<span style="color: red">Failed to copy</span>',3e3)})}const i="#D0FFD0",s="#FFD0D0";const c="Stores the string in memory and removes it from the UI component. Prevents a physical intruder from copy/pasting the value.",u="Removes the string form memory and re-enables the UI component.",l=a("txtPrivatePart"),d=a("txtPrivatePartConfirmation"),y=a("btnProtect"),p=a("spnProtectedConfirmation"),b=a("spnPrivatePartSize"),v=a("spnPrivatePartSizeConfirmation");let f;const g=[];function h(){return void 0!==f?f:l.value}function w(){0!==l.value.length&&(f=l.value,p.innerHTML="Protected",l.value="",d.value="",b.innerHTML="0",v.innerHTML="0",l.disabled=!0,d.disabled=!0,y.innerHTML="Clear and unlock",y.title=u,C())}function m(){void 0===f?w():(f=void 0,p.innerHTML="",l.disabled=!1,d.disabled=!1,y.innerHTML="Protect and lock",y.title=c,y.disabled=!0)}function T(){m()}const P=new class{constructor(t,e){this.action=t,this.delay=e}reset(t){void 0!==this.timeout&&clearTimeout(this.timeout);const e=void 0!==t?t:this.delay;this.timeout=setTimeout(()=>{this.action(),this.timeout=void 0},e)}}(w,6e4);function E(){let t;for(t of(y.disabled=0===l.value.length,b.innerHTML=l.value.length.toString(),C(),g))t();P.reset()}function C(){d.value===l.value?d.style.setProperty("background",i):d.style.setProperty("background",s)}function L(){v.innerHTML=d.value.length.toString(),P.reset(),C()}function S(t){const e=(t=function(t){if(t.byteLength>65535)throw new Error(`Buffer too large: ${t.byteLength} bytes`);let e=t.byteLength;const n=new Uint8Array(2+t.byteLength);for(let t=0;t<2;t+=1)n[t]=e%256,e/=256;return n.set(new Uint8Array(t),2),n.buffer}(t)).byteLength,n=new DataView(t,0);let r=0n,a=1n;for(let t=0;t<e;t+=1)r+=BigInt(n.getUint8(t))*a,a*=256n;return r}function A(t,e){const n=BigInt(e.length);let r="",a=function(t){const e=t.byteLength,n=new DataView(t,0);let r=0n,a=1n;for(let t=0;t<e;t+=1)r+=BigInt(n.getUint8(t))*a,a*=256n;return r}(t);for(;a>0n;){const t=a%n;a/=n,r+=e[BigInt.asUintN(8,t)]}return r}function k(t,e){const n=BigInt(e.length);let r=0n,a=1n;for(let o=0;o<t.length;o+=1){r+=BigInt(e.indexOf(t[o]))*a,a*=n}return function(t){const e=[];for(;t>0n;){const n=t%256n;t/=256n;const r=Number(BigInt.asUintN(8,n));e.push(r)}let n=e[0];e.length>1&&(n+=256*e[1]);const r=n-(e.length-2);for(let t=0;t<r;t+=1)e.push(0);return new Uint8Array(e.slice(2)).buffer}(r)}const M="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";async function x(t,e){const n=await crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveKey"]),r={name:"PBKDF2",hash:"SHA-512",iterations:1e5,salt:e},a=await crypto.subtle.deriveKey(r,n,{name:"AES-CBC",length:256},!0,["encrypt"]);return await crypto.subtle.exportKey("raw",a)}function I(t=64,e=M){return A(function(t=64){const e=new Uint8Array(t);return crypto.getRandomValues(e).buffer}(t),e)}function B(t){return(new TextEncoder).encode(t).buffer}const H=a("btnTabPasswords"),U=a("divTabPasswords"),R=new class{constructor(t){this.hkdfPurpose=B(t),this._description=`HKDF(PBKDF2, HMAC512) [purpose: ${t}]`}get version(){return 1}get description(){return this._description}async generatePassword(t,e){const n=await x(t,e),r=await crypto.subtle.importKey("raw",n,{name:"HMAC",hash:{name:"SHA-512"}},!1,["sign"]);return await crypto.subtle.sign("HMAC",r,this.hkdfPurpose)}}("Password"),O=a("txtPath"),D=a("txtPublicPart"),F=a("btnGeneratePublicPart"),K=a("btnClearPublicPart"),j=a("btnCopyPublicPart"),N=a("spnCopyPublicPartFeedback"),_=a("numOutputSizeRange"),G=a("numOutputSizeNum"),V=a("txtAlphabet"),$=a("spnAlphabetSize"),z=a("btnResetAlphabet"),J=a("txtResultPassword"),q=a("spnResultPasswordLength"),Q=a("btnCopyResultPassword"),W=a("spnCopyResultPasswordFeedback"),X=a("txtParameters"),Y=a("txtCustomKeys"),Z=64,tt="!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~",et=["alphabet","length","public","datetime"];let nt;function rt(){D.value.length>0&&"y"!==prompt("Are you sure you want to clear the public part ?\nType 'y' to accept","")||(D.value="",ot(),ct())}function at(){if(D.value.length>0&&"y"!==prompt("Are you sure you want to generate a new public part ?\nType 'y' to accept",""))return;const t=I();D.value=t,ot(),ht()}function ot(){nt=D.value.length>0?(new Date).toISOString():void 0}function it(){q.innerHTML=J.value.length.toString().padStart(2," ")}function st(t){const e=t.split("");e.sort();for(let t=1;t<e.length;t+=1)if(e[t-1]===e[t])return!1;return!0}function ct(){if(!1===gt())return void ft();const t=function t(e,n){const r=e.indexOf("/"),a={},o=r>=0?e.substr(0,r):e,i=r>=0?e.substr(r+1):void 0;if(void 0===n){const t={};t[o]=a,n={head:t,tailParent:t,tail:a}}else n.tail[o]=a,n.tailParent=n.tail,n.tail=a;return i?t(i,n):n}(O.value),e=t.tail;e.public=D.value,e.datetime=nt;const n=J.value.length;n!==Z&&(e.length=n);const r=V.value;r!==tt&&(e.alphabet=r);const a=function(){if(""===Y.value)return{};try{const t=JSON.parse(Y.value);return null===t||"Object"!==t.constructor.name?null:t}catch{return null}}();null!==a?Y.style.removeProperty("background"):Y.style.setProperty("background",s);const o=function(t,e){const n={};if(null!==t)for(const[e,r]of Object.entries(t))!1===et.includes(e)&&(n[e]=r);if(null!==e)for(const[t,r]of Object.entries(e))n[t]=r;return n}(a,e);0===Object.keys(o).length?t.tailParent[Object.keys(t.tailParent)[0]]=null:t.tailParent[Object.keys(t.tailParent)[0]]=o,X.value=JSON.stringify(t.head,void 0,4)}function ut(){G.value=_.value}async function lt(){ut(),await ht()}async function dt(){(function(){const t=parseInt(_.min,10),e=parseInt(G.value,10),n=parseInt(_.max,10);return!1===isNaN(e)&&(_.value=Math.max(t,Math.min(e,n)).toString(),!0)})()&&ut(),await ht()}function yt(){$.innerHTML=V.value.length.toString(),V.value.length.toString().length<2&&($.innerHTML=$.innerHTML.padStart(2," "))}function pt(t){t?V.style.removeProperty("background"):V.style.setProperty("background",s)}async function bt(){const t=st(V.value);pt(t),!1!==t&&(yt(),await ht())}async function vt(){wt(),yt(),await ht()}function ft(){J.value="",X.value="",it()}function gt(){const t=V.value;return!1!==st(t)&&!(h().length<=0||D.value.length<8||t.length<2)}async function ht(){if(!1===gt())return void ft();const t=h(),e=D.value,n=B(t),r=B(e),a=A(await R.generatePassword(n,r),V.value);var o,i;J.value=(o=a,i=Math.max(4,parseInt(_.value,10)),o.length<=i?o:o.substr(0,i)),it(),ct()}async function wt(){V.value=tt,yt();const t=st(V.value);pt(t),t&&await ht()}function mt(){ct()}async function Tt(){ot(),await ht()}function Pt(){ct()}class Et{get version(){return 2}get description(){return"PBKDF2 + AES-GCM"}async encrypt(t,e){const n=new ArrayBuffer(44+t.byteLength),r=crypto.getRandomValues(new Uint8Array(n,0,12)),a=crypto.getRandomValues(new Uint8Array(n,12,16)),o={name:"AES-GCM",iv:r},i=await crypto.subtle.importKey("raw",await x(e,a),{name:"AES-GCM",length:256},!1,["encrypt"]),s=await crypto.subtle.encrypt(o,i,t);return new Uint8Array(n).set(new Uint8Array(s),28),n}async decrypt(t,e){const n=new Uint8Array(t,0,12),r=new Uint8Array(t,12,16),a=new Uint8Array(t,28),o={name:"AES-GCM",iv:n},i=await x(e,r),s=await crypto.subtle.importKey("raw",i,{name:"AES-GCM",length:256},!1,["decrypt"]);return await crypto.subtle.decrypt(o,s,a)}}const Ct=a("btnTabCiphers"),Lt=a("divTabCiphers"),St=new Et,At=a("txtCipherSource"),kt=a("txtCipherTarget"),Mt=a("btnEncrypt"),xt=a("btnDecrypt"),It=a("btnClearCipherSource"),Bt=a("spnCopyCipherTargetFeedback"),Ht=a("btnCopyCipherTarget"),Ut=a("btnClearCipherTarget");function Rt(){At.style.removeProperty("background-color")}function Ot(){At.style.setProperty("background-color",s)}function Dt(){Rt(),kt.style.removeProperty("background-color")}async function Ft(){if(At.focus(),kt.value="",Dt(),0===At.value.length)return void Ot();const t=h();if(0===t.length)return void console.warn("Private part is empty");const e=B(At.value),n=B(t),r=await St.encrypt(e,n);kt.value=function(t,e){const n=BigInt(e.length);let r="",a=S(t);for(;a>0n;){const t=a%n;a/=n,r+=e[BigInt.asUintN(8,t)]}return r}(r,M)}async function Kt(){if(At.focus(),kt.value="",Dt(),0===At.value.length)return void Ot();const t=h();var e;if(0!==t.length)try{const n=k(At.value,M),r=B(t),a=await St.decrypt(n,r);kt.value=(e=a,(new TextDecoder).decode(e))}catch(t){console.warn(`Failed to decrypt${t.message?`, error: ${t.message}`:", no error message"}`),kt.style.setProperty("background-color",s)}else console.warn("Private part is empty")}const jt=new Uint8Array([242,207,239,142,19,64,70,73,146,42,222,92,188,136,56,168]).buffer;const Nt=[new class{get version(){return 1}get description(){return"PBKDF2 + AES-GCM"}async encrypt(t,e){const n=new ArrayBuffer(28+t.byteLength),r=new DataView(n,0,12);crypto.getRandomValues(new Uint8Array(n,0,12));const a={name:"AES-GCM",iv:r},o=await crypto.subtle.importKey("raw",await x(e,jt),{name:"AES-GCM",length:256},!1,["encrypt"]),i=await crypto.subtle.encrypt(a,o,t);return new Uint8Array(n).set(new Uint8Array(i),12),n}async decrypt(t,e){const n=new DataView(t,0,12),r=new DataView(t,12),a={name:"AES-GCM",iv:n},o=await x(e,jt),i=await crypto.subtle.importKey("raw",o,{name:"AES-GCM",length:256},!1,["decrypt"]);return await crypto.subtle.decrypt(a,i,r)}},new Et],_t=a("btnTabReEncrypt"),Gt=a("divTabReEncrypt"),Vt=a("txtReEncryptSource"),$t=a("txtReEncryptTarget"),zt=a("cboReEncryptFrom"),Jt=a("cboReEncryptTo"),qt=a("btnReEncrypt"),Qt=a("btnClearReEncryptSource"),Wt=a("spnCopyReEncryptTargetFeedback"),Xt=a("btnCopyReEncryptTarget"),Yt=a("btnClearReEncryptTarget");function Zt(t,e){let n;for(n of Nt){const e=document.createElement("option");e.value=t.childNodes.length.toString(),e.text=`${n.description} (v${n.version})`,t.add(e)}t.value=e.toString()}function te(){Vt.style.removeProperty("background-color")}function ee(){te(),$t.style.removeProperty("background-color")}async function ne(){if($t.value="",ee(),0===Vt.value.length)return void Vt.style.setProperty("background-color",s);if(zt.value===Jt.value)return void $t.style.setProperty("background-color",s);const t=h();if(0===t.length)return void console.warn("Private part is empty");const e=parseInt(zt.value,10),n=parseInt(Jt.value,10),r=B(t),a=function(t){t.length%2!=0&&(t="0"+t);const e=new Uint8Array(t.length/2);for(let n=0;n<e.byteLength;n+=1)e[n]=parseInt(t.substr(2*n,2),16);return e.buffer}(Vt.value),o=await Nt[e].decrypt(a,r),i=await Nt[n].encrypt(o,r);var c;$t.value=(c=i,Array.prototype.map.call(new Uint8Array(c),t=>("00"+t.toString(16)).slice(-2)).join(""))}const re=[{getTabButton:()=>a("btnTabNothing"),getTabContent:()=>a("divTabNothing"),onTabSelected(){}},new class{init(){y.addEventListener("click",T),l.addEventListener("input",E),d.addEventListener("input",L),C(),y.title=c}},new class{getTabButton(){return H}getTabContent(){return U}onTabSelected(){}init(){var t;t=ht,g.push(t),_.max=Z.toString(),_.value=Z.toString(),K.addEventListener("click",rt),F.addEventListener("click",at),function(t,e){const n=a(e);n.addEventListener("click",()=>{"password"===t.type?(t.type="input",n.innerHTML="Hide"):(t.type="password",n.innerHTML="View")})}(J,"btnViewResultPassword"),o(D,j,N),o(J,Q,W),_.addEventListener("input",lt),G.addEventListener("input",dt),V.addEventListener("input",bt),z.addEventListener("click",vt),O.addEventListener("input",mt),D.addEventListener("input",Tt),Y.addEventListener("input",Pt),ut(),wt()}},new class{getTabButton(){return Ct}getTabContent(){return Lt}onTabSelected(){}init(){o(kt,Ht,Bt),Mt.addEventListener("click",Ft),xt.addEventListener("click",Kt),At.addEventListener("input",()=>{At.value.length>0&&Rt()}),It.addEventListener("click",()=>{At.value=""}),Ut.addEventListener("click",()=>{kt.value=""})}},new class{getTabButton(){return _t}getTabContent(){return Gt}onTabSelected(){}init(){o($t,Xt,Wt),Zt(zt,Nt.length-2),Zt(Jt,Nt.length-1),Vt.addEventListener("input",()=>{Vt.value.length>0&&te()}),Qt.addEventListener("click",()=>{Vt.value=""}),Yt.addEventListener("click",()=>{$t.value=""}),qt.addEventListener("click",ne)}}],ae=re.filter(t=>void 0!==t.getTabButton),oe=re.filter(t=>void 0!==t.init);new class{constructor(t){this.tabs=t,this._activeTabIndex=-1;for(let e=0;e<this.tabs.length;e+=1)t[e].getTabButton().addEventListener("click",()=>{this.setActiveTab(e)});this.setActiveTab(0)}get activeTabIndex(){return this._activeTabIndex}set activeTabIndex(t){if(t<0||t>=this.tabs.length)throw new Error(`Argument 'index' out of range. Must be in range [0;${this.tabs.length-1}].`);this.setActiveTab(t)}setActiveTab(t){if(t===this._activeTabIndex)return;let e;for(e of this.tabs){const t=e.getTabButton();t.style.removeProperty("font-weight"),t.style.setProperty("color","#C0C0C0"),e.getTabContent().style.setProperty("display","none")}const n=this.tabs[t].getTabButton();n.style.setProperty("font-weight","bold"),n.style.removeProperty("color"),this.tabs[t].getTabContent().style.removeProperty("display"),this._activeTabIndex=t,this.tabs[t].onTabSelected()}}(ae);const ie="8692eb5eedeba25779c7f5aafb42a1bf14e3ad48".substr(0,11);let se;for(se of(a("divInfo").innerHTML=`${ie}<br/><a href="https://github.com/TanukiSharp/ItchyPassword" target="_blank">github</a>`,oe))se.init()}]);
//# sourceMappingURL=bundle.js.map
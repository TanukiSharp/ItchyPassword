!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function r(t){return(new TextEncoder).encode(t)}function i(t,e){const n=BigInt(e.length);let r="",i=function(t){const e=t.byteLength,n=new DataView(t,0);let r=0n;for(let t=0;t<e;t+=1)r+=BigInt(n.getUint8(t))*256n**BigInt(t);return r}(t);for(;i>0n;){const t=i%n;i/=n,r+=e[BigInt.asUintN(64,t)]}return r}n.r(e);const a="PBKDF2",o="SHA-512",u="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";class s{constructor(t){this.element=t}setText(t,e){this.element.innerHTML=t,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.element.innerHTML="",e)}}function l(t){const e=document.getElementById(t);if(null===t)throw new Error(`DOM element '${t}' not found.`);return e}const c=l("txtPrivatePart"),d=l("txtPrivatePartConfirmation"),p=l("btnProtect"),v=l("btnClearProtected"),f=l("spnProtectedConfirmation"),y=l("txtPath"),b=l("txtPublicPart"),h=l("btnGeneratePublicPart"),g=l("btnCopyPublicPart"),m=l("spnCopyPublicPartFeedback"),P=l("spnPrivatePartSize"),w=l("spnPrivatePartSizeConfirmation"),L=l("numOutputSizeRange"),T=l("numOutputSizeNum"),S=l("txtAlphabet"),x=l("spnAlphabetSize"),M=l("btnResetAlphabet"),k=l("txtResultPassword"),E=l("spnResultPasswordLength"),O=l("btnCopyResultPassword"),H=l("spnCopyResultPasswordFeedback"),C=l("txtParameters"),j=l("txtCustomKeys"),I=64,A="!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~",F="#D0FFD0",R="#FFD0D0",B=["alphabet","length","public"];let D;function K(){return void 0!==D?D:c.value}function z(){0!==c.value.length&&(D=c.value,f.innerHTML=`Protected, ${D.length} characters`,c.value="",d.value="",P.innerHTML="0",w.innerHTML="0",et())}function _(){D=void 0,f.innerHTML=""}L.max=I.toString(),L.value=I.toString(),h.addEventListener("click",()=>{const t=function(t=64,e=u){const n=new Uint8Array(t);return crypto.getRandomValues(n),i(n.buffer,u)}();b.value=t,Y()}),p.addEventListener("click",()=>{z()}),v.addEventListener("click",()=>{_(),Y()});const N=new s(H),V=new s(m);function U(t,e,n){e.addEventListener("click",async()=>{await async function(t){try{return await navigator.clipboard.writeText(t),!0}catch(t){return console.error(t.stack||t),!1}}(t.value)?n.setText("Copied",3e3):n.setText('<span style="color: red">Failed to copy</span>',3e3)})}function J(){E.innerHTML=k.value.length.toString().padStart(2," ")}function G(t){const e=t.split("");e.sort();for(let t=1;t<e.length;t+=1)if(e[t-1]===e[t])return!1;return!0}function $(){if(!1===X())return void(C.value="");const t=function t(e,n){const r=e.indexOf("/"),i={},a=r>=0?e.substr(0,r):e,o=r>=0?e.substr(r+1):void 0;if(void 0===n){const t={};t[a]=i,n={head:t,tailParent:t,tail:i}}else n.tail[a]=i,n.tailParent=n.tail,n.tail=i;return o?t(o,n):n}(y.value),e=t.tail;e.public=b.value;const n=parseInt(T.value,10);n!==I&&(e.length=n);const r=S.value;r!==A&&(e.alphabet=r);const i=function(){if(""===j.value)return{};try{const t=JSON.parse(j.value);return null===t||"Object"!==t.constructor.name?null:t}catch{return null}}();null!==i?j.style.removeProperty("background"):j.style.setProperty("background",R);const a=function(t,e){const n={};if(null!==t)for(const[e,r]of Object.entries(t))!1===B.includes(e)&&(n[e]=r);if(null!==e)for(const[t,r]of Object.entries(e))n[t]=r;return n}(i,e);0===Object.keys(a).length?t.tailParent[Object.keys(t.tailParent)[0]]=null:t.tailParent[Object.keys(t.tailParent)[0]]=a,C.value=JSON.stringify(t.head,void 0,4)}function q(){T.value=L.value}function Q(){x.innerHTML=S.value.length.toString(),S.value.length.toString().length<2&&(x.innerHTML=x.innerHTML.padStart(2," "))}function W(t){t?S.style.removeProperty("background"):S.style.setProperty("background",R)}function X(){const t=S.value;return!1!==G(t)&&!(K().length<=0||b.value.length<8||t.length<2)}async function Y(){if($(),!1===X())return k.value="",void J();const t=i(await async function(t,e,n){const i=r(e),u=r(n);if(i.length<8)throw new Error("Public key must be at least 8 bytes long.");const s=await crypto.subtle.importKey("raw",r(t),a,!1,["deriveKey"]),l={name:a,hash:o,iterations:1e5,salt:i},c=await crypto.subtle.deriveKey(l,s,{name:"AES-CBC",length:256},!0,["encrypt"]),d=await crypto.subtle.exportKey("raw",c),p={name:"HMAC",hash:{name:o}},v=await crypto.subtle.importKey("raw",d,p,!1,["sign"]);return await crypto.subtle.sign("HMAC",v,u)}(K(),b.value,"Password"),S.value);var e,n;k.value=(e=t,n=parseInt(L.value,10),e.length<=n?e:e.substr(0,n)),J()}async function Z(){S.value=A,Q();const t=G(S.value);W(t),t&&await Y()}!function(t,e){const n=l(e);n.addEventListener("click",()=>{"password"===t.type?(t.type="input",n.innerHTML="Hide"):(t.type="password",n.innerHTML="View")})}(k,"btnViewResultPassword"),U(b,g,V),U(k,O,N),L.addEventListener("input",()=>{q(),Y()}),T.addEventListener("input",()=>{!function(){const t=parseInt(L.min,10),e=parseInt(T.value,10),n=parseInt(L.max,10);L.value=Math.max(t,Math.min(e,n)).toString()}(),q(),Y()}),S.addEventListener("input",()=>{const t=G(S.value);W(t),!1!==t&&(Q(),Y())}),M.addEventListener("click",()=>{Z(),Q(),Y()});const tt=new class{constructor(t,e){this.action=t,this.delay=e}reset(t){void 0===this.timeout&&clearTimeout(this.timeout);const e=void 0!==t?t:this.delay;this.timeout=setTimeout(()=>{this.action(),this.timeout=void 0},e)}}(z,6e4);function et(){d.value===c.value?d.style.setProperty("background",F):d.style.setProperty("background",R)}c.addEventListener("input",()=>{_(),P.innerHTML=c.value.length.toString(),et(),Y(),tt.reset()}),d.addEventListener("input",()=>{w.innerHTML=d.value.length.toString(),et()}),y.addEventListener("input",()=>{$()}),b.addEventListener("input",()=>{$(),Y()}),j.addEventListener("input",()=>{$()}),q(),Z(),et()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0cmluZ1V0aWxzLnRzIiwid2VicGFjazovLy8uL3NyYy9hcnJheVV0aWxzLnRzIiwid2VicGFjazovLy8uL3NyYy9jcnlwdG8udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Zpc3VhbEZlZWRiYWNrLnRzIiwid2VicGFjazovLy8uL3NyYy91aS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvVGltZWRBY3Rpb24udHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJzdHJpbmdUb0FycmF5Iiwic3RyIiwiVGV4dEVuY29kZXIiLCJlbmNvZGUiLCJ0b0N1c3RvbUJhc2UiLCJieXRlcyIsImFscGhhYmV0IiwiYWxwaGFiZXRMZW5ndGgiLCJCaWdJbnQiLCJsZW5ndGgiLCJyZXN1bHQiLCJudW1iZXIiLCJhcnJheUJ1ZmZlciIsImJ5dGVMZW5ndGgiLCJhcnJheVZpZXciLCJEYXRhVmlldyIsImdldFVpbnQ4IiwiYXJyYXlCdWZmZXJUb1Vuc2lnbmVkQmlnSW50IiwicmVtYWluZGVyIiwiYXNVaW50TiIsIkFMR09SSVRITV9OQU1FIiwiU0hBX0FMR09SSVRITV9OQU1FIiwiQkFTRTYyX0FMUEhBQkVUIiwiVmlzdWFsRmVlZGJhY2siLCJlbGVtZW50IiwidGhpcyIsInRleHQiLCJkdXJhdGlvbiIsImlubmVySFRNTCIsInRpbWVvdXQiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiZ2V0RWxlbWVudEJ5SWQiLCJlbGVtZW50TmFtZSIsImRvY3VtZW50IiwiRXJyb3IiLCJ0eHRQcml2YXRlUGFydCIsInR4dFByaXZhdGVQYXJ0Q29uZmlybWF0aW9uIiwiYnRuUHJvdGVjdCIsImJ0bkNsZWFyUHJvdGVjdGVkIiwic3BuUHJvdGVjdGVkQ29uZmlybWF0aW9uIiwidHh0UGF0aCIsInR4dFB1YmxpY1BhcnQiLCJidG5HZW5lcmF0ZVB1YmxpY1BhcnQiLCJidG5Db3B5UHVibGljUGFydCIsInNwbkNvcHlQdWJsaWNQYXJ0RmVlZGJhY2siLCJzcG5Qcml2YXRlUGFydFNpemUiLCJzcG5Qcml2YXRlUGFydFNpemVDb25maXJtYXRpb24iLCJudW1PdXRwdXRTaXplUmFuZ2UiLCJudW1PdXRwdXRTaXplTnVtIiwidHh0QWxwaGFiZXQiLCJzcG5BbHBoYWJldFNpemUiLCJidG5SZXNldEFscGhhYmV0IiwidHh0UmVzdWx0UGFzc3dvcmQiLCJzcG5SZXN1bHRQYXNzd29yZExlbmd0aCIsImJ0bkNvcHlSZXN1bHRQYXNzd29yZCIsInNwbkNvcHlSZXN1bHRQYXNzd29yZEZlZWRiYWNrIiwidHh0UGFyYW1ldGVycyIsInR4dEN1c3RvbUtleXMiLCJERUZBVUxUX0xFTkdUSCIsIkRFRkFVTFRfQUxQSEFCRVQiLCJTVUNDRVNTX0NPTE9SIiwiRVJST1JfQ09MT1IiLCJSRVNFUlZFRF9LRVlTIiwicHJpdmF0ZVBhcnQiLCJnZXRQcml2YXRlUGFydCIsInVuZGVmaW5lZCIsInByb3RlY3RQcml2YXRlUGFydCIsInVwZGF0ZVByaXZhdGVQYXJ0c01hdGNoaW5nIiwiY2xlYXJQcml2YXRlUGFydFByb3RlY3Rpb24iLCJtYXgiLCJ0b1N0cmluZyIsImFkZEV2ZW50TGlzdGVuZXIiLCJyYW5kb21TdHJpbmciLCJieXRlQ291bnQiLCJhcnJheSIsIlVpbnQ4QXJyYXkiLCJjcnlwdG8iLCJnZXRSYW5kb21WYWx1ZXMiLCJidWZmZXIiLCJydW4iLCJjb3B5UmVzdWx0UGFzc3dvcmRUb0NsaXBib2FyZEZlZWRiYWNrT2JqZWN0IiwiY29weVB1YmxpY1BhcnRUb0NsaXBib2FyZEZlZWRiYWNrT2JqZWN0Iiwic2V0dXBDb3B5QnV0dG9uIiwidHh0IiwiYnV0dG9uIiwiZmVlZGJhY2siLCJhc3luYyIsIm5hdmlnYXRvciIsImNsaXBib2FyZCIsIndyaXRlVGV4dCIsImVycm9yIiwiY29uc29sZSIsInN0YWNrIiwid3JpdGVUb0NsaXBib2FyZCIsInNldFRleHQiLCJ1cGRhdGVSZXN1bHRQYXNzd29yZExlbmd0aCIsInBhZFN0YXJ0IiwiaXNBbHBoYWJldFZhbGlkIiwic29ydGVkQWxwaGFiZXQiLCJzcGxpdCIsInNvcnQiLCJ1cGRhdGVQYXNzd29yZEdlbmVyYXRpb25QYXJhbWV0ZXJzIiwiY2FuUnVuIiwiY2hhaW5JbmZvIiwicGF0aFRvT2JqZWN0Q2hhaW4iLCJwYXRoIiwic2VwYXJhdG9ySW5kZXgiLCJpbmRleE9mIiwidGFpbCIsImZpcnN0UGF0aCIsInN1YnN0ciIsInJlbWFpbmluZ1BhdGgiLCJub2RlIiwiaGVhZCIsInRhaWxQYXJlbnQiLCJsZWFmIiwicHVibGljIiwibnVtZXJpY1ZhbHVlIiwicGFyc2VJbnQiLCJjdXN0b21LZXlzIiwib2JqIiwiSlNPTiIsInBhcnNlIiwiY29uc3RydWN0b3IiLCJwYXJzZUN1c3RvbUtleXMiLCJzdHlsZSIsInJlbW92ZVByb3BlcnR5Iiwic2V0UHJvcGVydHkiLCJyZXN1bHRQYXJhbWV0ZXJzIiwic291cmNlIiwidGFyZ2V0IiwiZW50cmllcyIsImluY2x1ZGVzIiwic2hhbGxvd01lcmdlIiwia2V5cyIsInN0cmluZ2lmeSIsInVwZGF0ZU91dHB1dFNpemVSYW5nZVRvTnVtIiwidXBkYXRlQWxwaGFiZXRTaXplIiwidXBkYXRlQWxwaGFiZXRWYWxpZGl0eURpc3BsYXkiLCJrZXlTdHJpbmciLCJwcml2YXRlS2V5IiwicHVibGljS2V5IiwiaGtkZlB1cnBvc2UiLCJhbGdvcml0aG1TYWx0IiwiaGtkZlB1cnBvc2VCeXRlcyIsImJhc2VLZXkiLCJzdWJ0bGUiLCJpbXBvcnRLZXkiLCJhbGdvcml0aG0iLCJoYXNoIiwiaXRlcmF0aW9ucyIsInNhbHQiLCJkZXJpdmVLZXkiLCJleHBvcnRLZXkiLCJobWFjUGFyYW1ldGVycyIsImhrZGZLZXkiLCJzaWduIiwiaW5wdXQiLCJyZXNldEFscGhhYmV0IiwiaXNBbHBoYWJldFZhbGlkUmVzdWx0IiwiYnV0dG9uTmFtZSIsImJ0biIsInR5cGUiLCJzZXR1cFZpZXdCdXR0b24iLCJtaW4iLCJ2YWwiLCJNYXRoIiwidXBkYXRlT3V0cHV0U2l6ZU51bVRvUmFuZ2UiLCJwcm90ZWN0UHJpdmF0ZVBhcnRBY3Rpb24iLCJhY3Rpb24iLCJkZWxheSIsIm92ZXJyaWRlRGVsYXkiLCJyZXNldCJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ04sT0FBT0MsZUFBZWIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFAs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QixNQUdKNUQsRUFBYzhCLGlCQUFpQixRQUFTLEtBQ3BDOEIsSUFDQXRCLE1BR0p0QixFQUFjYyxpQkFBaUIsUUFBUyxLQUNwQzhCLE1BR0ptQyxJQUNBc0IsSUFDQTNGIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImV4cG9ydCBmdW5jdGlvbiB0cnVuY2F0ZShpbnB1dDogc3RyaW5nLCBsZW5ndGg6IG51bWJlcik6IHN0cmluZyB7XG4gICAgaWYgKGlucHV0Lmxlbmd0aCA8PSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH1cblxuICAgIHJldHVybiBpbnB1dC5zdWJzdHIoMCwgbGVuZ3RoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0cmluZ1RvQXJyYXkoc3RyOiBzdHJpbmcpOiBVaW50OEFycmF5IHtcbiAgICBjb25zdCBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKC8qJ3V0Zi04JyovKTtcbiAgICByZXR1cm4gZW5jb2Rlci5lbmNvZGUoc3RyKTtcbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBjb3B5KHNvdXJjZTogVWludDhBcnJheSwgc291cmNlSW5kZXg6IG51bWJlciwgdGFyZ2V0OiBVaW50OEFycmF5LCB0YXJnZXRJbmRleDogbnVtYmVyLCBsZW5ndGg6IG51bWJlcik6IHZvaWQge1xuICAgIGZvciAobGV0IGk6IG51bWJlciA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICB0YXJnZXRbaSArIHRhcmdldEluZGV4XSA9IHNvdXJjZVtpICsgc291cmNlSW5kZXhdO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5QnVmZmVyVG9VbnNpZ25lZEJpZ0ludChhcnJheUJ1ZmZlcjogQXJyYXlCdWZmZXIpOiBiaWdpbnQge1xuICAgIGNvbnN0IGxlbmd0aDogbnVtYmVyID0gYXJyYXlCdWZmZXIuYnl0ZUxlbmd0aDtcbiAgICBjb25zdCBhcnJheVZpZXc6IERhdGFWaWV3ID0gbmV3IERhdGFWaWV3KGFycmF5QnVmZmVyLCAwKTtcblxuICAgIGxldCByZXN1bHQ6IGJpZ2ludCA9IDBuO1xuXG4gICAgZm9yIChsZXQgaTogbnVtYmVyID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIHJlc3VsdCArPSBCaWdJbnQoYXJyYXlWaWV3LmdldFVpbnQ4KGkpKSAqICgyNTZuICoqIEJpZ0ludChpKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvQ3VzdG9tQmFzZShieXRlczogQXJyYXlCdWZmZXIsIGFscGhhYmV0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IGFscGhhYmV0TGVuZ3RoOiBiaWdpbnQgPSBCaWdJbnQoYWxwaGFiZXQubGVuZ3RoKTtcblxuICAgIGxldCByZXN1bHQ6IHN0cmluZyA9ICcnO1xuICAgIGxldCBudW1iZXI6IGJpZ2ludCA9IGFycmF5QnVmZmVyVG9VbnNpZ25lZEJpZ0ludChieXRlcyk7XG5cbiAgICB3aGlsZSAobnVtYmVyID4gMG4pXG4gICAge1xuICAgICAgICBjb25zdCByZW1haW5kZXI6IGJpZ2ludCA9IG51bWJlciAlIGFscGhhYmV0TGVuZ3RoO1xuICAgICAgICBudW1iZXIgLz0gYWxwaGFiZXRMZW5ndGg7XG5cbiAgICAgICAgY29uc3QgaW5kZXg6IG51bWJlciA9IDxudW1iZXI+PGFueT5CaWdJbnQuYXNVaW50Tig2NCwgcmVtYWluZGVyKTtcblxuICAgICAgICByZXN1bHQgKz0gYWxwaGFiZXRbaW5kZXhdO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBidWZmZXJUb0hleGFkZXhpbWFsKGJ1ZmZlcjogQXJyYXlCdWZmZXIpOiBzdHJpbmcge1xuICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUubWFwLmNhbGwoXG4gICAgICAgIG5ldyBVaW50OEFycmF5KGJ1ZmZlciksXG4gICAgICAgIHggPT4gKCcwMCcgKyB4LnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpXG4gICAgKS5qb2luKCcnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJ1ZmZlclRvQmFzZTY0KGJ1ZmZlcjogQXJyYXlCdWZmZXIpOiBzdHJpbmcge1xuICAgIHJldHVybiBidG9hKFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKSBhcyBhbnkpKTtcbn1cbiIsImltcG9ydCAqIGFzIHN0cmluZ1V0aWxzIGZyb20gJy4vc3RyaW5nVXRpbHMnO1xuaW1wb3J0ICogYXMgYXJyYXlVdGlscyBmcm9tICcuL2FycmF5VXRpbHMnO1xuXG5jb25zdCBBTEdPUklUSE1fTkFNRTogc3RyaW5nID0gJ1BCS0RGMic7XG5jb25zdCBTSEFfQUxHT1JJVEhNX05BTUUgPSAnU0hBLTUxMic7XG5leHBvcnQgY29uc3QgQkFTRTYyX0FMUEhBQkVUOiBzdHJpbmcgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWjAxMjM0NTY3ODknO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVQYXNzd29yZChwcml2YXRlS2V5OiBzdHJpbmcsIHB1YmxpY0tleTogc3RyaW5nLCBoa2RmUHVycG9zZTogc3RyaW5nKTogUHJvbWlzZTxBcnJheUJ1ZmZlcj4ge1xuICAgIGNvbnN0IGFsZ29yaXRobVNhbHQ6IFVpbnQ4QXJyYXkgPSBzdHJpbmdVdGlscy5zdHJpbmdUb0FycmF5KHB1YmxpY0tleSk7XG4gICAgY29uc3QgaGtkZlB1cnBvc2VCeXRlczogVWludDhBcnJheSA9IHN0cmluZ1V0aWxzLnN0cmluZ1RvQXJyYXkoaGtkZlB1cnBvc2UpO1xuXG4gICAgaWYgKGFsZ29yaXRobVNhbHQubGVuZ3RoIDwgOCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1B1YmxpYyBrZXkgbXVzdCBiZSBhdCBsZWFzdCA4IGJ5dGVzIGxvbmcuJyk7XG4gICAgfVxuXG4gICAgY29uc3QgYmFzZUtleTogQ3J5cHRvS2V5ID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5pbXBvcnRLZXkoXG4gICAgICAgICdyYXcnLFxuICAgICAgICBzdHJpbmdVdGlscy5zdHJpbmdUb0FycmF5KHByaXZhdGVLZXkpLFxuICAgICAgICBBTEdPUklUSE1fTkFNRSxcbiAgICAgICAgZmFsc2UsXG4gICAgICAgIFsnZGVyaXZlS2V5J11cbiAgICApO1xuXG4gICAgY29uc3QgYWxnb3JpdGhtOiBQYmtkZjJQYXJhbXMgPSB7XG4gICAgICAgIG5hbWU6IEFMR09SSVRITV9OQU1FLFxuICAgICAgICBoYXNoOiBTSEFfQUxHT1JJVEhNX05BTUUsXG4gICAgICAgIGl0ZXJhdGlvbnM6IDEwMDAwMCxcbiAgICAgICAgc2FsdDogYWxnb3JpdGhtU2FsdFxuICAgIH07XG5cbiAgICBjb25zdCBkZXJpdmVkS2V5VHlwZTogQWVzRGVyaXZlZEtleVBhcmFtcyA9IHtcbiAgICAgICAgbmFtZTogJ0FFUy1DQkMnLFxuICAgICAgICBsZW5ndGg6IDI1NlxuICAgIH07XG5cbiAgICBjb25zdCByZXN1bHQ6IENyeXB0b0tleSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZGVyaXZlS2V5KFxuICAgICAgICBhbGdvcml0aG0sXG4gICAgICAgIGJhc2VLZXksXG4gICAgICAgIGRlcml2ZWRLZXlUeXBlLFxuICAgICAgICB0cnVlLFxuICAgICAgICBbJ2VuY3J5cHQnXVxuICAgICk7XG5cbiAgICBjb25zdCBrZXk6IEFycmF5QnVmZmVyID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5leHBvcnRLZXkoJ3JhdycsIHJlc3VsdCk7XG5cbiAgICBjb25zdCBobWFjUGFyYW1ldGVyczogSG1hY0ltcG9ydFBhcmFtcyA9IHtcbiAgICAgICAgbmFtZTogJ0hNQUMnLFxuICAgICAgICBoYXNoOiB7IG5hbWU6IFNIQV9BTEdPUklUSE1fTkFNRSB9XG4gICAgfTtcblxuICAgIGNvbnN0IGhrZGZLZXk6IENyeXB0b0tleSA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KFxuICAgICAgICAncmF3JyxcbiAgICAgICAga2V5LFxuICAgICAgICBobWFjUGFyYW1ldGVycyxcbiAgICAgICAgZmFsc2UsXG4gICAgICAgIFsnc2lnbiddXG4gICAgKTtcblxuICAgIHJldHVybiBhd2FpdCBjcnlwdG8uc3VidGxlLnNpZ24oJ0hNQUMnLCBoa2RmS2V5LCBoa2RmUHVycG9zZUJ5dGVzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlUmFuZG9tU3RyaW5nKGJ5dGVDb3VudDogbnVtYmVyID0gNjQsIGFscGhhYmV0OiBzdHJpbmcgPSBCQVNFNjJfQUxQSEFCRVQpOiBzdHJpbmcge1xuICAgIGNvbnN0IGFycmF5OiBVaW50OEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYnl0ZUNvdW50KTtcbiAgICBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKGFycmF5KTtcbiAgICByZXR1cm4gYXJyYXlVdGlscy50b0N1c3RvbUJhc2UoYXJyYXkuYnVmZmVyLCBCQVNFNjJfQUxQSEFCRVQpO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmlzdWFsRmVlZGJhY2sge1xuICAgIHByaXZhdGUgZWxlbWVudDogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSB0aW1lb3V0OiBudW1iZXIgfCB1bmRlZmluZWQ7XG5cbiAgICBwdWJsaWMgY29uc3RydWN0b3IoZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0VGV4dCh0ZXh0OiBzdHJpbmcsIGR1cmF0aW9uOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9IHRleHQ7XG4gICAgICAgIGlmICh0aGlzLnRpbWVvdXQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gdGhpcy5lbGVtZW50LmlubmVySFRNTCA9ICcnLCBkdXJhdGlvbik7XG4gICAgfVxufVxuIiwiaW1wb3J0ICogYXMgY3J5cHRvIGZyb20gJy4vY3J5cHRvJztcbmltcG9ydCAqIGFzIHN0cmluZ1V0aWxzIGZyb20gJy4vc3RyaW5nVXRpbHMnO1xuaW1wb3J0ICogYXMgYXJyYXlVdGlscyBmcm9tICcuL2FycmF5VXRpbHMnO1xuXG5pbXBvcnQgVmlzdWFsRmVlZGJhY2sgZnJvbSAnLi9WaXN1YWxGZWVkYmFjayc7XG5pbXBvcnQgVGltZWRBY3Rpb24gZnJvbSAnLi9UaW1lZEFjdGlvbic7XG5pbXBvcnQgeyBQbGFpbk9iamVjdCB9IGZyb20gJy4vUGxhaW5PYmplY3QnO1xuXG5mdW5jdGlvbiBnZXRFbGVtZW50QnlJZChlbGVtZW50TmFtZTogc3RyaW5nKTogSFRNTElucHV0RWxlbWVudCB7XG4gICAgY29uc3QgZWxlbWVudDogSFRNTEVsZW1lbnR8bnVsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1lbnROYW1lKTtcblxuICAgIGlmIChlbGVtZW50TmFtZSA9PT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYERPTSBlbGVtZW50ICcke2VsZW1lbnROYW1lfScgbm90IGZvdW5kLmApO1xuICAgIH1cblxuICAgIHJldHVybiBlbGVtZW50IGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG59XG5cbmNvbnN0IHR4dFByaXZhdGVQYXJ0OiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3R4dFByaXZhdGVQYXJ0Jyk7XG5jb25zdCB0eHRQcml2YXRlUGFydENvbmZpcm1hdGlvbjogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCd0eHRQcml2YXRlUGFydENvbmZpcm1hdGlvbicpO1xuY29uc3QgYnRuUHJvdGVjdDogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCdidG5Qcm90ZWN0Jyk7XG5jb25zdCBidG5DbGVhclByb3RlY3RlZDogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCdidG5DbGVhclByb3RlY3RlZCcpO1xuY29uc3Qgc3BuUHJvdGVjdGVkQ29uZmlybWF0aW9uOiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3NwblByb3RlY3RlZENvbmZpcm1hdGlvbicpO1xuY29uc3QgdHh0UGF0aDogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCd0eHRQYXRoJyk7XG5jb25zdCB0eHRQdWJsaWNQYXJ0OiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3R4dFB1YmxpY1BhcnQnKTtcbmNvbnN0IGJ0bkdlbmVyYXRlUHVibGljUGFydDogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCdidG5HZW5lcmF0ZVB1YmxpY1BhcnQnKTtcbmNvbnN0IGJ0bkNvcHlQdWJsaWNQYXJ0OiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ2J0bkNvcHlQdWJsaWNQYXJ0Jyk7XG5jb25zdCBzcG5Db3B5UHVibGljUGFydEZlZWRiYWNrOiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3NwbkNvcHlQdWJsaWNQYXJ0RmVlZGJhY2snKTtcblxuY29uc3Qgc3BuUHJpdmF0ZVBhcnRTaXplOiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3NwblByaXZhdGVQYXJ0U2l6ZScpO1xuY29uc3Qgc3BuUHJpdmF0ZVBhcnRTaXplQ29uZmlybWF0aW9uOiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3NwblByaXZhdGVQYXJ0U2l6ZUNvbmZpcm1hdGlvbicpO1xuXG5jb25zdCBudW1PdXRwdXRTaXplUmFuZ2U6IEhUTUxJbnB1dEVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZCgnbnVtT3V0cHV0U2l6ZVJhbmdlJyk7XG5jb25zdCBudW1PdXRwdXRTaXplTnVtOiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ251bU91dHB1dFNpemVOdW0nKTtcblxuY29uc3QgdHh0QWxwaGFiZXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZCgndHh0QWxwaGFiZXQnKTtcbmNvbnN0IHNwbkFscGhhYmV0U2l6ZTogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCdzcG5BbHBoYWJldFNpemUnKTtcbmNvbnN0IGJ0blJlc2V0QWxwaGFiZXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZCgnYnRuUmVzZXRBbHBoYWJldCcpO1xuXG5jb25zdCB0eHRSZXN1bHRQYXNzd29yZDogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCd0eHRSZXN1bHRQYXNzd29yZCcpO1xuY29uc3Qgc3BuUmVzdWx0UGFzc3dvcmRMZW5ndGg6IEhUTUxJbnB1dEVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZCgnc3BuUmVzdWx0UGFzc3dvcmRMZW5ndGgnKTtcbmNvbnN0IGJ0bkNvcHlSZXN1bHRQYXNzd29yZDogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCdidG5Db3B5UmVzdWx0UGFzc3dvcmQnKTtcbmNvbnN0IHNwbkNvcHlSZXN1bHRQYXNzd29yZEZlZWRiYWNrOiBIVE1MSW5wdXRFbGVtZW50ID0gZ2V0RWxlbWVudEJ5SWQoJ3NwbkNvcHlSZXN1bHRQYXNzd29yZEZlZWRiYWNrJyk7XG5cbmNvbnN0IHR4dFBhcmFtZXRlcnM6IEhUTUxJbnB1dEVsZW1lbnQgPSBnZXRFbGVtZW50QnlJZCgndHh0UGFyYW1ldGVycycpO1xuY29uc3QgdHh0Q3VzdG9tS2V5czogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKCd0eHRDdXN0b21LZXlzJyk7XG5cbmNvbnN0IERFRkFVTFRfTEVOR1RIOiBudW1iZXIgPSA2NDtcblxuLy8gQWxwaGFiZXQgdjEgaXMgc2NyZXdlZCwgdGhlIGNoYXJhY3RlciB7IGFwcGVhcnMgdHdpY2UgYW5kIH0gaXMgbWlzc2luZy5cbmNvbnN0IERFRkFVTFRfQUxQSEFCRVRfVjE6IHN0cmluZyA9ICdhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ekFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaMDEyMzQ1Njc4OWB+IUAjJCVeJiooKV8tPStbe117fDs6XFwnXCIsPC4+Lz8nO1xuLy8gQWxwaGFiZXQgdjIgaXMgY29ycmVjdCBhbmQgaW4gQVNDSUkgb3JkZXIuXG5jb25zdCBERUZBVUxUX0FMUEhBQkVUX1YyOiBzdHJpbmcgPSAnIVwiIyQlJlxcJygpKissLS4vMDEyMzQ1Njc4OTo7PD0+P0BBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWltdXl9gYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXp7fH1+JztcblxuY29uc3QgREVGQVVMVF9BTFBIQUJFVDogc3RyaW5nID0gREVGQVVMVF9BTFBIQUJFVF9WMjtcblxuY29uc3QgUFJJVkFURV9QQVJUX1BST1RFQ1RJT05fVElNRU9VVDogbnVtYmVyID0gNjAgKiAxMDAwO1xuXG5jb25zdCBTVUNDRVNTX0NPTE9SOiBzdHJpbmcgPSAnI0QwRkZEMCc7XG5jb25zdCBFUlJPUl9DT0xPUjogc3RyaW5nID0gJyNGRkQwRDAnO1xuXG5jb25zdCBSRVNFUlZFRF9LRVlTOiBzdHJpbmdbXSA9IFsnYWxwaGFiZXQnLCAnbGVuZ3RoJywgJ3B1YmxpYyddO1xuXG4vLyBkYWZ1cSE/XG5udW1PdXRwdXRTaXplUmFuZ2UubWF4ID0gREVGQVVMVF9MRU5HVEgudG9TdHJpbmcoKTtcbm51bU91dHB1dFNpemVSYW5nZS52YWx1ZSA9IERFRkFVTFRfTEVOR1RILnRvU3RyaW5nKCk7XG5cbmxldCBwcml2YXRlUGFydDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG5idG5HZW5lcmF0ZVB1YmxpY1BhcnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgY29uc3QgcmFuZG9tU3RyaW5nOiBzdHJpbmcgPSBjcnlwdG8uZ2VuZXJhdGVSYW5kb21TdHJpbmcoKTtcbiAgICB0eHRQdWJsaWNQYXJ0LnZhbHVlID0gcmFuZG9tU3RyaW5nO1xuICAgIHJ1bigpO1xufSk7XG5cbmZ1bmN0aW9uIGdldFByaXZhdGVQYXJ0KCk6IHN0cmluZyB7XG4gICAgaWYgKHByaXZhdGVQYXJ0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHByaXZhdGVQYXJ0O1xuICAgIH1cbiAgICByZXR1cm4gdHh0UHJpdmF0ZVBhcnQudmFsdWU7XG59XG5cbmZ1bmN0aW9uIHByb3RlY3RQcml2YXRlUGFydCgpOiB2b2lkIHtcbiAgICBpZiAodHh0UHJpdmF0ZVBhcnQudmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBwcml2YXRlUGFydCA9IHR4dFByaXZhdGVQYXJ0LnZhbHVlO1xuICAgIHNwblByb3RlY3RlZENvbmZpcm1hdGlvbi5pbm5lckhUTUwgPSBgUHJvdGVjdGVkLCAke3ByaXZhdGVQYXJ0Lmxlbmd0aH0gY2hhcmFjdGVyc2A7XG5cbiAgICB0eHRQcml2YXRlUGFydC52YWx1ZSA9ICcnO1xuICAgIHR4dFByaXZhdGVQYXJ0Q29uZmlybWF0aW9uLnZhbHVlID0gJyc7XG4gICAgc3BuUHJpdmF0ZVBhcnRTaXplLmlubmVySFRNTCA9ICcwJztcbiAgICBzcG5Qcml2YXRlUGFydFNpemVDb25maXJtYXRpb24uaW5uZXJIVE1MID0gJzAnO1xuXG4gICAgdXBkYXRlUHJpdmF0ZVBhcnRzTWF0Y2hpbmcoKTtcbn1cblxuYnRuUHJvdGVjdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBwcm90ZWN0UHJpdmF0ZVBhcnQoKTtcbn0pO1xuXG5mdW5jdGlvbiBjbGVhclByaXZhdGVQYXJ0UHJvdGVjdGlvbigpIHtcbiAgICBwcml2YXRlUGFydCA9IHVuZGVmaW5lZDtcbiAgICBzcG5Qcm90ZWN0ZWRDb25maXJtYXRpb24uaW5uZXJIVE1MID0gJyc7XG59XG5cbmJ0bkNsZWFyUHJvdGVjdGVkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGNsZWFyUHJpdmF0ZVBhcnRQcm90ZWN0aW9uKCk7XG4gICAgcnVuKCk7XG59KTtcblxuZnVuY3Rpb24gdXBkYXRlQ3VzdG9tS2V5c0Rpc3BsYXkoaXNWYWxpZDogYm9vbGVhbik6IHZvaWQge1xuICAgIGlmIChpc1ZhbGlkKSB7XG4gICAgICAgIHR4dEN1c3RvbUtleXMuc3R5bGUucmVtb3ZlUHJvcGVydHkoJ2JhY2tncm91bmQnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHR4dEN1c3RvbUtleXMuc3R5bGUuc2V0UHJvcGVydHkoJ2JhY2tncm91bmQnLCBFUlJPUl9DT0xPUik7XG59XG5cbmZ1bmN0aW9uIHBhcnNlQ3VzdG9tS2V5cygpOiBQbGFpbk9iamVjdCB8IG51bGwge1xuICAgIGlmICh0eHRDdXN0b21LZXlzLnZhbHVlID09PSAnJykge1xuICAgICAgICByZXR1cm4ge307XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgb2JqOiBhbnkgPSBKU09OLnBhcnNlKHR4dEN1c3RvbUtleXMudmFsdWUpO1xuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IG9iai5jb25zdHJ1Y3Rvci5uYW1lICE9PSAnT2JqZWN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iaiBhcyBQbGFpbk9iamVjdDtcbiAgICB9IGNhdGNoIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBzaGFsbG93TWVyZ2Uoc291cmNlOiBQbGFpbk9iamVjdCB8IG51bGwsIHRhcmdldDogUGxhaW5PYmplY3QgfCBudWxsKTogUGxhaW5PYmplY3Qge1xuICAgIGNvbnN0IHJlc3VsdDogUGxhaW5PYmplY3QgPSB7fTtcblxuICAgIGlmIChzb3VyY2UgIT09IG51bGwpIHtcbiAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoc291cmNlKSkge1xuICAgICAgICAgICAgaWYgKFJFU0VSVkVEX0tFWVMuaW5jbHVkZXMoa2V5KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRhcmdldCAhPT0gbnVsbCkge1xuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh0YXJnZXQpKSB7XG4gICAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gZGVlcE1lcmdlKHNvdXJjZTogUGxhaW5PYmplY3QsIHRhcmdldDogUGxhaW5PYmplY3QpOiB2b2lkIHtcbiAgICBmb3IgKGNvbnN0IHNvdXJjZUtleSBvZiBPYmplY3Qua2V5cyhzb3VyY2UpKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldFZhbHVlOiBhbnkgPSB0YXJnZXRbc291cmNlS2V5XTtcbiAgICAgICAgY29uc3Qgc291cmNlVmFsdWU6IGFueSA9IHNvdXJjZVtzb3VyY2VLZXldO1xuXG4gICAgICAgIGlmICh0YXJnZXRWYWx1ZSA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICB0YXJnZXRWYWx1ZSA9PT0gbnVsbCB8fFxuICAgICAgICAgICAgdGFyZ2V0VmFsdWUuY29uc3RydWN0b3IubmFtZSAhPT0gJ09iamVjdCcgfHxcbiAgICAgICAgICAgIHNvdXJjZVZhbHVlLmNvbnN0cnVjdG9yLm5hbWUgIT09ICdPYmplY3QnKSB7XG4gICAgICAgICAgICB0YXJnZXRbc291cmNlS2V5XSA9IHNvdXJjZVZhbHVlO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBkZWVwTWVyZ2Uoc291cmNlVmFsdWUsIHRhcmdldFZhbHVlKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHNldHVwVmlld0J1dHRvbih0eHQ6IEhUTUxJbnB1dEVsZW1lbnQsIGJ1dHRvbk5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IGJ0bjogSFRNTElucHV0RWxlbWVudCA9IGdldEVsZW1lbnRCeUlkKGJ1dHRvbk5hbWUpO1xuICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgaWYgKHR4dC50eXBlID09PSAncGFzc3dvcmQnKSB7XG4gICAgICAgICAgICB0eHQudHlwZSA9ICdpbnB1dCc7XG4gICAgICAgICAgICBidG4uaW5uZXJIVE1MID0gJ0hpZGUnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHh0LnR5cGUgPSAncGFzc3dvcmQnO1xuICAgICAgICAgICAgYnRuLmlubmVySFRNTCA9ICdWaWV3JztcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5jb25zdCBjb3B5UmVzdWx0UGFzc3dvcmRUb0NsaXBib2FyZEZlZWRiYWNrT2JqZWN0OiBWaXN1YWxGZWVkYmFjayA9IG5ldyBWaXN1YWxGZWVkYmFjayhzcG5Db3B5UmVzdWx0UGFzc3dvcmRGZWVkYmFjayk7XG5jb25zdCBjb3B5UHVibGljUGFydFRvQ2xpcGJvYXJkRmVlZGJhY2tPYmplY3Q6IFZpc3VhbEZlZWRiYWNrID0gbmV3IFZpc3VhbEZlZWRiYWNrKHNwbkNvcHlQdWJsaWNQYXJ0RmVlZGJhY2spO1xuXG5hc3luYyBmdW5jdGlvbiB3cml0ZVRvQ2xpcGJvYXJkKHRleHQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHRleHQpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yLnN0YWNrIHx8IGVycm9yKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gc2V0dXBDb3B5QnV0dG9uKHR4dDogSFRNTElucHV0RWxlbWVudCwgYnV0dG9uOiBIVE1MSW5wdXRFbGVtZW50LCBmZWVkYmFjazogVmlzdWFsRmVlZGJhY2spOiB2b2lkIHtcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGlmIChhd2FpdCB3cml0ZVRvQ2xpcGJvYXJkKHR4dC52YWx1ZSkpIHtcbiAgICAgICAgICAgIGZlZWRiYWNrLnNldFRleHQoJ0NvcGllZCcsIDMwMDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZmVlZGJhY2suc2V0VGV4dCgnPHNwYW4gc3R5bGU9XCJjb2xvcjogcmVkXCI+RmFpbGVkIHRvIGNvcHk8L3NwYW4+JywgMzAwMCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlUmVzdWx0UGFzc3dvcmRMZW5ndGgoKSB7XG4gICAgc3BuUmVzdWx0UGFzc3dvcmRMZW5ndGguaW5uZXJIVE1MID0gdHh0UmVzdWx0UGFzc3dvcmQudmFsdWUubGVuZ3RoLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJyAnKTtcbn1cblxuc2V0dXBWaWV3QnV0dG9uKHR4dFJlc3VsdFBhc3N3b3JkLCAnYnRuVmlld1Jlc3VsdFBhc3N3b3JkJyk7XG5cbnNldHVwQ29weUJ1dHRvbih0eHRQdWJsaWNQYXJ0LCBidG5Db3B5UHVibGljUGFydCwgY29weVB1YmxpY1BhcnRUb0NsaXBib2FyZEZlZWRiYWNrT2JqZWN0KTtcbnNldHVwQ29weUJ1dHRvbih0eHRSZXN1bHRQYXNzd29yZCwgYnRuQ29weVJlc3VsdFBhc3N3b3JkLCBjb3B5UmVzdWx0UGFzc3dvcmRUb0NsaXBib2FyZEZlZWRiYWNrT2JqZWN0KTtcblxuZnVuY3Rpb24gaXNBbHBoYWJldFZhbGlkKGFscGhhYmV0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCBzb3J0ZWRBbHBoYWJldDogc3RyaW5nW10gPSBhbHBoYWJldC5zcGxpdCgnJyk7XG4gICAgc29ydGVkQWxwaGFiZXQuc29ydCgpO1xuXG4gICAgZm9yIChsZXQgaTogbnVtYmVyID0gMTsgaSA8IHNvcnRlZEFscGhhYmV0Lmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChzb3J0ZWRBbHBoYWJldFtpIC0gMV0gPT09IHNvcnRlZEFscGhhYmV0W2ldKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxudHlwZSBJQ2hhaW5JbmZvID0ge1xuICAgIGhlYWQ6IFBsYWluT2JqZWN0LFxuICAgIHRhaWxQYXJlbnQ6IFBsYWluT2JqZWN0LFxuICAgIHRhaWw6IFBsYWluT2JqZWN0XG59O1xuXG4vLyBUcmFuc2Zvcm1zIGEgcGF0aCBsaWtlIFwiYS9iL2MvZFwiIGludG8gYSBoaWVyYXJjaHkgb2Ygb2JqZWN0cyBsaWtlIHsgXCJhXCI6IHsgXCJiXCI6IHsgXCJjXCI6IHsgXCJkXCI6IHt9IH0gfSB9IH1cbi8vIEZyb20gdGhlIHJlc3VsdCBvYmplY3QsIGhlYWQgaXMgdGhlIHJvb3Qgb2JqZWN0IHRoYXQgY29udGFpbnMgXCJhXCIsIHRhaWwgaXMgdGhlIHZhbHVlIG9mIFwiZFwiLCBhbmQgdGFpbFBhcmVudCBpcyB0aGUgdmFsdWUgb2YgXCJjXCJcbmZ1bmN0aW9uIHBhdGhUb09iamVjdENoYWluKHBhdGg6IHN0cmluZywgY2hhaW5JbmZvOiBJQ2hhaW5JbmZvIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkKTogSUNoYWluSW5mbyB7XG4gICAgY29uc3Qgc2VwYXJhdG9ySW5kZXg6IG51bWJlciA9IHBhdGguaW5kZXhPZignLycpO1xuXG4gICAgY29uc3QgdGFpbDogUGxhaW5PYmplY3QgPSB7fTtcblxuICAgIGNvbnN0IGZpcnN0UGF0aDogc3RyaW5nID0gc2VwYXJhdG9ySW5kZXggPj0gMCA/IHBhdGguc3Vic3RyKDAsIHNlcGFyYXRvckluZGV4KSA6IHBhdGg7XG4gICAgY29uc3QgcmVtYWluaW5nUGF0aDogc3RyaW5nIHwgdW5kZWZpbmVkID0gc2VwYXJhdG9ySW5kZXggPj0gMCA/IHBhdGguc3Vic3RyKHNlcGFyYXRvckluZGV4ICsgMSkgOiB1bmRlZmluZWQ7XG5cbiAgICBpZiAoY2hhaW5JbmZvID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29uc3Qgbm9kZTogUGxhaW5PYmplY3QgPSB7fTtcbiAgICAgICAgbm9kZVtmaXJzdFBhdGhdID0gdGFpbDtcbiAgICAgICAgY2hhaW5JbmZvID0ge1xuICAgICAgICAgICAgaGVhZDogbm9kZSxcbiAgICAgICAgICAgIHRhaWxQYXJlbnQ6IG5vZGUsXG4gICAgICAgICAgICB0YWlsXG4gICAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY2hhaW5JbmZvLnRhaWxbZmlyc3RQYXRoXSA9IHRhaWw7XG4gICAgICAgIGNoYWluSW5mby50YWlsUGFyZW50ID0gY2hhaW5JbmZvLnRhaWw7XG4gICAgICAgIGNoYWluSW5mby50YWlsID0gdGFpbDtcbiAgICB9XG5cbiAgICBpZiAocmVtYWluaW5nUGF0aCkge1xuICAgICAgICByZXR1cm4gcGF0aFRvT2JqZWN0Q2hhaW4ocmVtYWluaW5nUGF0aCwgY2hhaW5JbmZvKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY2hhaW5JbmZvO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVQYXNzd29yZEdlbmVyYXRpb25QYXJhbWV0ZXJzKCk6IHZvaWQge1xuICAgIGlmIChjYW5SdW4oKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgdHh0UGFyYW1ldGVycy52YWx1ZSA9ICcnO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgY2hhaW5JbmZvOiBJQ2hhaW5JbmZvID0gcGF0aFRvT2JqZWN0Q2hhaW4odHh0UGF0aC52YWx1ZSk7XG4gICAgY29uc3QgbGVhZjogUGxhaW5PYmplY3QgPSBjaGFpbkluZm8udGFpbDtcblxuICAgIGxlYWYucHVibGljID0gdHh0UHVibGljUGFydC52YWx1ZTtcblxuICAgIGNvbnN0IG51bWVyaWNWYWx1ZTogbnVtYmVyID0gcGFyc2VJbnQobnVtT3V0cHV0U2l6ZU51bS52YWx1ZSwgMTApO1xuICAgIGlmIChudW1lcmljVmFsdWUgIT09IERFRkFVTFRfTEVOR1RIKSB7XG4gICAgICAgIGxlYWYubGVuZ3RoID0gbnVtZXJpY1ZhbHVlO1xuICAgIH1cblxuICAgIGNvbnN0IGFscGhhYmV0OiBzdHJpbmcgPSB0eHRBbHBoYWJldC52YWx1ZTtcbiAgICBpZiAoYWxwaGFiZXQgIT09IERFRkFVTFRfQUxQSEFCRVQpIHtcbiAgICAgICAgbGVhZi5hbHBoYWJldCA9IGFscGhhYmV0O1xuICAgIH1cblxuICAgIGNvbnN0IGN1c3RvbUtleXM6IFBsYWluT2JqZWN0IHwgbnVsbCA9IHBhcnNlQ3VzdG9tS2V5cygpO1xuICAgIHVwZGF0ZUN1c3RvbUtleXNEaXNwbGF5KGN1c3RvbUtleXMgIT09IG51bGwpO1xuICAgIGNvbnN0IHJlc3VsdFBhcmFtZXRlcnM6IFBsYWluT2JqZWN0ID0gc2hhbGxvd01lcmdlKGN1c3RvbUtleXMsIGxlYWYpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKHJlc3VsdFBhcmFtZXRlcnMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAvLyBTZXQgdGhlIHZhbHVlIG9mIHRoZSBmaXJzdCAoc2luZ2xlKSBwcm9wZXJ0eSBvZiB0aGUgb2JqZWN0IHRvIG51bGwuXG4gICAgICAgIGNoYWluSW5mby50YWlsUGFyZW50W09iamVjdC5rZXlzKGNoYWluSW5mby50YWlsUGFyZW50KVswXV0gPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNoYWluSW5mby50YWlsUGFyZW50W09iamVjdC5rZXlzKGNoYWluSW5mby50YWlsUGFyZW50KVswXV0gPSByZXN1bHRQYXJhbWV0ZXJzO1xuICAgIH1cblxuICAgIHR4dFBhcmFtZXRlcnMudmFsdWUgPSBKU09OLnN0cmluZ2lmeShjaGFpbkluZm8uaGVhZCwgdW5kZWZpbmVkLCA0KTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlT3V0cHV0U2l6ZVJhbmdlVG9OdW0oKTogdm9pZCB7XG4gICAgbnVtT3V0cHV0U2l6ZU51bS52YWx1ZSA9IG51bU91dHB1dFNpemVSYW5nZS52YWx1ZTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlT3V0cHV0U2l6ZU51bVRvUmFuZ2UoKTogdm9pZCB7XG4gICAgY29uc3QgbWluOiBudW1iZXIgPSBwYXJzZUludChudW1PdXRwdXRTaXplUmFuZ2UubWluLCAxMCk7XG4gICAgY29uc3QgdmFsOiBudW1iZXIgPSBwYXJzZUludChudW1PdXRwdXRTaXplTnVtLnZhbHVlLCAxMCk7XG4gICAgY29uc3QgbWF4OiBudW1iZXIgPSBwYXJzZUludChudW1PdXRwdXRTaXplUmFuZ2UubWF4LCAxMCk7XG4gICAgbnVtT3V0cHV0U2l6ZVJhbmdlLnZhbHVlID0gTWF0aC5tYXgobWluLCBNYXRoLm1pbih2YWwsIG1heCkpLnRvU3RyaW5nKCk7XG59XG5cbm51bU91dHB1dFNpemVSYW5nZS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICB1cGRhdGVPdXRwdXRTaXplUmFuZ2VUb051bSgpO1xuICAgIHJ1bigpO1xufSk7XG5cbm51bU91dHB1dFNpemVOdW0uYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgdXBkYXRlT3V0cHV0U2l6ZU51bVRvUmFuZ2UoKTtcbiAgICB1cGRhdGVPdXRwdXRTaXplUmFuZ2VUb051bSgpO1xuICAgIHJ1bigpO1xufSk7XG5cbmZ1bmN0aW9uIHVwZGF0ZUFscGhhYmV0U2l6ZSgpOiB2b2lkIHtcbiAgICBzcG5BbHBoYWJldFNpemUuaW5uZXJIVE1MID0gdHh0QWxwaGFiZXQudmFsdWUubGVuZ3RoLnRvU3RyaW5nKCk7XG5cbiAgICBjb25zdCBhbHBoYWJldFNpemVEaWdpdENvdW50OiBudW1iZXIgPSB0eHRBbHBoYWJldC52YWx1ZS5sZW5ndGgudG9TdHJpbmcoKS5sZW5ndGg7XG4gICAgaWYgKGFscGhhYmV0U2l6ZURpZ2l0Q291bnQgPCAyKSB7XG4gICAgICAgIC8vIEFkZCBhIHNwYWNlIHRvIGtlZXAgYSBuaWNlIHZpc3VhbCBhbGlnbm1lbnQuXG4gICAgICAgIHNwbkFscGhhYmV0U2l6ZS5pbm5lckhUTUwgPSBzcG5BbHBoYWJldFNpemUuaW5uZXJIVE1MLnBhZFN0YXJ0KDIsICcgJyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB1cGRhdGVBbHBoYWJldFZhbGlkaXR5RGlzcGxheShpc0FscGhhYmV0VmFsaWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICBpZiAoaXNBbHBoYWJldFZhbGlkKSB7XG4gICAgICAgIHR4dEFscGhhYmV0LnN0eWxlLnJlbW92ZVByb3BlcnR5KCdiYWNrZ3JvdW5kJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdHh0QWxwaGFiZXQuc3R5bGUuc2V0UHJvcGVydHkoJ2JhY2tncm91bmQnLCBFUlJPUl9DT0xPUik7XG4gICAgfVxufVxuXG50eHRBbHBoYWJldC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICBjb25zdCBpc0FscGhhYmV0VmFsaWRSZXN1bHQ6IGJvb2xlYW4gPSBpc0FscGhhYmV0VmFsaWQodHh0QWxwaGFiZXQudmFsdWUpO1xuXG4gICAgdXBkYXRlQWxwaGFiZXRWYWxpZGl0eURpc3BsYXkoaXNBbHBoYWJldFZhbGlkUmVzdWx0KTtcblxuICAgIGlmIChpc0FscGhhYmV0VmFsaWRSZXN1bHQgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB1cGRhdGVBbHBoYWJldFNpemUoKTtcbiAgICBydW4oKTtcbn0pO1xuXG5idG5SZXNldEFscGhhYmV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIHJlc2V0QWxwaGFiZXQoKTtcbiAgICB1cGRhdGVBbHBoYWJldFNpemUoKTtcbiAgICBydW4oKTtcbn0pO1xuXG5mdW5jdGlvbiBjbGVhck91dHB1dHMoKTogdm9pZCB7XG4gICAgdHh0UmVzdWx0UGFzc3dvcmQudmFsdWUgPSAnJztcblxuICAgIHVwZGF0ZVJlc3VsdFBhc3N3b3JkTGVuZ3RoKCk7XG59XG5cbmZ1bmN0aW9uIGNhblJ1bigpOiBib29sZWFuIHtcbiAgICBjb25zdCBhbHBoYWJldDogc3RyaW5nID0gdHh0QWxwaGFiZXQudmFsdWU7XG5cbiAgICBpZiAoaXNBbHBoYWJldFZhbGlkKGFscGhhYmV0KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChnZXRQcml2YXRlUGFydCgpLmxlbmd0aCA8PSAwIHx8IHR4dFB1YmxpY1BhcnQudmFsdWUubGVuZ3RoIDwgOCB8fCBhbHBoYWJldC5sZW5ndGggPCAyKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcnVuKCkge1xuICAgIHVwZGF0ZVBhc3N3b3JkR2VuZXJhdGlvblBhcmFtZXRlcnMoKTtcblxuICAgIGlmIChjYW5SdW4oKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgY2xlYXJPdXRwdXRzKCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBrZXlCeXRlczogQXJyYXlCdWZmZXIgPSBhd2FpdCBjcnlwdG8uZ2VuZXJhdGVQYXNzd29yZChnZXRQcml2YXRlUGFydCgpLCB0eHRQdWJsaWNQYXJ0LnZhbHVlLCAnUGFzc3dvcmQnKTtcblxuICAgIGNvbnN0IGtleVN0cmluZzogc3RyaW5nID0gYXJyYXlVdGlscy50b0N1c3RvbUJhc2Uoa2V5Qnl0ZXMsIHR4dEFscGhhYmV0LnZhbHVlKTtcbiAgICB0eHRSZXN1bHRQYXNzd29yZC52YWx1ZSA9IHN0cmluZ1V0aWxzLnRydW5jYXRlKGtleVN0cmluZywgcGFyc2VJbnQobnVtT3V0cHV0U2l6ZVJhbmdlLnZhbHVlLCAxMCkpO1xuXG4gICAgdXBkYXRlUmVzdWx0UGFzc3dvcmRMZW5ndGgoKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcmVzZXRBbHBoYWJldCgpIHtcbiAgICB0eHRBbHBoYWJldC52YWx1ZSA9IERFRkFVTFRfQUxQSEFCRVQ7XG4gICAgdXBkYXRlQWxwaGFiZXRTaXplKCk7XG5cbiAgICBjb25zdCBpc0FscGhhYmV0VmFsaWRSZXN1bHQ6IGJvb2xlYW4gPSBpc0FscGhhYmV0VmFsaWQodHh0QWxwaGFiZXQudmFsdWUpO1xuXG4gICAgdXBkYXRlQWxwaGFiZXRWYWxpZGl0eURpc3BsYXkoaXNBbHBoYWJldFZhbGlkUmVzdWx0KTtcblxuICAgIGlmIChpc0FscGhhYmV0VmFsaWRSZXN1bHQpIHtcbiAgICAgICAgYXdhaXQgcnVuKCk7XG4gICAgfVxufVxuXG5jb25zdCBwcm90ZWN0UHJpdmF0ZVBhcnRBY3Rpb246IFRpbWVkQWN0aW9uID0gbmV3IFRpbWVkQWN0aW9uKHByb3RlY3RQcml2YXRlUGFydCwgUFJJVkFURV9QQVJUX1BST1RFQ1RJT05fVElNRU9VVCk7XG5cbnR4dFByaXZhdGVQYXJ0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgIGNsZWFyUHJpdmF0ZVBhcnRQcm90ZWN0aW9uKCk7XG4gICAgc3BuUHJpdmF0ZVBhcnRTaXplLmlubmVySFRNTCA9IHR4dFByaXZhdGVQYXJ0LnZhbHVlLmxlbmd0aC50b1N0cmluZygpO1xuICAgIHVwZGF0ZVByaXZhdGVQYXJ0c01hdGNoaW5nKCk7XG4gICAgcnVuKCk7XG4gICAgcHJvdGVjdFByaXZhdGVQYXJ0QWN0aW9uLnJlc2V0KCk7XG59KTtcblxuZnVuY3Rpb24gdXBkYXRlUHJpdmF0ZVBhcnRzTWF0Y2hpbmcoKTogdm9pZCB7XG4gICAgaWYgKHR4dFByaXZhdGVQYXJ0Q29uZmlybWF0aW9uLnZhbHVlID09PSB0eHRQcml2YXRlUGFydC52YWx1ZSkge1xuICAgICAgICB0eHRQcml2YXRlUGFydENvbmZpcm1hdGlvbi5zdHlsZS5zZXRQcm9wZXJ0eSgnYmFja2dyb3VuZCcsIFNVQ0NFU1NfQ09MT1IpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHR4dFByaXZhdGVQYXJ0Q29uZmlybWF0aW9uLnN0eWxlLnNldFByb3BlcnR5KCdiYWNrZ3JvdW5kJywgRVJST1JfQ09MT1IpO1xuICAgIH1cbn07XG5cbnR4dFByaXZhdGVQYXJ0Q29uZmlybWF0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgIHNwblByaXZhdGVQYXJ0U2l6ZUNvbmZpcm1hdGlvbi5pbm5lckhUTUwgPSB0eHRQcml2YXRlUGFydENvbmZpcm1hdGlvbi52YWx1ZS5sZW5ndGgudG9TdHJpbmcoKTtcbiAgICB1cGRhdGVQcml2YXRlUGFydHNNYXRjaGluZygpO1xufSk7XG5cbnR4dFBhdGguYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgdXBkYXRlUGFzc3dvcmRHZW5lcmF0aW9uUGFyYW1ldGVycygpO1xufSk7XG5cbnR4dFB1YmxpY1BhcnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgdXBkYXRlUGFzc3dvcmRHZW5lcmF0aW9uUGFyYW1ldGVycygpO1xuICAgIHJ1bigpO1xufSk7XG5cbnR4dEN1c3RvbUtleXMuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgdXBkYXRlUGFzc3dvcmRHZW5lcmF0aW9uUGFyYW1ldGVycygpO1xufSk7XG5cbnVwZGF0ZU91dHB1dFNpemVSYW5nZVRvTnVtKCk7XG5yZXNldEFscGhhYmV0KCk7XG51cGRhdGVQcml2YXRlUGFydHNNYXRjaGluZygpO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGltZWRBY3Rpb24ge1xuICAgIHByaXZhdGUgdGltZW91dDogbnVtYmVyIHwgdW5kZWZpbmVkO1xuICAgIHB1YmxpYyBjb25zdHJ1Y3Rvcihwcml2YXRlIGFjdGlvbjogRnVuY3Rpb24sIHByaXZhdGUgZGVsYXk6IG51bWJlcikge1xuICAgIH1cblxuICAgIHB1YmxpYyByZXNldChvdmVycmlkZURlbGF5OiBudW1iZXIgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMudGltZW91dCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRlbGF5ID0gb3ZlcnJpZGVEZWxheSAhPT0gdW5kZWZpbmVkID8gb3ZlcnJpZGVEZWxheSA6IHRoaXMuZGVsYXk7XG5cbiAgICAgICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFjdGlvbigpO1xuICAgICAgICAgICAgdGhpcy50aW1lb3V0ID0gdW5kZWZpbmVkO1xuICAgICAgICB9LCBkZWxheSk7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==
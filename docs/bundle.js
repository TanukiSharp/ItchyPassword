!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);class r{constructor(t){this.element=t}setText(t,e){this.element.innerHTML=t,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.element.innerHTML="",e)}}function a(t){const e=document.getElementById(t);if(null===t)throw new Error(`DOM element '${t}' not found.`);return e}function i(t,e,n){const a=new r(n);e.addEventListener("click",async()=>{await async function(t){try{return await navigator.clipboard.writeText(t),!0}catch(t){return console.error(t.stack||t),!1}}(t.value)?a.setText("Copied",3e3):a.setText('<span style="color: red">Failed to copy</span>',3e3)})}const o="#D0FFD0",s="#FFD0D0";const u="Stores the string in memory and removes it from the UI component. Prevents a physical intruder from copy/pasting the value.",c="Removes the string form memory and re-enables the UI component.",l=a("txtPrivatePart"),d=a("txtPrivatePartConfirmation"),p=a("btnProtect"),y=a("spnProtectedConfirmation"),v=a("spnPrivatePartSize"),b=a("spnPrivatePartSizeConfirmation");let f,h=[];function g(){return void 0!==f?f:l.value}function m(){0!==l.value.length&&(f=l.value,y.innerHTML="Protected",l.value="",d.value="",v.innerHTML="0",b.innerHTML="0",l.disabled=!0,d.disabled=!0,p.innerHTML="Clear and unlock",p.title=c,T())}function w(){void 0===f?m():(f=void 0,y.innerHTML="",l.disabled=!1,d.disabled=!1,p.innerHTML="Protect and lock",p.title=u,p.disabled=!0)}p.addEventListener("click",()=>{w()});const P=new class{constructor(t,e){this.action=t,this.delay=e}reset(t){void 0!==this.timeout&&clearTimeout(this.timeout);const e=void 0!==t?t:this.delay;this.timeout=setTimeout(()=>{this.action(),this.timeout=void 0},e)}}(m,6e4);function T(){d.value===l.value?d.style.setProperty("background",o):d.style.setProperty("background",s)}function L(t,e){const n=BigInt(e.length);let r="",a=function(t){const e=t.byteLength,n=new DataView(t,0);let r=0n;for(let t=0;t<e;t+=1)r+=BigInt(n.getUint8(t))*256n**BigInt(t);return r}(t);for(;a>0n;){const t=a%n;a/=n,r+=e[BigInt.asUintN(64,t)]}return r}l.addEventListener("input",()=>{let t;for(t of(p.disabled=0===l.value.length,v.innerHTML=l.value.length.toString(),T(),h))t();P.reset()}),d.addEventListener("input",()=>{b.innerHTML=d.value.length.toString(),T()}),T(),p.title=u;const S="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";async function C(t,e){const n=await crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveKey"]),r={name:"PBKDF2",hash:"SHA-512",iterations:1e5,salt:e},a=await crypto.subtle.deriveKey(r,n,{name:"AES-CBC",length:256},!0,["encrypt"]);return await crypto.subtle.exportKey("raw",a)}function k(t=64,e=S){return L(function(t=64){const e=new Uint8Array(t);return crypto.getRandomValues(e).buffer}(t),e)}function M(t){return(new TextEncoder).encode(t).buffer}var x;x=ot,h.push(x);const E=new class{constructor(t){this.hkdfPurpose=M(t),this._description=`HKDF(PBKDF2, HMAC512) [purpose: ${t}]`}get version(){return 1}get description(){return this._description}async generatePassword(t,e){const n=await C(t,e),r=await crypto.subtle.importKey("raw",n,{name:"HMAC",hash:{name:"SHA-512"}},!1,["sign"]);return await crypto.subtle.sign("HMAC",r,this.hkdfPurpose)}}("Password"),A=a("txtPath"),H=a("txtPublicPart"),I=a("btnGeneratePublicPart"),O=a("btnClearPublicPart"),D=a("btnCopyPublicPart"),j=a("spnCopyPublicPartFeedback"),F=a("numOutputSizeRange"),K=a("numOutputSizeNum"),B=a("txtAlphabet"),U=a("spnAlphabetSize"),_=a("btnResetAlphabet"),R=a("txtResultPassword"),V=a("spnResultPasswordLength"),G=a("btnCopyResultPassword"),N=a("spnCopyResultPasswordFeedback"),z=a("txtParameters"),$=a("txtCustomKeys"),J=64,q="!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~",Q=["alphabet","length","public","datetime"];let W;function X(){W=H.value.length>0?(new Date).toISOString():void 0}function Y(){V.innerHTML=R.value.length.toString().padStart(2," ")}function Z(t){const e=t.split("");e.sort();for(let t=1;t<e.length;t+=1)if(e[t-1]===e[t])return!1;return!0}function tt(){if(!1===it())return void at();const t=function t(e,n){const r=e.indexOf("/"),a={},i=r>=0?e.substr(0,r):e,o=r>=0?e.substr(r+1):void 0;if(void 0===n){const t={};t[i]=a,n={head:t,tailParent:t,tail:a}}else n.tail[i]=a,n.tailParent=n.tail,n.tail=a;return o?t(o,n):n}(A.value),e=t.tail;e.public=H.value,e.datetime=W;const n=parseInt(K.value,10);n!==J&&(e.length=n);const r=B.value;r!==q&&(e.alphabet=r);const a=function(){if(""===$.value)return{};try{const t=JSON.parse($.value);return null===t||"Object"!==t.constructor.name?null:t}catch{return null}}();null!==a?$.style.removeProperty("background"):$.style.setProperty("background",s);const i=function(t,e){const n={};if(null!==t)for(const[e,r]of Object.entries(t))!1===Q.includes(e)&&(n[e]=r);if(null!==e)for(const[t,r]of Object.entries(e))n[t]=r;return n}(a,e);0===Object.keys(i).length?t.tailParent[Object.keys(t.tailParent)[0]]=null:t.tailParent[Object.keys(t.tailParent)[0]]=i,z.value=JSON.stringify(t.head,void 0,4)}function et(){K.value=F.value}function nt(){U.innerHTML=B.value.length.toString(),B.value.length.toString().length<2&&(U.innerHTML=U.innerHTML.padStart(2," "))}function rt(t){t?B.style.removeProperty("background"):B.style.setProperty("background",s)}function at(){R.value="",z.value="",Y()}function it(){const t=B.value;return!1!==Z(t)&&!(g().length<=0||H.value.length<8||t.length<2)}async function ot(){if(tt(),!1===it())return void at();const t=g(),e=H.value,n=M(t),r=M(e),a=L(await E.generatePassword(n,r),B.value);var i,o;R.value=(i=a,o=parseInt(F.value,10),i.length<=o?i:i.substr(0,o)),Y()}async function st(){B.value=q,nt();const t=Z(B.value);rt(t),t&&await ot()}F.max=J.toString(),F.value=J.toString(),O.addEventListener("click",()=>{H.value.length>0&&"y"!==prompt("Are you sure you want to clear the public part ?\nType 'y' to accept","")||(H.value="",X(),tt())}),I.addEventListener("click",()=>{if(H.value.length>0&&"y"!==prompt("Are you sure you want to generate a new public part ?\nType 'y' to accept",""))return;const t=k();H.value=t,X(),ot()}),function(t,e){const n=a(e);n.addEventListener("click",()=>{"password"===t.type?(t.type="input",n.innerHTML="Hide"):(t.type="password",n.innerHTML="View")})}(R,"btnViewResultPassword"),i(H,D,j),i(R,G,N),F.addEventListener("input",()=>{et(),ot()}),K.addEventListener("input",()=>{!function(){const t=parseInt(F.min,10),e=parseInt(K.value,10),n=parseInt(F.max,10);F.value=Math.max(t,Math.min(e,n)).toString()}(),et(),ot()}),B.addEventListener("input",()=>{const t=Z(B.value);rt(t),!1!==t&&(nt(),ot())}),_.addEventListener("click",()=>{st(),nt(),ot()}),A.addEventListener("input",()=>{tt()}),H.addEventListener("input",()=>{X(),tt(),ot()}),$.addEventListener("input",()=>{tt()}),et(),st();const ut=new Uint8Array([242,207,239,142,19,64,70,73,146,42,222,92,188,136,56,168]).buffer;const ct=new class{get version(){return 1}get description(){return"PBKDF2 + AES-GCM"}async encrypt(t,e){const n=new ArrayBuffer(28+t.byteLength),r=new DataView(n,0,12);crypto.getRandomValues(new Uint8Array(n,0,12));const a={name:"AES-GCM",iv:r},i=await crypto.subtle.importKey("raw",await C(e,ut),{name:"AES-GCM",length:256},!1,["encrypt"]),o=await crypto.subtle.encrypt(a,i,t);return new Uint8Array(n).set(new Uint8Array(o),12),n}async decrypt(t,e){const n=new DataView(t,0,12),r=new DataView(t,12),a={name:"AES-GCM",iv:n},i=await C(e,ut),o=await crypto.subtle.importKey("raw",i,{name:"AES-GCM",length:256},!1,["decrypt"]);return await crypto.subtle.decrypt(a,o,r)}},lt=a("txtCipherSource"),dt=a("txtCipherTarget"),pt=a("btnEncrypt"),yt=a("btnDecrypt"),vt=a("btnClearCipherSource"),bt=a("spnCopyCipherTargetFeedback"),ft=a("btnCopyCipherTarget"),ht=a("btnClearCipherTarget");function gt(){lt.style.removeProperty("background-color")}function mt(){lt.style.setProperty("background-color",s)}function wt(){gt(),dt.style.removeProperty("background-color")}i(dt,ft,bt),pt.addEventListener("click",async()=>{if(lt.focus(),dt.value="",wt(),0===lt.value.length)return void mt();const t=g();if(0===t.length)return void console.warn("Private part is empty");const e=M(lt.value),n=M(t),r=await ct.encrypt(e,n);dt.value=function(t){return Array.prototype.map.call(new Uint8Array(t),t=>("00"+t.toString(16)).slice(-2)).join("")}(r)}),yt.addEventListener("click",async()=>{if(lt.focus(),dt.value="",wt(),0===lt.value.length)return void mt();const t=g();if(0!==t.length)try{const e=function(t){t.length%2!=0&&(t="0"+t);const e=new Uint8Array(t.length/2);for(let n=0;n<e.byteLength;n+=1)e[n]=parseInt(t.substr(2*n,2),16);return e.buffer}(lt.value),n=M(t),r=await ct.decrypt(e,n);dt.value=function(t){return(new TextDecoder).decode(t)}(r)}catch(t){console.warn(`Failed to decrypt${t.message?`, error: ${t.message}`:", no error message"}`),dt.style.setProperty("background-color",s)}else console.warn("Private part is empty")}),lt.addEventListener("input",()=>{lt.value.length>0&&gt()}),vt.addEventListener("click",()=>{lt.value=""}),ht.addEventListener("click",()=>{dt.value=""});const Pt=a("btnTabNothing"),Tt=a("btnTabPasswords"),Lt=a("btnTabCiphers");new class{constructor(t){this.tabs=t,this._activeTabIndex=-1;for(let e=0;e<this.tabs.length;e+=1)t[e].button.addEventListener("click",()=>{this.setActiveTab(e)});this.setActiveTab(0)}get activeTabIndex(){return this._activeTabIndex}set activeTabIndex(t){if(t<0||t>=this.tabs.length)throw new Error(`Argument 'index' out of range. Must be in range [0;${this.tabs.length-1}].`);this.setActiveTab(t)}setActiveTab(t){let e;for(e of this.tabs)e.button.style.removeProperty("font-weight"),e.button.style.setProperty("color","#C0C0C0"),e.content.style.setProperty("display","none");this.tabs[t].button.style.setProperty("font-weight","bold"),this.tabs[t].button.style.removeProperty("color"),this.tabs[t].content.style.removeProperty("display"),this._activeTabIndex=t}}([{button:Pt,content:a("divTabNothing")},{button:Tt,content:a("divTabPasswords")},{button:Lt,content:a("divTabCiphers")}]);const St="69d71ab20379bbcb255d057993138e18ecf41b14".substr(0,11);a("divInfo").innerHTML=`${St}<br/><a href="https://github.com/TanukiSharp/ItchyPassword" target="_blank">github</a>`}]);
//# sourceMappingURL=bundle.js.map
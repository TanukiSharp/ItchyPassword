{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/VisualFeedback.ts","webpack:///./src/ui.ts","webpack:///./src/components/privatePartComponent.ts","webpack:///./src/TimedAction.ts","webpack:///./src/arrayUtils.ts","webpack:///./src/crypto.ts","webpack:///./src/stringUtils.ts","webpack:///./src/components/passwordComponent.ts","webpack:///./src/passwordGenerators/v1.ts","webpack:///./src/ciphers/v2.ts","webpack:///./src/components/cipherComponent.ts","webpack:///./src/ciphers/v1.ts","webpack:///./src/components/reEncryptComponent.ts","webpack:///./src/index.ts","webpack:///./src/TabControl.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","VisualFeedback","element","this","text","duration","innerHTML","timeout","clearTimeout","setTimeout","getElementById","elementName","document","Error","setupCopyButton","txt","button","feedback","visualFeedback","addEventListener","async","navigator","clipboard","writeText","error","console","stack","writeToClipboard","setText","SUCCESS_COLOR","ERROR_COLOR","btnProtectTitleForProtect","btnProtectTitleForClear","txtPrivatePart","txtPrivatePartConfirmation","btnProtect","spnProtectedConfirmation","spnPrivatePartSize","spnPrivatePartSizeConfirmation","onChangedHandlers","getPrivatePart","undefined","protectAndLockPrivatePart","length","disabled","title","updatePrivatePartsMatching","togglePrivatePartProtection","protectPrivatePartAction","action","delay","overrideDelay","style","setProperty","toCustomBase","bytes","alphabet","alphabetLength","BigInt","result","number","arrayBuffer","byteLength","arrayView","DataView","getUint8","arrayBufferToUnsignedBigInt","remainder","asUintN","toBase16","buffer","Array","map","Uint8Array","x","toString","slice","join","onChangedHandler","reset","BASE62_ALPHABET","getDerivedBytes","password","salt","baseKey","crypto","subtle","importKey","algorithm","hash","iterations","deriveKey","exportKey","generateRandomString","byteCount","array","getRandomValues","generateRandomBytes","stringToArray","str","TextEncoder","encode","fromBase16","parseInt","substr","onChanged","run","push","passwordGenerator","hkdfPurpose","_description","privatePart","publicPart","derivedKey","hkdfKey","sign","txtPath","txtPublicPart","btnGeneratePublicPart","btnClearPublicPart","btnCopyPublicPart","spnCopyPublicPartFeedback","numOutputSizeRange","numOutputSizeNum","txtAlphabet","spnAlphabetSize","btnResetAlphabet","txtResultPassword","spnResultPasswordLength","btnCopyResultPassword","spnCopyResultPasswordFeedback","txtParameters","txtCustomKeys","DEFAULT_LENGTH","DEFAULT_ALPHABET","RESERVED_KEYS","passwordPublicPartLastChange","updatePasswordPublicPartLastUpdate","Date","toISOString","updateResultPasswordLength","padStart","sortedAlphabet","split","sort","updatePasswordGenerationParameters","canRun","clearOutputs","chainInfo","pathToObjectChain","path","separatorIndex","indexOf","tail","firstPath","remainingPath","node","head","tailParent","leaf","public","datetime","numericValue","customKeys","obj","JSON","parse","constructor","parseCustomKeys","removeProperty","resultParameters","source","target","entries","includes","shallowMerge","keys","stringify","updateOutputSizeRangeToNum","updateAlphabetSize","updateAlphabetValidityDisplay","isAlphabetValid","privatePartString","publicPartString","privatePrivateBytes","publicPartBytes","keyString","generatePassword","input","Math","max","resetAlphabet","isAlphabetValidResult","prompt","randomString","buttonName","btn","type","setupViewButton","min","val","isNaN","updateOutputSizeNumToRange","output","ArrayBuffer","nonce","passwordSalt","aesGcmParams","iv","passwordKey","encrypt","set","payload","decrypt","cipher","txtCipherSource","txtCipherTarget","btnEncrypt","btnDecrypt","btnClearCipherSource","spnCopyCipherTargetFeedback","btnCopyCipherTarget","btnClearCipherTarget","clearSourceVisualCue","setSourceVisualCueError","clearAllVisualCues","focus","warn","encrypted","decrypted","TextDecoder","decode","message","encryptionKeyDerivationSalt","ciphers","txtReEncryptSource","txtReEncryptTarget","cboReEncryptFrom","cboReEncryptTo","btnReEncrypt","btnClearReEncryptSource","spnCopyReEncryptTargetFeedback","btnCopyReEncryptTarget","btnClearReEncryptTarget","fillCipherComboBox","cbo","initialValue","item","createElement","childNodes","description","version","add","sourceCipherIndex","targetCipherIndex","reEncrypted","btnTabNothing","btnTabPasswords","btnTabCiphers","btnTabReEncrypt","tabs","_activeTabIndex","setActiveTab","index","activeTabIndex","tabInfo","content"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export class VisualFeedback {\n    private element: HTMLElement;\n    private timeout: number | undefined;\n\n    public constructor(element: HTMLElement) {\n        this.element = element;\n    }\n\n    public setText(text: string, duration: number) {\n        this.element.innerHTML = text;\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n        }\n        this.timeout = setTimeout(() => this.element.innerHTML = '', duration);\n    }\n}\n","import { VisualFeedback } from './VisualFeedback';\n\nexport function getElementById(elementName: string): HTMLInputElement {\n    const element: HTMLElement|null = document.getElementById(elementName);\n\n    if (elementName === null) {\n        throw new Error(`DOM element '${elementName}' not found.`);\n    }\n\n    return element as HTMLInputElement;\n}\n\nasync function writeToClipboard(text: string): Promise<boolean> {\n    try {\n        await navigator.clipboard.writeText(text);\n        return true;\n    } catch (error) {\n        console.error(error.stack || error);\n        return false;\n    }\n}\n\nexport function setupCopyButton(txt: HTMLInputElement, button: HTMLInputElement, feedback: HTMLInputElement): void {\n    const visualFeedback: VisualFeedback = new VisualFeedback(feedback);\n    button.addEventListener('click', async () => {\n        if (await writeToClipboard(txt.value)) {\n            visualFeedback.setText('Copied', 3000);\n        } else {\n            visualFeedback.setText('<span style=\"color: red\">Failed to copy</span>', 3000);\n        }\n    });\n}\n\nexport const SUCCESS_COLOR: string = '#D0FFD0';\nexport const ERROR_COLOR: string = '#FFD0D0';\n","import { getElementById, SUCCESS_COLOR, ERROR_COLOR } from '../ui';\n\nimport { TimedAction } from '../TimedAction';\n\nconst btnProtectTitleForProtect = 'Stores the string in memory and removes it from the UI component. Prevents a physical intruder from copy/pasting the value.';\nconst btnProtectTitleForClear = 'Removes the string form memory and re-enables the UI component.';\n\nconst txtPrivatePart: HTMLInputElement = getElementById('txtPrivatePart');\nconst txtPrivatePartConfirmation: HTMLInputElement = getElementById('txtPrivatePartConfirmation');\nconst btnProtect: HTMLInputElement = getElementById('btnProtect');\nconst spnProtectedConfirmation: HTMLInputElement = getElementById('spnProtectedConfirmation');\n\nconst spnPrivatePartSize: HTMLInputElement = getElementById('spnPrivatePartSize');\nconst spnPrivatePartSizeConfirmation: HTMLInputElement = getElementById('spnPrivatePartSizeConfirmation');\n\nconst PRIVATE_PART_PROTECTION_TIMEOUT: number = 60 * 1000;\n\nlet privatePart: string | undefined;\n\nlet onChangedHandlers: (() => void)[] = [];\n\nexport function registerOnChanged(onChanged: () => void) {\n    onChangedHandlers.push(onChanged);\n}\n\nexport function getPrivatePart(): string {\n    if (privatePart !== undefined) {\n        return privatePart;\n    }\n    return txtPrivatePart.value;\n}\n\nfunction protectAndLockPrivatePart(): void {\n    if (txtPrivatePart.value.length === 0) {\n        return;\n    }\n\n    privatePart = txtPrivatePart.value;\n    spnProtectedConfirmation.innerHTML = 'Protected';\n\n    txtPrivatePart.value = '';\n    txtPrivatePartConfirmation.value = '';\n    spnPrivatePartSize.innerHTML = '0';\n    spnPrivatePartSizeConfirmation.innerHTML = '0';\n\n    txtPrivatePart.disabled = true;\n    txtPrivatePartConfirmation.disabled = true;\n\n    btnProtect.innerHTML = 'Clear and unlock';\n    btnProtect.title = btnProtectTitleForClear;\n\n    updatePrivatePartsMatching();\n}\n\nfunction clearAndUnLockPrivatePart(): void {\n    privatePart = undefined;\n    spnProtectedConfirmation.innerHTML = '';\n\n    txtPrivatePart.disabled = false;\n    txtPrivatePartConfirmation.disabled = false;\n\n    btnProtect.innerHTML = 'Protect and lock';\n    btnProtect.title = btnProtectTitleForProtect;\n    btnProtect.disabled = true;\n}\n\nfunction togglePrivatePartProtection(): void {\n    if (privatePart === undefined) {\n        protectAndLockPrivatePart();\n    } else {\n        clearAndUnLockPrivatePart();\n    }\n}\n\nbtnProtect.addEventListener('click', () => {\n    togglePrivatePartProtection();\n});\n\nconst protectPrivatePartAction: TimedAction = new TimedAction(protectAndLockPrivatePart, PRIVATE_PART_PROTECTION_TIMEOUT);\n\ntxtPrivatePart.addEventListener('input', () => {\n    btnProtect.disabled = txtPrivatePart.value.length === 0;\n\n    spnPrivatePartSize.innerHTML = txtPrivatePart.value.length.toString();\n    updatePrivatePartsMatching();\n\n    let onChangedHandler: () => void;\n    for (onChangedHandler of onChangedHandlers) {\n        onChangedHandler();\n    }\n\n    protectPrivatePartAction.reset();\n});\n\nfunction updatePrivatePartsMatching(): void {\n    if (txtPrivatePartConfirmation.value === txtPrivatePart.value) {\n        txtPrivatePartConfirmation.style.setProperty('background', SUCCESS_COLOR);\n    } else {\n        txtPrivatePartConfirmation.style.setProperty('background', ERROR_COLOR);\n    }\n};\n\ntxtPrivatePartConfirmation.addEventListener('input', () => {\n    spnPrivatePartSizeConfirmation.innerHTML = txtPrivatePartConfirmation.value.length.toString();\n    protectPrivatePartAction.reset();\n    updatePrivatePartsMatching();\n});\n\nupdatePrivatePartsMatching();\nbtnProtect.title = btnProtectTitleForProtect;\n","export class TimedAction {\n    private timeout: number | undefined;\n    public constructor(private action: Function, private delay: number) {\n    }\n\n    public reset(overrideDelay: number | undefined = undefined): void {\n        if (this.timeout !== undefined) {\n            clearTimeout(this.timeout);\n        }\n\n        const delay = overrideDelay !== undefined ? overrideDelay : this.delay;\n\n        this.timeout = setTimeout(() => {\n            this.action();\n            this.timeout = undefined;\n        }, delay);\n    }\n}\n","export function arrayToString(array: ArrayBuffer): string {\n    const decoder = new TextDecoder(/*'utf-8'*/);\n    return decoder.decode(array);\n};\n\nexport function copy(source: Uint8Array, sourceIndex: number, target: Uint8Array, targetIndex: number, length: number): void {\n    for (let i: number = 0; i < length; i += 1) {\n        target[i + targetIndex] = source[i + sourceIndex];\n    }\n}\n\nexport function arrayBufferToUnsignedBigInt(arrayBuffer: ArrayBuffer): bigint {\n    const length: number = arrayBuffer.byteLength;\n    const arrayView: DataView = new DataView(arrayBuffer, 0);\n\n    let result: bigint = 0n;\n\n    for (let i: number = 0; i < length; i += 1) {\n        result += BigInt(arrayView.getUint8(i)) * (256n ** BigInt(i));\n    }\n\n    return result;\n}\n\nexport function toCustomBase(bytes: ArrayBuffer, alphabet: string): string {\n    const alphabetLength: bigint = BigInt(alphabet.length);\n\n    let result: string = '';\n    let number: bigint = arrayBufferToUnsignedBigInt(bytes);\n\n    while (number > 0n)\n    {\n        const remainder: bigint = number % alphabetLength;\n        number /= alphabetLength;\n\n        const index: number = <number><any>BigInt.asUintN(64, remainder);\n\n        result += alphabet[index];\n    }\n\n    return result;\n}\n\nexport function toBase16(buffer: ArrayBuffer): string {\n    return Array.prototype.map.call(\n        new Uint8Array(buffer),\n        x => ('00' + x.toString(16)).slice(-2)\n    ).join('');\n}\n","import * as arrayUtils from './arrayUtils';\n\nexport const BASE62_ALPHABET: string = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n\nexport interface IPasswordGenerator {\n    readonly version: number;\n    readonly description: string;\n    generatePassword(privatePart: ArrayBuffer, publicPart: ArrayBuffer): Promise<ArrayBuffer>;\n}\n\nexport interface ICipher {\n    readonly version: number;\n    readonly description: string;\n    encrypt(input: ArrayBuffer, password: ArrayBuffer): Promise<ArrayBuffer>;\n    decrypt(input: ArrayBuffer, password: ArrayBuffer): Promise<ArrayBuffer>;\n}\n\nexport async function getDerivedBytes(password: ArrayBuffer, salt: ArrayBuffer): Promise<ArrayBuffer> {\n    const baseKey: CryptoKey = await crypto.subtle.importKey(\n        'raw',\n        password,\n        'PBKDF2',\n        false,\n        ['deriveKey']\n    );\n\n    const algorithm: Pbkdf2Params = {\n        name: 'PBKDF2',\n        hash: 'SHA-512',\n        iterations: 100000,\n        salt\n    };\n\n    const derivedKeyType: AesDerivedKeyParams = {\n        name: 'AES-CBC',\n        length: 256\n    };\n\n    const result: CryptoKey = await crypto.subtle.deriveKey(\n        algorithm,\n        baseKey,\n        derivedKeyType,\n        true,\n        ['encrypt']\n    );\n\n    const key: ArrayBuffer = await crypto.subtle.exportKey('raw', result);\n\n    return key;\n}\n\nexport function generateRandomBytes(byteCount: number = 64): ArrayBuffer {\n    const array: Uint8Array = new Uint8Array(byteCount);\n    return crypto.getRandomValues(array).buffer;\n}\n\nexport function generateRandomString(byteCount: number = 64, alphabet: string = BASE62_ALPHABET): string {\n    const array: ArrayBuffer = generateRandomBytes(byteCount);\n    return arrayUtils.toCustomBase(array, alphabet);\n}\n","export function truncate(input: string, length: number): string {\n    if (input.length <= length) {\n        return input;\n    }\n\n    return input.substr(0, length);\n}\n\nexport function stringToArray(str: string): ArrayBuffer {\n    const encoder = new TextEncoder(/*'utf-8'*/);\n    return encoder.encode(str).buffer;\n}\n\nexport function fromBase16(str: string): ArrayBuffer {\n    if (str.length % 2 !== 0) {\n        str = '0' + str;\n    }\n\n    const result: Uint8Array = new Uint8Array(str.length / 2);\n\n    for (let i = 0; i < result.byteLength; i += 1) {\n        result[i] = parseInt(str.substr(i * 2, 2), 16);\n    }\n\n    return result.buffer;\n}\n","import { getElementById, setupCopyButton, ERROR_COLOR } from '../ui';\nimport * as privatePart from './privatePartComponent';\n\nimport * as crypto from '../crypto';\nimport * as stringUtils from '../stringUtils';\nimport * as arrayUtils from '../arrayUtils';\n\nimport { PlainObject } from '../PlainObject';\n\nimport { PasswordGeneratorV1 } from '../passwordGenerators/v1';\n\nprivatePart.registerOnChanged(run);\n\nconst passwordGenerator: crypto.IPasswordGenerator = new PasswordGeneratorV1('Password');\n\nconst txtPath: HTMLInputElement = getElementById('txtPath');\nconst txtPublicPart: HTMLInputElement = getElementById('txtPublicPart');\nconst btnGeneratePublicPart: HTMLInputElement = getElementById('btnGeneratePublicPart');\nconst btnClearPublicPart: HTMLInputElement = getElementById('btnClearPublicPart');\nconst btnCopyPublicPart: HTMLInputElement = getElementById('btnCopyPublicPart');\nconst spnCopyPublicPartFeedback: HTMLInputElement = getElementById('spnCopyPublicPartFeedback');\n\nconst numOutputSizeRange: HTMLInputElement = getElementById('numOutputSizeRange');\nconst numOutputSizeNum: HTMLInputElement = getElementById('numOutputSizeNum');\n\nconst txtAlphabet: HTMLInputElement = getElementById('txtAlphabet');\nconst spnAlphabetSize: HTMLInputElement = getElementById('spnAlphabetSize');\nconst btnResetAlphabet: HTMLInputElement = getElementById('btnResetAlphabet');\n\nconst txtResultPassword: HTMLInputElement = getElementById('txtResultPassword');\nconst spnResultPasswordLength: HTMLInputElement = getElementById('spnResultPasswordLength');\nconst btnCopyResultPassword: HTMLInputElement = getElementById('btnCopyResultPassword');\nconst spnCopyResultPasswordFeedback: HTMLInputElement = getElementById('spnCopyResultPasswordFeedback');\n\nconst txtParameters: HTMLInputElement = getElementById('txtParameters');\nconst txtCustomKeys: HTMLInputElement = getElementById('txtCustomKeys');\n\nconst DEFAULT_LENGTH: number = 64;\nconst DEFAULT_ALPHABET: string = '!\"#$%&\\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~';\n\nconst RESERVED_KEYS: string[] = ['alphabet', 'length', 'public', 'datetime'];\n\n// dafuq!?\nnumOutputSizeRange.max = DEFAULT_LENGTH.toString();\nnumOutputSizeRange.value = DEFAULT_LENGTH.toString();\n\nlet passwordPublicPartLastChange: string | undefined;\n\nbtnClearPublicPart.addEventListener('click', () => {\n    if (txtPublicPart.value.length > 0) {\n        if (prompt('Are you sure you want to clear the public part ?\\nType \\'y\\' to accept', '') !== 'y') {\n            return;\n        }\n    }\n\n    txtPublicPart.value = '';\n\n    updatePasswordPublicPartLastUpdate();\n    updatePasswordGenerationParameters();\n});\n\nbtnGeneratePublicPart.addEventListener('click', () => {\n    if (txtPublicPart.value.length > 0) {\n        if (prompt('Are you sure you want to generate a new public part ?\\nType \\'y\\' to accept', '') !== 'y') {\n            return;\n        }\n    }\n\n    const randomString: string = crypto.generateRandomString();\n    txtPublicPart.value = randomString;\n\n    updatePasswordPublicPartLastUpdate();\n\n    run();\n});\n\nfunction updatePasswordPublicPartLastUpdate(): void {\n    if (txtPublicPart.value.length > 0) {\n        passwordPublicPartLastChange = new Date().toISOString();\n    } else {\n        passwordPublicPartLastChange = undefined;\n    }\n}\n\nfunction updateCustomKeysDisplay(isValid: boolean): void {\n    if (isValid) {\n        txtCustomKeys.style.removeProperty('background');\n        return;\n    }\n\n    txtCustomKeys.style.setProperty('background', ERROR_COLOR);\n}\n\nfunction parseCustomKeys(): PlainObject | null {\n    if (txtCustomKeys.value === '') {\n        return {};\n    }\n\n    try {\n        const obj: any = JSON.parse(txtCustomKeys.value);\n        if (obj === null || obj.constructor.name !== 'Object') {\n            return null;\n        }\n        return obj as PlainObject;\n    } catch {\n        return null;\n    }\n}\n\nfunction shallowMerge(source: PlainObject | null, target: PlainObject | null): PlainObject {\n    const result: PlainObject = {};\n\n    if (source !== null) {\n        for (const [key, value] of Object.entries(source)) {\n            if (RESERVED_KEYS.includes(key) === false) {\n                result[key] = value;\n            }\n        }\n    }\n\n    if (target !== null) {\n        for (const [key, value] of Object.entries(target)) {\n            result[key] = value;\n        }\n    }\n\n    return result;\n}\n\nfunction deepMerge(source: PlainObject, target: PlainObject): void {\n    for (const sourceKey of Object.keys(source)) {\n        const targetValue: any = target[sourceKey];\n        const sourceValue: any = source[sourceKey];\n\n        if (targetValue === undefined ||\n            targetValue === null ||\n            targetValue.constructor.name !== 'Object' ||\n            sourceValue.constructor.name !== 'Object') {\n            target[sourceKey] = sourceValue;\n            continue;\n        }\n\n        deepMerge(sourceValue, targetValue);\n    }\n}\n\nfunction setupViewButton(txt: HTMLInputElement, buttonName: string): void {\n    const btn: HTMLInputElement = getElementById(buttonName);\n    btn.addEventListener('click', () => {\n        if (txt.type === 'password') {\n            txt.type = 'input';\n            btn.innerHTML = 'Hide';\n        } else {\n            txt.type = 'password';\n            btn.innerHTML = 'View';\n        }\n    });\n}\n\nfunction updateResultPasswordLength() {\n    spnResultPasswordLength.innerHTML = txtResultPassword.value.length.toString().padStart(2, ' ');\n}\n\nsetupViewButton(txtResultPassword, 'btnViewResultPassword');\n\nsetupCopyButton(txtPublicPart, btnCopyPublicPart, spnCopyPublicPartFeedback);\nsetupCopyButton(txtResultPassword, btnCopyResultPassword, spnCopyResultPasswordFeedback);\n\nfunction isAlphabetValid(alphabet: string): boolean {\n    const sortedAlphabet: string[] = alphabet.split('');\n    sortedAlphabet.sort();\n\n    for (let i: number = 1; i < sortedAlphabet.length; i += 1) {\n        if (sortedAlphabet[i - 1] === sortedAlphabet[i]) {\n            return false;\n        }\n    }\n\n    return true;\n}\n\ntype IChainInfo = {\n    head: PlainObject,\n    tailParent: PlainObject,\n    tail: PlainObject\n};\n\n// Transforms a path like \"a/b/c/d\" into a hierarchy of objects like { \"a\": { \"b\": { \"c\": { \"d\": {} } } } }\n// From the result object, head is the root object that contains \"a\", tail is the value of \"d\", and tailParent is the value of \"c\"\nfunction pathToObjectChain(path: string, chainInfo: IChainInfo | undefined = undefined): IChainInfo {\n    const separatorIndex: number = path.indexOf('/');\n\n    const tail: PlainObject = {};\n\n    const firstPath: string = separatorIndex >= 0 ? path.substr(0, separatorIndex) : path;\n    const remainingPath: string | undefined = separatorIndex >= 0 ? path.substr(separatorIndex + 1) : undefined;\n\n    if (chainInfo === undefined) {\n        const node: PlainObject = {};\n        node[firstPath] = tail;\n        chainInfo = {\n            head: node,\n            tailParent: node,\n            tail\n        };\n    } else {\n        chainInfo.tail[firstPath] = tail;\n        chainInfo.tailParent = chainInfo.tail;\n        chainInfo.tail = tail;\n    }\n\n    if (remainingPath) {\n        return pathToObjectChain(remainingPath, chainInfo);\n    }\n\n    return chainInfo;\n}\n\nfunction updatePasswordGenerationParameters(): void {\n    if (canRun() === false) {\n        clearOutputs();\n        return;\n    }\n\n    const chainInfo: IChainInfo = pathToObjectChain(txtPath.value);\n    const leaf: PlainObject = chainInfo.tail;\n\n    leaf.public = txtPublicPart.value;\n    leaf.datetime = passwordPublicPartLastChange;\n\n    const numericValue: number = txtResultPassword.value.length;\n    if (numericValue !== DEFAULT_LENGTH) {\n        leaf.length = numericValue;\n    }\n\n    const alphabet: string = txtAlphabet.value;\n    if (alphabet !== DEFAULT_ALPHABET) {\n        leaf.alphabet = alphabet;\n    }\n\n    const customKeys: PlainObject | null = parseCustomKeys();\n    updateCustomKeysDisplay(customKeys !== null);\n    const resultParameters: PlainObject = shallowMerge(customKeys, leaf);\n\n    if (Object.keys(resultParameters).length === 0) {\n        // Set the value of the first (single) property of the object to null.\n        chainInfo.tailParent[Object.keys(chainInfo.tailParent)[0]] = null;\n    } else {\n        chainInfo.tailParent[Object.keys(chainInfo.tailParent)[0]] = resultParameters;\n    }\n\n    txtParameters.value = JSON.stringify(chainInfo.head, undefined, 4);\n}\n\nfunction updateOutputSizeRangeToNum(): void {\n    numOutputSizeNum.value = numOutputSizeRange.value;\n}\n\nfunction updateOutputSizeNumToRange(): boolean {\n    const min: number = parseInt(numOutputSizeRange.min, 10);\n    const val: number = parseInt(numOutputSizeNum.value, 10);\n    const max: number = parseInt(numOutputSizeRange.max, 10);\n\n    if (isNaN(val) === false) {\n        numOutputSizeRange.value = Math.max(min, Math.min(val, max)).toString();\n        return true;\n    }\n\n    return false;\n}\n\nnumOutputSizeRange.addEventListener('input', async () => {\n    updateOutputSizeRangeToNum();\n    await run();\n});\n\nnumOutputSizeNum.addEventListener('input', async () => {\n    if (updateOutputSizeNumToRange()) {\n        updateOutputSizeRangeToNum();\n    }\n    await run();\n});\n\nfunction updateAlphabetSize(): void {\n    spnAlphabetSize.innerHTML = txtAlphabet.value.length.toString();\n\n    const alphabetSizeDigitCount: number = txtAlphabet.value.length.toString().length;\n    if (alphabetSizeDigitCount < 2) {\n        // Add a space to keep a nice visual alignment.\n        spnAlphabetSize.innerHTML = spnAlphabetSize.innerHTML.padStart(2, ' ');\n    }\n}\n\nfunction updateAlphabetValidityDisplay(isAlphabetValid: boolean): void {\n    if (isAlphabetValid) {\n        txtAlphabet.style.removeProperty('background');\n    } else {\n        txtAlphabet.style.setProperty('background', ERROR_COLOR);\n    }\n}\n\ntxtAlphabet.addEventListener('input', async () => {\n    const isAlphabetValidResult: boolean = isAlphabetValid(txtAlphabet.value);\n\n    updateAlphabetValidityDisplay(isAlphabetValidResult);\n\n    if (isAlphabetValidResult === false) {\n        return;\n    }\n\n    updateAlphabetSize();\n    await run();\n});\n\nbtnResetAlphabet.addEventListener('click', async () => {\n    resetAlphabet();\n    updateAlphabetSize();\n    await run();\n});\n\nfunction clearOutputs(): void {\n    txtResultPassword.value = '';\n    txtParameters.value = '';\n\n    updateResultPasswordLength();\n}\n\nfunction canRun(): boolean {\n    const alphabet: string = txtAlphabet.value;\n\n    if (isAlphabetValid(alphabet) === false) {\n        return false;\n    }\n\n    if (privatePart.getPrivatePart().length <= 0 || txtPublicPart.value.length < 8 || alphabet.length < 2) {\n        return false;\n    }\n\n    return true;\n}\n\nasync function run() {\n    if (canRun() === false) {\n        clearOutputs();\n        return;\n    }\n\n    const privatePartString: string = privatePart.getPrivatePart();\n    const publicPartString = txtPublicPart.value;\n\n    const privatePrivateBytes: ArrayBuffer = stringUtils.stringToArray(privatePartString);\n    const publicPartBytes: ArrayBuffer = stringUtils.stringToArray(publicPartString);\n\n    const keyBytes: ArrayBuffer = await passwordGenerator.generatePassword(privatePrivateBytes, publicPartBytes);\n\n    const keyString: string = arrayUtils.toCustomBase(keyBytes, txtAlphabet.value);\n    txtResultPassword.value = stringUtils.truncate(keyString, Math.max(4, parseInt(numOutputSizeRange.value, 10)));\n\n    updateResultPasswordLength();\n\n    updatePasswordGenerationParameters();\n}\n\nasync function resetAlphabet() {\n    txtAlphabet.value = DEFAULT_ALPHABET;\n    updateAlphabetSize();\n\n    const isAlphabetValidResult: boolean = isAlphabetValid(txtAlphabet.value);\n\n    updateAlphabetValidityDisplay(isAlphabetValidResult);\n\n    if (isAlphabetValidResult) {\n        await run();\n    }\n}\n\ntxtPath.addEventListener('input', () => {\n    updatePasswordGenerationParameters();\n});\n\ntxtPublicPart.addEventListener('input', async () => {\n    updatePasswordPublicPartLastUpdate();\n    await run();\n});\n\ntxtCustomKeys.addEventListener('input', () => {\n    updatePasswordGenerationParameters();\n});\n\nupdateOutputSizeRangeToNum();\nresetAlphabet();\n","import { stringToArray } from '../stringUtils';\nimport { IPasswordGenerator, getDerivedBytes } from '../crypto';\n\nexport class PasswordGeneratorV1 implements IPasswordGenerator {\n    private hkdfPurpose: ArrayBuffer;\n    private _description: string;\n\n    public constructor(hkdfPurpose: string) {\n        this.hkdfPurpose = stringToArray(hkdfPurpose);\n        this._description = `HKDF(PBKDF2, HMAC512) [purpose: ${hkdfPurpose}]`;\n    }\n\n    public get version(): number {\n        return 1;\n    }\n\n    public get description(): string {\n        return this._description;\n    }\n\n    public async generatePassword(privatePart: ArrayBuffer, publicPart: ArrayBuffer): Promise<ArrayBuffer> {\n        const derivedKey: ArrayBuffer = await getDerivedBytes(privatePart, publicPart);\n\n        const hmacParameters: HmacImportParams = {\n            name: 'HMAC',\n            hash: { name: 'SHA-512' }\n        };\n\n        const hkdfKey: CryptoKey = await crypto.subtle.importKey(\n            'raw',\n            derivedKey,\n            hmacParameters,\n            false,\n            ['sign']\n        );\n\n        return await crypto.subtle.sign('HMAC', hkdfKey, this.hkdfPurpose);\n    }\n}\n","import { ICipher, getDerivedBytes } from '../crypto';\n\nexport class CipherV2 implements ICipher {\n    public get version(): number {\n        return 2;\n    }\n\n    public get description(): string {\n        return 'PBKDF2 + AES-GCM';\n    }\n\n    async encrypt(input: ArrayBuffer, password: ArrayBuffer): Promise<ArrayBuffer> {\n        const output: ArrayBuffer = new ArrayBuffer(12 + 16 + 16 + input.byteLength);\n\n        const nonce: Uint8Array = crypto.getRandomValues(new Uint8Array(output, 0, 12));\n        const passwordSalt: Uint8Array = crypto.getRandomValues(new Uint8Array(output, 12, 16));\n\n        const aesGcmParams: AesGcmParams = {\n            name: 'AES-GCM',\n            iv: nonce\n        };\n\n        const aesKeyAlgorithm: AesKeyAlgorithm = {\n            name: 'AES-GCM',\n            length: 256\n        };\n\n        const passwordKey: CryptoKey = await crypto.subtle.importKey(\n            'raw',\n            await getDerivedBytes(password, passwordSalt),\n            aesKeyAlgorithm,\n            false,\n            ['encrypt']\n        );\n\n        const result: ArrayBuffer = await crypto.subtle.encrypt(aesGcmParams, passwordKey, input);\n\n        new Uint8Array(output).set(new Uint8Array(result), 12 + 16);\n\n        return output;\n    }\n\n    async decrypt(input: ArrayBuffer, password: ArrayBuffer): Promise<ArrayBuffer> {\n        const nonce: Uint8Array = new Uint8Array(input, 0, 12);\n        const passwordSalt: Uint8Array = new Uint8Array(input, 12, 16);\n        const payload: Uint8Array = new Uint8Array(input, 12 + 16);\n\n        const aesGcmParams: AesGcmParams = {\n            name: 'AES-GCM',\n            iv: nonce\n        };\n\n        const aesKeyAlgorithm: AesKeyAlgorithm = {\n            name: 'AES-GCM',\n            length: 256\n        };\n\n        const derivedKey: ArrayBuffer = await getDerivedBytes(password, passwordSalt);\n\n        const passwordKey: CryptoKey = await crypto.subtle.importKey(\n            'raw',\n            derivedKey,\n            aesKeyAlgorithm,\n            false,\n            ['decrypt']\n        );\n\n        return await crypto.subtle.decrypt(aesGcmParams, passwordKey, payload);\n    }\n}\n","import * as crypto from '../crypto';\nimport * as stringUtils from '../stringUtils';\nimport * as arrayUtils from '../arrayUtils';\n\nimport { getElementById, setupCopyButton, ERROR_COLOR } from '../ui';\nimport { getPrivatePart } from './privatePartComponent';\n\nimport { CipherV2 } from '../ciphers/v2';\n\nconst cipher: crypto.ICipher = new CipherV2();\n\nconst txtCipherSource: HTMLInputElement = getElementById('txtCipherSource');\nconst txtCipherTarget: HTMLInputElement = getElementById('txtCipherTarget');\nconst btnEncrypt: HTMLInputElement = getElementById('btnEncrypt');\nconst btnDecrypt: HTMLInputElement = getElementById('btnDecrypt');\n\nconst btnClearCipherSource: HTMLInputElement = getElementById('btnClearCipherSource');\nconst spnCopyCipherTargetFeedback: HTMLInputElement = getElementById('spnCopyCipherTargetFeedback');\nconst btnCopyCipherTarget: HTMLInputElement = getElementById('btnCopyCipherTarget');\nconst btnClearCipherTarget: HTMLInputElement = getElementById('btnClearCipherTarget');\n\nsetupCopyButton(txtCipherTarget, btnCopyCipherTarget, spnCopyCipherTargetFeedback);\n\nfunction clearSourceVisualCue(): void {\n    txtCipherSource.style.removeProperty('background-color');\n}\n\nfunction clearTargetVisualCue(): void {\n    txtCipherTarget.style.removeProperty('background-color');\n}\n\nfunction setSourceVisualCueError() {\n    txtCipherSource.style.setProperty('background-color', ERROR_COLOR);\n}\n\nfunction setTargetVisualCueError() {\n    txtCipherTarget.style.setProperty('background-color', ERROR_COLOR);\n}\n\nfunction clearAllVisualCues(): void {\n    clearSourceVisualCue();\n    clearTargetVisualCue();\n}\n\nbtnEncrypt.addEventListener('click', async () => {\n    txtCipherSource.focus();\n    txtCipherTarget.value = '';\n    clearAllVisualCues();\n\n    if (txtCipherSource.value.length === 0) {\n        setSourceVisualCueError();\n        return;\n    }\n\n    const privatePart: string = getPrivatePart();\n    if (privatePart.length === 0) {\n        console.warn('Private part is empty');\n        return;\n    }\n\n    const input: ArrayBuffer = stringUtils.stringToArray(txtCipherSource.value);\n    const password: ArrayBuffer = stringUtils.stringToArray(privatePart);\n\n    const encrypted: ArrayBuffer = await cipher.encrypt(input, password);\n\n    txtCipherTarget.value = arrayUtils.toBase16(encrypted);\n});\n\nbtnDecrypt.addEventListener('click', async () => {\n    txtCipherSource.focus();\n    txtCipherTarget.value = '';\n    clearAllVisualCues();\n\n    if (txtCipherSource.value.length === 0) {\n        setSourceVisualCueError();\n        return;\n    }\n\n    const privatePart: string = getPrivatePart();\n    if (privatePart.length === 0) {\n        console.warn('Private part is empty');\n        return;\n    }\n\n    try {\n        const input: ArrayBuffer = stringUtils.fromBase16(txtCipherSource.value);\n        const password: ArrayBuffer = stringUtils.stringToArray(privatePart);\n\n        const decrypted: ArrayBuffer = await cipher.decrypt(input, password);\n\n        txtCipherTarget.value = arrayUtils.arrayToString(decrypted);\n    } catch (error) {\n        console.warn(`Failed to decrypt${error.message ? `, error: ${error.message}` : ', no error message'}`);\n        setTargetVisualCueError();\n    }\n});\n\ntxtCipherSource.addEventListener('input', () => {\n    if (txtCipherSource.value.length > 0) {\n        clearSourceVisualCue();\n    }\n});\n\nbtnClearCipherSource.addEventListener('click', () => {\n    txtCipherSource.value = '';\n});\n\nbtnClearCipherTarget.addEventListener('click', () => {\n    txtCipherTarget.value = '';\n});\n","import { ICipher, getDerivedBytes } from '../crypto';\n\nconst encryptionKeyDerivationSalt: ArrayBuffer = new Uint8Array([ 0xf2, 0xcf, 0xef, 0x8e, 0x13, 0x40, 0x46, 0x49, 0x92, 0x2a, 0xde, 0x5c, 0xbc, 0x88, 0x38, 0xa8 ]).buffer;\n\nexport class CipherV1 implements ICipher {\n    public get version(): number {\n        return 1;\n    }\n\n    public get description(): string {\n        return 'PBKDF2 + AES-GCM';\n    }\n\n    async encrypt(input: ArrayBuffer, password: ArrayBuffer): Promise<ArrayBuffer> {\n        const output: ArrayBuffer = new ArrayBuffer(12 + 16 + input.byteLength);\n\n        const nonce: DataView = new DataView(output, 0, 12);\n        crypto.getRandomValues(new Uint8Array(output, 0, 12));\n\n        const aesGcmParams: AesGcmParams = {\n            name: 'AES-GCM',\n            iv: nonce\n        };\n\n        const aesKeyAlgorithm: AesKeyAlgorithm = {\n            name: 'AES-GCM',\n            length: 256\n        };\n\n        const passwordKey: CryptoKey = await crypto.subtle.importKey(\n            'raw',\n            await getDerivedBytes(password, encryptionKeyDerivationSalt),\n            aesKeyAlgorithm,\n            false,\n            ['encrypt']\n        );\n\n        const result: ArrayBuffer = await crypto.subtle.encrypt(aesGcmParams, passwordKey, input);\n\n        new Uint8Array(output).set(new Uint8Array(result), 12);\n\n        return output;\n    }\n\n    async decrypt(input: ArrayBuffer, password: ArrayBuffer): Promise<ArrayBuffer> {\n        const nonce: DataView = new DataView(input, 0, 12);\n        const payload: DataView = new DataView(input, 12);\n\n        const aesGcmParams: AesGcmParams = {\n            name: 'AES-GCM',\n            iv: nonce\n        };\n\n        const aesKeyAlgorithm: AesKeyAlgorithm = {\n            name: 'AES-GCM',\n            length: 256\n        };\n\n        const derivedKey: ArrayBuffer = await getDerivedBytes(password, encryptionKeyDerivationSalt);\n\n        const passwordKey: CryptoKey = await crypto.subtle.importKey(\n            'raw',\n            derivedKey,\n            aesKeyAlgorithm,\n            false,\n            ['decrypt']\n        );\n\n        return await crypto.subtle.decrypt(aesGcmParams, passwordKey, payload);\n    }\n}\n","import { ICipher } from '../crypto';\nimport * as stringUtils from '../stringUtils';\nimport * as arrayUtils from '../arrayUtils';\n\nimport { getElementById, setupCopyButton, ERROR_COLOR } from '../ui';\nimport { getPrivatePart } from './privatePartComponent';\n\nimport { CipherV1 } from '../ciphers/v1';\nimport { CipherV2 } from '../ciphers/v2';\n\nconst ciphers: ICipher[] = [\n    new CipherV1(),\n    new CipherV2()\n];\n\nconst txtReEncryptSource: HTMLInputElement = getElementById('txtReEncryptSource');\nconst txtReEncryptTarget: HTMLInputElement = getElementById('txtReEncryptTarget');\n\nconst cboReEncryptFrom: HTMLInputElement = getElementById('cboReEncryptFrom');\nconst cboReEncryptTo: HTMLInputElement = getElementById('cboReEncryptTo');\nconst btnReEncrypt: HTMLInputElement = getElementById('btnReEncrypt');\n\nconst btnClearReEncryptSource: HTMLInputElement = getElementById('btnClearReEncryptSource');\nconst spnCopyReEncryptTargetFeedback: HTMLInputElement = getElementById('spnCopyReEncryptTargetFeedback');\nconst btnCopyReEncryptTarget: HTMLInputElement = getElementById('btnCopyReEncryptTarget');\nconst btnClearReEncryptTarget: HTMLInputElement = getElementById('btnClearReEncryptTarget');\n\nsetupCopyButton(txtReEncryptTarget, btnCopyReEncryptTarget, spnCopyReEncryptTargetFeedback);\n\nfunction fillCipherComboBox(cbo: HTMLSelectElement, initialValue: number): void {\n    let cipher: ICipher;\n\n    for (cipher of ciphers) {\n        const item: HTMLOptionElement = document.createElement('option');\n        item.value = cbo.childNodes.length.toString();\n        item.text = `${cipher.description} (v${cipher.version})`;\n        cbo.add(item);\n    }\n\n    cbo.value = initialValue.toString();\n}\n\n// Mais est-ce que ce monde est serieux?\nfillCipherComboBox(<HTMLSelectElement><any>cboReEncryptFrom, ciphers.length - 2);\nfillCipherComboBox(<HTMLSelectElement><any>cboReEncryptTo, ciphers.length - 1);\n\nfunction clearSourceVisualCue(): void {\n    txtReEncryptSource.style.removeProperty('background-color');\n}\n\nfunction clearTargetVisualCue(): void {\n    txtReEncryptTarget.style.removeProperty('background-color');\n}\n\nfunction setSourceVisualCueError() {\n    txtReEncryptSource.style.setProperty('background-color', ERROR_COLOR);\n}\n\nfunction setTargetVisualCueError() {\n    txtReEncryptTarget.style.setProperty('background-color', ERROR_COLOR);\n}\n\nfunction clearAllVisualCues(): void {\n    clearSourceVisualCue();\n    clearTargetVisualCue();\n}\n\nbtnReEncrypt.addEventListener('click', async () => {\n    txtReEncryptTarget.value = '';\n    clearAllVisualCues();\n\n    if (txtReEncryptSource.value.length === 0) {\n        setSourceVisualCueError();\n        return;\n    }\n\n    if (cboReEncryptFrom.value === cboReEncryptTo.value) {\n        setTargetVisualCueError();\n        return;\n    }\n\n    const privatePart: string = getPrivatePart();\n    if (privatePart.length === 0) {\n        console.warn('Private part is empty');\n        return;\n    }\n\n    const sourceCipherIndex = parseInt(cboReEncryptFrom.value, 10);\n    const targetCipherIndex = parseInt(cboReEncryptTo.value, 10);\n\n    const password: ArrayBuffer = stringUtils.stringToArray(privatePart);\n\n    const input: ArrayBuffer = stringUtils.fromBase16(txtReEncryptSource.value);\n    const decrypted: ArrayBuffer = await ciphers[sourceCipherIndex].decrypt(input, password);\n    const reEncrypted: ArrayBuffer = await ciphers[targetCipherIndex].encrypt(decrypted, password);\n\n    txtReEncryptTarget.value = arrayUtils.toBase16(reEncrypted);\n});\n\ntxtReEncryptSource.addEventListener('input', () => {\n    if (txtReEncryptSource.value.length > 0) {\n        clearSourceVisualCue();\n    }\n});\n\nbtnClearReEncryptSource.addEventListener('click', () => {\n    txtReEncryptSource.value = '';\n});\n\nbtnClearReEncryptTarget.addEventListener('click', () => {\n    txtReEncryptTarget.value = '';\n});\n","import { getElementById } from './ui';\n\nimport './components/privatePartComponent';\nimport './components/passwordComponent';\nimport './components/cipherComponent';\nimport './components/reEncryptComponent';\n\nimport { TabControl, ITabInfo } from './TabControl';\n\nconst btnTabNothing: HTMLInputElement = getElementById('btnTabNothing');\nconst btnTabPasswords: HTMLInputElement = getElementById('btnTabPasswords');\nconst btnTabCiphers: HTMLInputElement = getElementById('btnTabCiphers');\nconst btnTabReEncrypt: HTMLInputElement = getElementById('btnTabReEncrypt');\n\nconst divTabNothing: HTMLInputElement = getElementById('divTabNothing');\nconst divTabPasswords: HTMLInputElement = getElementById('divTabPasswords');\nconst divTabCiphers: HTMLInputElement = getElementById('divTabCiphers');\nconst divTabReEncrypt: HTMLInputElement = getElementById('divTabReEncrypt');\n\nconst tabs: ITabInfo[] = [\n    { button: btnTabNothing, content: divTabNothing },\n    { button: btnTabPasswords, content: divTabPasswords },\n    { button: btnTabCiphers, content: divTabCiphers },\n    { button: btnTabReEncrypt, content: divTabReEncrypt }\n];\n\nnew TabControl(tabs);\n\ndeclare const COMMITHASH: string;\n\nconst version = COMMITHASH.substr(0, 11);\nconst githubLink = '<a href=\"https://github.com/TanukiSharp/ItchyPassword\" target=\"_blank\">github</a>';\n\ngetElementById('divInfo').innerHTML = `${version}<br/>${githubLink}`;\n","export interface ITabInfo {\n    button: HTMLInputElement,\n    content: HTMLInputElement\n}\n\nexport class TabControl {\n    private _activeTabIndex: number = -1;\n\n    public get activeTabIndex(): number {\n        return this._activeTabIndex;\n    }\n    public set activeTabIndex(index: number) {\n        if (index < 0 || index >= this.tabs.length) {\n            throw new Error(`Argument 'index' out of range. Must be in range [0;${this.tabs.length - 1}].`);\n        }\n        this.setActiveTab(index);\n    }\n\n    public constructor(private tabs: ITabInfo[]) {\n        for (let i = 0; i < this.tabs.length; i += 1) {\n            tabs[i].button.addEventListener('click', () => {\n                this.setActiveTab(i);\n            });\n        }\n\n        this.setActiveTab(0);\n    }\n\n    private setActiveTab(activeTabIndex: number) {\n        let tabInfo: ITabInfo;\n\n        for (tabInfo of this.tabs) {\n            tabInfo.button.style.removeProperty('font-weight');\n            tabInfo.button.style.setProperty('color', '#C0C0C0');\n            tabInfo.content.style.setProperty('display', 'none');\n        }\n\n        this.tabs[activeTabIndex].button.style.setProperty('font-weight', 'bold');\n        this.tabs[activeTabIndex].button.style.removeProperty('color');\n        this.tabs[activeTabIndex].content.style.removeProperty('display');\n\n        this._activeTabIndex = activeTabIndex;\n    }\n}\n"],"sourceRoot":""}